import{b as ve,s as b,e as we,j as e,C as Se,w as ye,a as Ie}from"./index-Cc-Lnn9x.js";import{r as o}from"./vendor-react-Dfcn4nkY.js";import{P as Te}from"./PhotographIcon-BhsB4Orm.js";import{T as je}from"./TrashIcon-Dw3P_7Ho.js";import{C as Me}from"./CheckCircleIcon-DMttEdVL.js";import{C as Ee}from"./ConfirmationModal-FOR2G1eE.js";import"./vendor-jspdf-Bh_S0msn.js";import"./vendor-utils-DmyZJLyO.js";import"./vendor-ui-DKtFGipk.js";import"./ExclamationIcon-CXRxAwkS.js";const We=()=>{var T,M,E,L,D,z,$,V,H,O,R,P,B,F,U,Z,W,q,G,J,K,Q,X,Y,ee,ae,te,se,re,ie,le,oe,ne,de,ce,xe,me,pe,he,ue,be,fe;const[r,v]=o.useState("media"),[w,f]=o.useState([]),[y,j]=o.useState([]),[Ne,N]=o.useState(!0),[ke,k]=o.useState(!1),[Le,A]=o.useState(null),[m,De]=o.useState(""),[p,g]=o.useState(!1),[t,h]=o.useState(0),[Ae,u]=o.useState(!1),[c,_]=o.useState(null),[ze]=o.useState("terms"),C=o.useCallback(async()=>{N(!0),A(null);try{const{data:s}=await ve.from("avaliacoes").select("id, nota, comentario, criado_em, avaliador:usuarios!avaliador_id (id, nome, foto_url), alvo:usuarios!alvo_id (id, nome, tipo)").lte("nota",2).order("criado_em",{ascending:!1}).limit(50);j((s||[]).map(a=>({...a,avaliador:Array.isArray(a.avaliador)?a.avaliador[0]:a.avaliador,alvo:Array.isArray(a.alvo)?a.alvo[0]:a.alvo})));const{data:d}=await ve.from("usuarios").select("id, nome, tipo, foto_url, criado_em, artista:artistas(id, foto_capa, galeria_fotos), estabelecimento:estabelecimentos(id, foto_capa, galeria_fotos)").order("criado_em",{ascending:!1}).limit(40),n=[];(d||[]).forEach(a=>{a.foto_url&&n.push({id:`avatar-${a.id}`,url:b.getPublicUrl("perfis",a.foto_url),path:a.foto_url,type:"avatar",userId:a.id,userName:a.nome,userType:a.tipo,bucket:"perfis",createdAt:a.criado_em});const x=a.tipo==="artista"?Array.isArray(a.artista)?a.artista[0]:a.artista:Array.isArray(a.estabelecimento)?a.estabelecimento[0]:a.estabelecimento;x&&(x.foto_capa&&n.push({id:`cover-${a.id}`,url:b.getPublicUrl(a.tipo,x.foto_capa),path:x.foto_capa,type:"cover",userId:a.id,userName:a.nome,userType:a.tipo,bucket:a.tipo,createdAt:a.criado_em}),x.galeria_fotos&&x.galeria_fotos.forEach((ge,Ce)=>n.push({id:`p-${a.id}-${Ce}`,url:b.getPublicUrl(a.tipo,ge),path:ge,type:"portfolio",userId:a.id,userName:a.nome,userType:a.tipo,bucket:a.tipo,createdAt:a.criado_em})))}),f(n)}catch(s){A(we(s))}finally{N(!1)}},[]);o.useEffect(()=>{C()},[C]),o.useEffect(()=>(p?document.body.style.overflow="hidden":document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[p]);const S=async s=>{if(!(!s||s.aiAnalysis))if(r==="media"){const d=await ye.analyzeImage(s.url);f(n=>n.map(a=>a.id===s.id?{...a,aiAnalysis:d}:a))}else{const d=await ye.analyzeComment(s.comentario);j(n=>n.map(a=>a.id===s.id?{...a,aiAnalysis:d}:a))}},I=()=>{const s=r==="media"?i:l;t<s.length-1?(h(t+1),S(s[t+1])):g(!1)},_e=async()=>{if(c){k(!0);try{try{await b.remove(c.bucket,[c.path])}catch{}c.type==="avatar"&&await Ie.updateBasicInfo(c.userId,{foto_url:null}),f(s=>s.filter(d=>d.id!==c.id)),u(!1),p&&I()}catch(s){alert(we(s))}finally{k(!1)}}},i=w.filter(s=>!m||s.userName.toLowerCase().includes(m.toLowerCase())),l=y.filter(s=>!m||s.comentario.toLowerCase().includes(m.toLowerCase()));return e.jsxs("div",{className:"text-white animate-fade-in relative pb-20",children:[p&&e.jsxs("div",{className:"fixed inset-0 z-[999] bg-dark/95 flex animate-fade-in overflow-hidden h-screen w-screen font-poppins backdrop-blur-3xl",children:[e.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[e.jsx("div",{className:`absolute -top-[20%] -left-[10%] w-[60%] h-[60%] opacity-20 blur-[150px] transition-colors duration-1000 ${(r==="media"?(M=(T=i[t])==null?void 0:T.aiAnalysis)!=null&&M.isSafe:!((L=(E=l[t])==null?void 0:E.aiAnalysis)!=null&&L.isToxic))?"bg-primary/30":"bg-red-500/30"}`}),e.jsx("div",{className:`absolute -bottom-[20%] -right-[10%] w-[60%] h-[60%] opacity-20 blur-[150px] transition-colors duration-1000 ${(r==="media"?(z=(D=i[t])==null?void 0:D.aiAnalysis)!=null&&z.isSafe:!((V=($=l[t])==null?void 0:$.aiAnalysis)!=null&&V.isToxic))?"bg-secondary/30":"bg-red-500/30"}`})]}),e.jsxs("div",{className:"flex-1 relative flex flex-col overflow-hidden z-10",children:[e.jsxs("div",{className:"p-10 flex items-center justify-between",children:[e.jsx("button",{onClick:()=>g(!1),className:"group relative bg-white/5 px-8 py-4 rounded-2xl border border-white/10 backdrop-blur-md overflow-hidden transition-all hover:bg-white/10 active:scale-95",children:e.jsxs("div",{className:"relative z-10 flex items-center gap-4",children:[e.jsx(Se,{className:"w-5 h-5 group-hover:rotate-90 transition-transform"}),e.jsx("span",{className:"text-[10px] font-black uppercase tracking-[0.3em] text-white",children:"Sair"})]})}),e.jsxs("div",{className:"flex items-center gap-8 bg-white/5 backdrop-blur-xl px-10 py-4 rounded-3xl border border-white/10 shadow-2xl",children:[e.jsx("button",{onClick:()=>h(Math.max(0,t-1)),disabled:t===0,className:"text-gray-500 hover:text-white disabled:opacity-10 transition-all p-2 bg-white/5 rounded-xl border border-white/5",children:e.jsx("svg",{className:"w-6 h-6 rotate-180",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:e.jsx("path",{d:"M9 5l7 7-7 7"})})}),e.jsxs("div",{className:"text-center min-w-[120px]",children:[e.jsx("div",{className:"text-[9px] text-gray-600 font-black uppercase tracking-[0.4em] mb-1",children:"Fluxo de Auditoria"}),e.jsxs("div",{className:"text-xl font-mono font-black text-white leading-none tracking-tighter",children:[String(t+1).padStart(2,"0")," ",e.jsx("span",{className:"text-gray-700",children:"/"})," ",String((r==="media"?i:l).length).padStart(2,"0")]})]}),e.jsx("button",{onClick:()=>h(Math.min((r==="media"?i:l).length-1,t+1)),disabled:t===(r==="media"?i:l).length-1,className:"text-gray-500 hover:text-white disabled:opacity-10 transition-all p-2 bg-white/5 rounded-xl border border-white/5",children:e.jsx("svg",{className:"w-6 h-6",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",children:e.jsx("path",{d:"M9 5l7 7-7 7"})})})]}),e.jsx("div",{className:"w-32"})]}),e.jsx("div",{className:"flex-1 flex items-center justify-center p-12",children:r==="media"?e.jsxs("div",{className:"relative group max-w-full max-h-full",children:[e.jsx("div",{className:"absolute -inset-10 bg-white/5 rounded-[50px] blur-[100px] opacity-0 group-hover:opacity-100 transition-opacity duration-1000"}),e.jsx("img",{src:(H=i[t])==null?void 0:H.url,className:"relative z-10 max-w-full max-h-[75vh] object-contain rounded-[3rem] shadow-[0_50px_100px_-20px_rgba(0,0,0,0.9)] border border-white/10 scale-100 group-hover:scale-[1.02] transition-transform duration-700",alt:"Audit Visual"})]}):e.jsxs("div",{className:"max-w-4xl w-full p-20 bg-white/[0.02] backdrop-blur-3xl rounded-[4rem] border border-white/10 shadow-2xl relative overflow-hidden group",children:[e.jsx("div",{className:"absolute top-0 left-0 w-3 h-full bg-gradient-to-b from-primary to-secondary opacity-50"}),e.jsx("div",{className:"absolute -top-20 -right-20 w-64 h-64 bg-primary/5 rounded-full blur-[100px]"}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("svg",{className:"w-20 h-20 text-white/5 mb-10",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M14.017 21L14.017 18C14.017 16.8954 14.9124 16 16.017 16H19.017C19.5693 16 20.017 15.5523 20.017 15V9C20.017 8.44772 19.5693 8 19.017 8H16.017C14.9124 8 14.017 7.10457 14.017 6V3L10 3V21H14.017ZM10 21L10 18C10 16.8954 9.10457 16 8 16H5C4.44772 16 4 15.5523 4 15V9C4 8.44772 4.44772 8 5 8H8C9.10457 8 10 7.10457 10 6V3L5.983 3L5.983 21H10Z"})}),e.jsx("p",{className:"text-4xl md:text-5xl text-white leading-tight font-poppins font-black italic mb-12 tracking-tight group-hover:translate-x-2 transition-transform duration-500",children:(O=l[t])==null?void 0:O.comentario}),e.jsxs("div",{className:"flex items-center gap-6 pt-10 border-t border-white/5",children:[e.jsx("div",{className:"w-16 h-16 rounded-2xl bg-gradient-to-tr from-primary to-secondary flex items-center justify-center text-white font-black text-2xl shadow-2xl",children:(R=l[t])==null?void 0:R.avaliador.nome.charAt(0)}),e.jsxs("div",{children:[e.jsx("p",{className:"font-black text-white text-2xl font-poppins tracking-tight uppercase",children:(P=l[t])==null?void 0:P.avaliador.nome}),e.jsx("p",{className:"text-[10px] text-gray-600 uppercase tracking-[0.4em] font-black mt-1",children:"Identificador de Origem"})]})]})]})]})})]}),e.jsxs("div",{className:"w-[500px] bg-dark/60 backdrop-blur-[80px] border-l border-white/5 flex flex-col z-20 shadow-[-50px_0_100px_rgba(0,0,0,0.8)] relative",children:[e.jsx("div",{className:"absolute top-0 right-0 w-full h-1 bg-gradient-to-r from-transparent via-white/10 to-transparent"}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-12 space-y-12 custom-scrollbar",children:[e.jsxs("section",{children:[e.jsx("label",{className:"text-[10px] font-black text-gray-700 uppercase tracking-[0.4em] mb-6 block",children:"Identidade do Alvo"}),e.jsx("div",{className:"bg-white/5 p-8 rounded-[2rem] border border-white/5 hover:bg-white/[0.08] transition-all group/card shadow-xl",children:e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx("div",{className:"w-20 h-20 rounded-2xl bg-black border border-white/10 flex items-center justify-center overflow-hidden shadow-2xl group-hover/card:border-primary transition-colors",children:r==="media"&&((B=i[t])==null?void 0:B.type)==="avatar"?e.jsx("img",{src:i[t].url,className:"w-full h-full object-cover",alt:"Avatar"}):e.jsx(Te,{className:"w-10 h-10 text-gray-700 group-hover/card:text-primary transition-colors"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-2xl font-black text-white truncate leading-none font-poppins tracking-tight uppercase",children:r==="media"?(F=i[t])==null?void 0:F.userName:(U=l[t])==null?void 0:U.avaliador.nome}),e.jsxs("div",{className:"flex items-center gap-3 mt-3",children:[e.jsx("span",{className:"px-3 py-1 bg-white/5 text-gray-500 text-[9px] font-black rounded-lg uppercase tracking-widest border border-white/10",children:r==="media"?(Z=i[t])==null?void 0:Z.userType:"Reviewer"}),e.jsxs("span",{className:"text-primary font-black text-lg leading-none tracking-tighter uppercase font-mono",children:["ID: ",(r==="media"?(W=i[t])==null?void 0:W.userId:(q=l[t])==null?void 0:q.avaliador.id).substring(0,8)]})]})]})]})})]}),e.jsxs("section",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsx("label",{className:"text-[10px] font-black text-gray-700 uppercase tracking-[0.4em]",children:"Status da Auditoria"}),e.jsxs("div",{className:"flex items-center gap-3 bg-white/5 px-4 py-2 rounded-full border border-white/5 shadow-inner",children:[e.jsx("div",{className:`w-2.5 h-2.5 rounded-full animate-pulse ${(r==="media"?(J=(G=i[t])==null?void 0:G.aiAnalysis)!=null&&J.isSafe:!((Q=(K=l[t])==null?void 0:K.aiAnalysis)!=null&&Q.isToxic))?"bg-primary shadow-[0_0_15px_rgba(var(--primary-rgb),0.5)]":"bg-red-500 shadow-[0_0_15px_rgba(239,68,68,0.5)]"}`}),e.jsx("span",{className:`text-[10px] font-black uppercase tracking-[0.2em] ${(r==="media"?(Y=(X=i[t])==null?void 0:X.aiAnalysis)!=null&&Y.isSafe:!((ae=(ee=l[t])==null?void 0:ee.aiAnalysis)!=null&&ae.isToxic))?"text-primary":"text-red-500"}`,children:(r==="media"?(se=(te=i[t])==null?void 0:te.aiAnalysis)!=null&&se.isSafe:!((ie=(re=l[t])==null?void 0:re.aiAnalysis)!=null&&ie.isToxic))?"Rastro Seguro":"Violação Detectada"})]})]}),e.jsxs("div",{className:`p-10 rounded-[2.5rem] border transition-all duration-700 shadow-2xl relative overflow-hidden group/ai ${(r==="media"?(oe=(le=i[t])==null?void 0:le.aiAnalysis)!=null&&oe.isSafe:!((de=(ne=l[t])==null?void 0:ne.aiAnalysis)!=null&&de.isToxic))?"bg-primary/[0.02] border-primary/10":"bg-red-500/[0.02] border-red-500/10"}`,children:[e.jsx("div",{className:`absolute -top-10 -right-10 w-32 h-32 rounded-full blur-3xl opacity-20 ${(r==="media"?(xe=(ce=i[t])==null?void 0:ce.aiAnalysis)!=null&&xe.isSafe:!((pe=(me=l[t])==null?void 0:me.aiAnalysis)!=null&&pe.isToxic))?"bg-primary":"bg-red-500"}`}),e.jsx("p",{className:"text-xl text-white font-medium leading-relaxed font-poppins tracking-tight relative z-10",children:(r==="media"?(ue=(he=i[t])==null?void 0:he.aiAnalysis)==null?void 0:ue.reason:(fe=(be=l[t])==null?void 0:be.aiAnalysis)==null?void 0:fe.reason)||"Executando análise neural profunda no buffer do alvo..."}),e.jsxs("div",{className:"mt-10 flex items-center justify-between text-[9px] font-black uppercase tracking-[0.3em] text-gray-700 border-t border-white/5 pt-8 relative z-10",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-500",children:"Confidence:"}),e.jsx("span",{className:"text-white font-mono",children:"99.82%"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-500",children:"Eng:"}),e.jsx("span",{className:"text-white",children:"RESONA-AI-L4"})]})]})]})]})]}),e.jsxs("div",{className:"p-12 bg-black/40 border-t border-white/5 space-y-5 backdrop-blur-3xl",children:[e.jsxs("button",{onClick:I,className:"w-full h-20 bg-white text-dark rounded-[2rem] font-black uppercase tracking-[0.2em] text-[11px] flex items-center justify-center gap-4 transition-all hover:scale-[1.02] active:scale-95 shadow-[0_25px_50px_rgba(255,255,255,0.1)] group",children:[e.jsx(Me,{className:"w-6 h-6 transition-transform group-hover:scale-110"}),"Validate & Next Stream"]}),e.jsxs("button",{onClick:()=>{r==="media"&&(_(i[t]),u(!0))},className:"w-full h-20 bg-red-600/10 hover:bg-red-600 text-red-500 hover:text-white rounded-[2rem] font-black uppercase tracking-[0.2em] text-[11px] flex items-center justify-center gap-4 transition-all border border-red-500/20 active:scale-95 group",children:[e.jsx(je,{className:"w-6 h-6 transition-transform group-hover:rotate-12"}),"Purge Identity Media"]})]})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-end mb-12 gap-8",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-heading-hero mb-3 uppercase",children:["AUDITORIA DE ",e.jsx("span",{className:"text-primary italic",children:"CONTEÚDO"})]}),e.jsx("p",{className:"text-section-label text-gray-500",children:"Moderação de Conteúdo e Integridade do Ecossistema"})]}),e.jsxs("button",{onClick:()=>{h(0),g(!0),S(r==="media"?i[0]:l[0])},className:"group bg-yellow-500 text-dark font-black uppercase tracking-[0.2em] text-[10px] py-4 px-10 rounded-3xl transition-all shadow-xl hover:bg-white active:scale-95 flex items-center gap-4 animate-pulse hover:animate-none",children:[e.jsx("div",{className:"w-5 h-5 rounded-full bg-dark/10 flex items-center justify-center transition-all group-hover:bg-yellow-500",children:e.jsx("svg",{className:"w-3 h-3",fill:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{d:"M13 10V3L4 14H11V21L20 10H13Z"})})}),"Iniciar Moderação Neural"]})]}),e.jsxs("div",{className:"flex gap-4 mb-10 border-b border-white/5",children:[e.jsxs("button",{onClick:()=>v("media"),className:`relative px-8 py-5 text-section-label transition-all ${r==="media"?"text-white":"text-gray-500 hover:text-gray-300"}`,children:["Ativos Visuais (",w.length,")",r==="media"&&e.jsx("div",{className:"absolute bottom-0 left-0 w-full h-0.5 bg-primary shadow-[0_0_10px_rgba(var(--primary-rgb),0.5)]"})]}),e.jsxs("button",{onClick:()=>v("reviews"),className:`relative px-8 py-5 text-section-label transition-all ${r==="reviews"?"text-white":"text-gray-500 hover:text-gray-300"}`,children:["Avaliações (",y.length,")",r==="reviews"&&e.jsx("div",{className:"absolute bottom-0 left-0 w-full h-0.5 bg-primary shadow-[0_0_10px_rgba(var(--primary-rgb),0.5)]"})]})]}),e.jsx("div",{className:"glass-card p-10 rounded-3xl border-white/5 shadow-2xl min-h-[500px]",children:Ne?e.jsxs("div",{className:"flex flex-col items-center justify-center h-[400px]",children:[e.jsx("div",{className:"w-12 h-12 border-4 border-primary/20 border-t-primary rounded-full animate-spin mb-6"}),e.jsx("p",{className:"text-[10px] font-black uppercase tracking-[0.4em] text-gray-600 animate-pulse",children:"Sincronizando Conteúdos..."})]}):r==="media"?e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-6",children:i.map(s=>e.jsxs("div",{className:"relative aspect-square rounded-[1.5rem] overflow-hidden border border-white/5 group shadow-xl",children:[e.jsx("img",{src:s.url,className:"w-full h-full object-cover grayscale opacity-40 group-hover:grayscale-0 group-hover:opacity-100 group-hover:scale-110 transition-all duration-700",alt:"Audit Target"}),e.jsx("div",{className:"absolute inset-x-0 bottom-0 p-4 bg-gradient-to-t from-black/80 to-transparent translate-y-full group-hover:translate-y-0 transition-transform duration-500",children:e.jsx("p",{className:"text-[9px] font-black text-white uppercase tracking-widest truncate",children:s.userName})}),e.jsx("div",{className:"absolute inset-0 bg-primary/20 opacity-0 group-hover:opacity-100 flex items-center justify-center gap-3 transition-opacity duration-500",children:e.jsx("button",{onClick:()=>{_(s),u(!0)},className:"w-10 h-10 bg-red-500 text-white rounded-xl shadow-2xl flex items-center justify-center hover:scale-110 active:scale-95 transition-all",children:e.jsx(je,{className:"w-4 h-4"})})})]},s.id))}):e.jsx("div",{className:"space-y-6",children:l.map(s=>e.jsxs("div",{className:"group relative p-8 bg-white/[0.02] rounded-[2rem] border border-white/5 hover:border-red-500/30 transition-all shadow-xl overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 p-8",children:e.jsxs("span",{className:"text-4xl font-black text-red-500 font-mono opacity-20 group-hover:opacity-100 transition-opacity tracking-tighter leading-none",children:[s.nota,".0"]})}),e.jsxs("div",{className:"relative z-10 flex flex-col md:flex-row md:items-center justify-between gap-6",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-white/5 flex items-center justify-center text-[10px] font-black text-white border border-white/10 uppercase",children:s.avaliador.nome.charAt(0)}),e.jsxs("p",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest uppercase",children:[e.jsx("span",{className:"text-white",children:s.avaliador.nome})," ",e.jsx("span",{className:"mx-2",children:"→"})," ",e.jsx("span",{className:"text-primary",children:s.alvo.nome})]})]}),e.jsxs("p",{className:"text-xl text-gray-300 font-medium font-poppins tracking-tight italic leading-relaxed",children:['"',s.comentario,'"']})]}),e.jsx("button",{className:"px-6 py-3 bg-white/5 text-gray-600 font-black uppercase tracking-[0.2em] text-[9px] rounded-xl border border-white/5 opacity-0 group-hover:opacity-100 transition-all hover:bg-red-500 hover:text-white hover:border-red-500",children:"Excluir Avaliação"})]})]},s.id))})}),e.jsx(Ee,{isOpen:Ae,onClose:()=>u(!1),onConfirm:_e,title:"Confirmar Deleção",message:e.jsx("p",{children:"Excluir esta mídia permanentemente?"}),confirmText:"Excluir",isConfirming:ke})]})};export{We as default};
