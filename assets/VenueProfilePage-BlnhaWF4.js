import{d as de,j as e,s as x,b as z,o as me,e as T,m as xe}from"./index-Cc-Lnn9x.js";import{i as pe,u as he,r,L as M}from"./vendor-react-Dfcn4nkY.js";import{M as G}from"./MapPinIcon-CPSUTHrZ.js";import{U as F}from"./UsersIcon-DGnNkzTA.js";import{P as ge}from"./PhotographIcon-BhsB4Orm.js";import{i as v}from"./ChevronLeftIcon-BkDyRmha.js";import{C as ue,R as fe}from"./ReviewList-Dv1pMO-J.js";import{S as be,I as ve}from"./ShareIcon-SaElusjt.js";import{C as we}from"./CheckCircleIcon-DMttEdVL.js";import{S as je}from"./SEO-BrO4Q3VS.js";import{B as ye}from"./Breadcrumbs-eOTmfCYt.js";import"./vendor-jspdf-Bh_S0msn.js";import"./vendor-utils-DmyZJLyO.js";import"./vendor-ui-DKtFGipk.js";import"./StarIcon-CdQqkD5t.js";import"./UserCircleIcon-DFsE5r8q.js";import"./EmptyState-DsZCot8O.js";import"./ChevronRightIcon-DOOHeMMz.js";const ze=()=>{var I,U,_,E,L,A,$,D;const{id:d}=pe(),{profile:o,user:Q}=de(),w=he(),[t,Z]=r.useState(null),[j,H]=r.useState([]),[p,J]=r.useState([]),[y,K]=r.useState([]),[N,W]=r.useState(null),[X,h]=r.useState(!0),[Y,g]=r.useState(null),[ee,k]=r.useState(!1),[te,u]=r.useState(""),[S,C]=r.useState(!1),[se,P]=r.useState(!1),[ae,re]=r.useState(0);r.useEffect(()=>{(async()=>{var i,B;if(!d){g("ID não fornecido."),h(!1);return}h(!0),g(null);try{const{data:m,error:le}=await z.from("usuarios").select("*, estabelecimento:estabelecimentos!inner(*)").eq("id",d).eq("tipo","estabelecimento").single();if(le||!m)throw new Error("Perfil não encontrado.");const O=me(m),s=O.estabelecimento;if(s!=null&&s.id){const{data:l}=await z.from("contratos").select("id, data_evento, artistas!inner(usuario_id, usuarios!inner(nome))").eq("estabelecimento_id",s.id).in("status",["assinado","concluido"]).lte("data_evento",new Date().toISOString()).order("data_evento",{ascending:!1});H((l||[]).map(n=>{const c=Array.isArray(n.artistas)?n.artistas[0]:n.artistas,b=c&&(Array.isArray(c.usuarios)?c.usuarios[0]:c.usuarios);return!c||!b?null:{id:n.id,titulo:`Show com ${b.nome}`,data_evento:n.data_evento,artista:{id:c.usuario_id,nome:b.nome}}}).filter(n=>n!==null))}const R=Date.now(),V=((i=s==null?void 0:s.galeria_fotos)==null?void 0:i.filter(l=>!!l))||[],q=((B=s==null?void 0:s.galeria_videos)==null?void 0:B.filter(l=>!!l))||[],[ne,ce]=await Promise.all([V.length>0?x.getSignedUrls("estabelecimento",V,3600):Promise.resolve([]),q.length>0?x.getSignedUrls("estabelecimento",q,3600):Promise.resolve([])]);J(ne.map(l=>`${l}&t=${R}`)),K(ce),s!=null&&s.foto_capa&&W(`${x.getPublicUrl("estabelecimento",s.foto_capa)}?t=${R}`),Z(O)}catch(m){g(T(m))}finally{h(!1)}})()},[d]);const oe=async a=>{k(!0),u("");try{if(!Q){w("/login");return}if(!o)throw new Error("Perfil não carregado.");await xe.startConversation(o.id,a.id,`Olá, somos do ${o.nome}!`),u("Conversa iniciada!"),setTimeout(()=>{w("/painel?open=mensagens")},1500)}catch(i){u(T(i))}finally{k(!1)}};if(X)return e.jsx("div",{className:"flex justify-center items-center h-screen bg-dark text-white",children:"Carregando..."});if(Y||!t)return e.jsxs("div",{className:"flex flex-col justify-center items-center h-screen bg-dark text-red-500",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Perfil não encontrado"}),e.jsx(M,{to:"/estabelecimentos",className:"mt-4 text-primary underline",children:"Voltar"})]});const f=t.foto_url?`${x.getPublicUrl("perfis",t.foto_url)}?t=${Date.now()}`:"https://images.unsplash.com/photo-1550966871-3ed3cdb5ed0c?q=80&w=2070&auto=format&fit=crop",ie={"@context":"https://schema.org","@type":"EntertainmentBusiness",name:t.nome,description:((I=t.estabelecimento)==null?void 0:I.descricao)||"",image:f,address:{"@type":"PostalAddress",streetAddress:((U=t.estabelecimento)==null?void 0:U.endereco)||"",addressLocality:t.cidade,addressCountry:"BR"}};return e.jsxs("div",{className:"bg-dark text-white font-sans min-h-screen pb-24 lg:pb-0 relative",children:[e.jsx(je,{title:t.nome,description:((E=(_=t.estabelecimento)==null?void 0:_.descricao)==null?void 0:E.substring(0,160))||`Confira o perfil de ${t.nome} no Resona. O lugar ideal para shows e eventos.`,image:f,type:"profile",schema:ie}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"h-[45vh] md:h-[55vh] bg-cover bg-center relative",style:{backgroundImage:N?`url(${N})`:"linear-gradient(to right, #1f2937, #111827)"},children:e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-dark via-dark/60 to-transparent"})}),e.jsxs("div",{className:"container mx-auto px-4 relative -mt-40 md:-mt-48 z-10",children:[e.jsx(ye,{items:[{label:"Estabelecimentos",path:"/estabelecimentos"},{label:t.nome,path:`/estabelecimento/${d}`}]}),e.jsxs("div",{className:"flex flex-col md:flex-row items-center md:items-end gap-10 pt-8",children:[e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"absolute -inset-1 bg-gradient-to-br from-secondary to-primary rounded-3xl blur opacity-25 group-hover:opacity-50 transition duration-1000"}),e.jsx("img",{src:f,alt:t.nome,className:"w-48 h-48 md:w-64 md:h-64 rounded-3xl object-cover border-8 border-dark/50 shadow-2xl relative z-10 bg-gray-900"})]}),e.jsxs("div",{className:"flex-grow mb-4 text-center md:text-left",children:[e.jsxs("div",{className:"flex items-center justify-center md:justify-start gap-4 mb-3",children:[e.jsx("span",{className:"glass-card border-secondary/20 text-secondary px-5 py-1.5 rounded-full text-[10px] font-black uppercase tracking-[0.3em] shadow-lg shadow-secondary/5",children:"Venue / Local"}),t.plano!=="free"&&e.jsxs("div",{className:"flex items-center gap-1.5 bg-primary/10 text-primary px-3 py-1.5 rounded-full border border-primary/20 shadow-lg shadow-primary/5",children:[e.jsx(we,{className:"w-3.5 h-3.5"}),e.jsx("span",{className:"text-[9px] font-black uppercase tracking-widest",children:"Premium"})]})]}),e.jsx("h1",{className:"text-4xl sm:text-5xl md:text-8xl font-black font-poppins tracking-tighter leading-none text-white drop-shadow-2xl",children:t.nome}),e.jsxs("div",{className:"flex flex-wrap items-center justify-center md:justify-start gap-6 mt-6",children:[e.jsxs("div",{className:"flex items-center text-gray-400 font-bold uppercase tracking-[0.2em] text-[11px]",children:[e.jsx(G,{className:"w-4 h-4 mr-2 text-primary"}),e.jsx("span",{children:t.cidade||"Brasil"})]}),((L=t.estabelecimento)==null?void 0:L.capacidade)&&e.jsxs("div",{className:"flex items-center text-gray-400 font-bold uppercase tracking-[0.2em] text-[11px]",children:[e.jsx(F,{className:"w-4 h-4 mr-2 text-secondary"}),e.jsxs("span",{children:[t.estabelecimento.capacidade," Pessoas"]})]})]})]}),e.jsxs("div",{className:"mb-6 md:mb-10 flex flex-col sm:flex-row gap-4 w-full md:w-auto justify-center relative z-20",children:[e.jsxs("button",{onClick:()=>{navigator.clipboard.writeText(window.location.href),C(!0),setTimeout(()=>C(!1),2e3)},className:"flex items-center justify-center gap-3 bg-white/5 backdrop-blur-xl px-8 py-4 rounded-full border border-white/10 shadow-2xl text-[10px] font-black uppercase tracking-widest hover:bg-white/10 transition-all active:scale-95 group",children:[S?e.jsx(ue,{className:"w-5 h-5 text-green-400"}):e.jsx(be,{className:"w-5 h-5 text-gray-400 group-hover:text-white"}),S?"Link Copiado":"Compartilhar"]}),(o==null?void 0:o.tipo)==="artista"&&e.jsx("button",{onClick:()=>oe(t),disabled:ee||!v(o).complete,className:`font-black uppercase tracking-[0.2em] text-[10px] py-4 px-10 rounded-full shadow-2xl transform transition-all active:scale-95 ${v(o).complete?"bg-white text-dark hover:bg-secondary hover:shadow-secondary/20":"bg-white/5 text-gray-600 cursor-not-allowed border border-white/5"}`,title:v(o).complete?"Enviar Mensagem":"Complete seu perfil de artista para enviar mensagens.",children:te||"Falar com Local"})]})]})]})]}),e.jsx("div",{className:"container mx-auto px-4 py-20 relative z-10",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-16",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-16",children:[e.jsxs("section",{className:"glass-card p-10 md:p-12 rounded-3xl border-white/5 relative overflow-hidden group",children:[e.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-secondary/5 rounded-full blur-[100px] pointer-events-none group-hover:bg-secondary/10 transition-colors"}),e.jsx("h2",{className:"text-[10px] font-black uppercase tracking-[0.4em] text-gray-500 mb-6",children:"Experience & Atmosfera"}),e.jsx("p",{className:"text-white leading-premium text-xl whitespace-pre-wrap font-medium",children:((A=t.estabelecimento)==null?void 0:A.descricao)||"Sem descrição detalhada."})]}),e.jsxs("section",{className:"glass-card p-10 md:p-12 rounded-3xl border-white/5 relative overflow-hidden group",children:[e.jsx("h2",{className:"text-[10px] font-black uppercase tracking-[0.4em] text-gray-500 mb-10",children:"Lineup Local: Quem já tocou"}),j.length>0?e.jsx("div",{className:"space-y-4",children:j.map(a=>e.jsx("div",{className:"flex items-center justify-between bg-white/[0.03] p-6 rounded-2xl border border-white/[0.02] hover:border-secondary/30 transition-all group/event relative overflow-hidden",children:e.jsxs("div",{className:"flex items-center gap-6 relative z-10",children:[e.jsxs("div",{className:"bg-white/5 p-4 rounded-2xl text-center min-w-[80px] border border-white/5 shadow-xl group-hover/event:border-secondary/20 transition-all",children:[e.jsx("span",{className:"block text-[10px] text-secondary font-black uppercase tracking-[0.2em]",children:new Date(a.data_evento).toLocaleString("pt-BR",{month:"short",timeZone:"UTC"})}),e.jsx("span",{className:"block text-3xl font-black text-white font-mono leading-none mt-1",children:new Date(a.data_evento).getUTCDate()})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-black text-white text-xl font-poppins tracking-tighter leading-tight group-hover/event:text-secondary transition-colors",children:a.titulo}),e.jsxs(M,{to:`/artista/${a.artista.id}`,className:"text-[11px] font-black text-secondary uppercase tracking-widest mt-2 hover:underline",children:["Artist: ",a.artista.nome]})]})]})},a.id))}):e.jsx("div",{className:"text-center py-12 text-gray-600 font-bold uppercase tracking-widest text-sm bg-white/[0.02] rounded-3xl border border-dashed border-white/5",children:"Nenhum evento passado registrado"})]}),e.jsxs("section",{className:"space-y-10",children:[e.jsx("h2",{className:"text-[10px] font-black uppercase tracking-[0.4em] text-gray-500",children:"Galeria Ambiente"}),p.length>0?e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-6",children:p.map((a,i)=>e.jsxs("div",{onClick:()=>{re(i),P(!0)},className:"cursor-pointer group relative overflow-hidden rounded-3xl aspect-square shadow-2xl transition-all hover:p-1 hover:bg-white/5 border border-white/5",children:[e.jsx("img",{src:a,alt:"Galeria",className:"w-full h-full object-cover transition-all duration-700 group-hover:scale-110 group-hover:rounded-[1.8rem]"}),e.jsx("div",{className:"absolute inset-0 bg-secondary/20 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center backdrop-blur-sm",children:e.jsx(ge,{className:"w-10 h-10 text-white shadow-2xl"})})]},i))}):e.jsx("p",{className:"text-gray-600 font-bold uppercase tracking-widest text-xs italic",children:"Nenhuma foto pública disponível"})]}),y.length>0&&e.jsxs("section",{className:"space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold font-poppins",children:"Vídeos do Local"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:y.map((a,i)=>e.jsx("div",{className:"bg-gray-900 rounded-xl overflow-hidden border border-gray-700 shadow-lg group hover:border-secondary/50 transition-colors",children:e.jsx("video",{controls:!0,className:"w-full aspect-video object-cover bg-black",src:a,preload:"metadata"})},i))})]}),e.jsxs("section",{className:"pt-8 border-t border-gray-800",children:[e.jsx("h2",{className:"text-2xl font-bold font-poppins mb-8",children:"Avaliações"}),e.jsx(fe,{targetId:t.id})]})]}),e.jsx("aside",{className:"lg:col-span-1",children:e.jsxs("div",{className:"glass-card p-10 rounded-3xl border-white/5 relative overflow-hidden shadow-2xl sticky top-24",children:[e.jsx("div",{className:"absolute top-0 left-0 w-32 h-32 bg-secondary/5 rounded-full blur-[60px] pointer-events-none"}),e.jsx("h2",{className:"text-[10px] font-black uppercase tracking-[0.4em] text-gray-500 mb-8 border-b border-white/5 pb-4",children:"Check-in Info"}),e.jsxs("div",{className:"space-y-6",children:[(($=t.estabelecimento)==null?void 0:$.endereco)&&e.jsxs("div",{className:"flex items-start gap-4 p-5 bg-white/[0.03] rounded-2xl border border-white/5",children:[e.jsx(G,{className:"w-6 h-6 text-primary flex-shrink-0"}),e.jsx("span",{className:"text-gray-300 text-sm font-medium leading-relaxed",children:t.estabelecimento.endereco})]}),((D=t.estabelecimento)==null?void 0:D.capacidade)&&e.jsxs("div",{className:"flex items-center gap-4 p-5 bg-white/[0.03] rounded-2xl border border-white/5",children:[e.jsx(F,{className:"w-6 h-6 text-secondary"}),e.jsxs("span",{className:"text-gray-300 text-sm font-bold",children:["Capacidade: ",e.jsx("span",{className:"text-white font-mono text-lg",children:t.estabelecimento.capacidade})]})]}),t.email&&e.jsxs("div",{className:"pt-6 border-t border-white/5",children:[e.jsx("p",{className:"text-[9px] text-gray-600 uppercase font-black tracking-widest mb-2",children:"Comercial / Booking"}),e.jsx("a",{href:`mailto:${t.email}`,className:"text-primary hover:text-white transition-colors font-mono text-sm break-all font-black",children:t.email})]})]})]})})]})}),e.jsx(ve,{isOpen:se,images:p,initialIndex:ae,onClose:()=>P(!1)})]})};export{ze as default};
