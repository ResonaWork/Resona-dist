import{r as t,p as m,e as p,j as e}from"./index-GuXP6Wz1.js";import{C as _}from"./CheckCircleIcon-aPMIrVJF.js";import{X as M}from"./XCircleIcon-0yDfXLBp.js";import{S as q}from"./SearchIcon-DpzGgnsg.js";import{C as N}from"./ConfirmationModal-mSHnxQZ5.js";import"./ExclamationIcon-DRlgwyPd.js";const z=()=>{const[w,S]=t.useState([]),[C,h]=t.useState(!0),[D,P]=t.useState(null),[r,R]=t.useState(""),[c,L]=t.useState("all"),[s,o]=t.useState(null),[I,d]=t.useState(!1),[k,x]=t.useState(!1),[g,l]=t.useState(!1),[f,j]=t.useState("");t.useEffect(()=>{u()},[]);const u=async()=>{h(!0);try{const a=await m.listAllPayouts();S(a)}catch(a){P(p(a))}finally{h(!1)}},A=async()=>{if(s){l(!0);try{await m.updatePayoutStatus(s.id,{status:"pago",data_pagamento:new Date().toISOString(),comprovante_url:f||void 0}),d(!1),o(null),j(""),u()}catch(a){alert(p(a))}finally{l(!1)}}},O=async()=>{if(s){l(!0);try{await m.updatePayoutStatus(s.id,{status:"rejeitado"}),x(!1),o(null),u()}catch(a){alert(p(a))}finally{l(!1)}}},T=a=>{navigator.clipboard.writeText(a),alert("Copiado para a área de transferência!")},y=w.filter(a=>{var b,v;const n=((b=a.usuarios)==null?void 0:b.nome.toLowerCase().includes(r.toLowerCase()))||((v=a.usuarios)==null?void 0:v.email.toLowerCase().includes(r.toLowerCase()))||a.chave_pix.includes(r),i=c==="all"||a.status===c;return n&&i});return e.jsxs("div",{className:"text-white animate-fade-in",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2 text-primary font-poppins",children:"Auditoria de Saques"}),e.jsx("p",{className:"text-gray-400 mb-8",children:"Gerencie as solicitações de transferência PIX para os artistas."}),e.jsxs("div",{className:"bg-gray-800 p-5 rounded-xl mb-8 border border-gray-700 shadow-md flex flex-col lg:flex-row items-center gap-4",children:[e.jsxs("div",{className:"relative flex-grow w-full lg:w-auto",children:[e.jsx("input",{type:"text",placeholder:"Buscar por nome, email ou chave PIX...",value:r,onChange:a=>R(a.target.value),className:"w-full bg-gray-900 border border-gray-600 rounded-lg py-2 pl-10 pr-4 focus:outline-none focus:ring-2 focus:ring-primary text-white"}),e.jsx(q,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"})]}),e.jsxs("select",{value:c,onChange:a=>L(a.target.value),className:"bg-gray-900 border border-gray-600 rounded-lg py-2 px-4 focus:outline-none focus:ring-2 focus:ring-primary text-white",children:[e.jsx("option",{value:"all",children:"Todos os Status"}),e.jsx("option",{value:"pendente",children:"Pendente"}),e.jsx("option",{value:"pago",children:"Pago"}),e.jsx("option",{value:"rejeitado",children:"Rejeitado"})]})]}),e.jsx("div",{className:"bg-gray-800 rounded-xl overflow-hidden border border-gray-700 shadow-xl",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{className:"bg-gray-900 text-gray-400 text-xs uppercase font-bold",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-4",children:"Solicitante"}),e.jsx("th",{className:"p-4",children:"Dados PIX"}),e.jsx("th",{className:"p-4",children:"Valor"}),e.jsx("th",{className:"p-4",children:"Status"}),e.jsx("th",{className:"p-4 text-right",children:"Ações"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-700 text-sm",children:C?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"p-8 text-center",children:"Carregando fila..."})}):y.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"p-8 text-center text-gray-500",children:"Nenhum saque encontrado."})}):y.map(a=>{var n,i;return e.jsxs("tr",{className:"hover:bg-gray-750 transition-colors",children:[e.jsxs("td",{className:"p-4",children:[e.jsx("p",{className:"font-bold text-white",children:(n=a.usuarios)==null?void 0:n.nome}),e.jsx("p",{className:"text-xs text-gray-500",children:(i=a.usuarios)==null?void 0:i.email}),e.jsx("p",{className:"text-[10px] text-gray-600 mt-1",children:new Date(a.criado_em).toLocaleString()})]}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs bg-gray-900 px-2 py-0.5 rounded border border-gray-700 uppercase",children:a.tipo_chave}),e.jsx("button",{onClick:()=>T(a.chave_pix),className:"text-primary hover:underline font-mono text-xs",children:a.chave_pix})]})}),e.jsx("td",{className:"p-4",children:e.jsxs("p",{className:"font-black text-white font-mono text-lg",children:["R$ ",a.valor.toLocaleString("pt-BR",{minimumFractionDigits:2})]})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:`px-2 py-1 rounded text-[10px] font-black uppercase border ${a.status==="pago"?"bg-green-500/10 text-green-400 border-green-500/30":a.status==="rejeitado"?"bg-red-500/10 text-red-400 border-red-500/30":"bg-yellow-500/10 text-yellow-400 border-yellow-500/30 animate-pulse"}`,children:a.status})}),e.jsx("td",{className:"p-4 text-right",children:a.status==="pendente"&&e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>{o(a),d(!0)},className:"p-2 bg-green-600 hover:bg-green-500 rounded text-white shadow-lg",title:"Marcar como Pago",children:e.jsx(_,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>{o(a),x(!0)},className:"p-2 bg-red-600 hover:bg-red-500 rounded text-white shadow-lg",title:"Rejeitar",children:e.jsx(M,{className:"w-5 h-5"})})]})})]},a.id)})})]})})}),e.jsx(N,{isOpen:I,onClose:()=>d(!1),onConfirm:A,title:"Confirmar Pagamento",message:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{children:["Você confirma que realizou a transferência de ",e.jsxs("strong",{children:["R$ ",s==null?void 0:s.valor.toLocaleString("pt-BR",{minimumFractionDigits:2})]})," para a chave PIX abaixo?"]}),e.jsx("div",{className:"bg-gray-900 p-3 rounded font-mono text-sm border border-gray-700 break-all",children:s==null?void 0:s.chave_pix}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"URL do Comprovante (Opcional)"}),e.jsx("input",{type:"text",value:f,onChange:a=>j(a.target.value),className:"w-full bg-gray-900 border border-gray-700 rounded p-2 text-sm",placeholder:"Link do PDF/Imagem"})]})]}),confirmText:"Confirmar Saque",isConfirming:g}),e.jsx(N,{isOpen:k,onClose:()=>x(!1),onConfirm:O,title:"Rejeitar Solicitação",message:e.jsx("p",{children:"Tem certeza que deseja rejeitar este pedido de saque? O usuário será notificado e o saldo voltará a ficar disponível para nova solicitação."}),confirmText:"Rejeitar",isConfirming:g})]})};export{z as default};
