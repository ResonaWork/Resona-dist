import{a as d,j as e,s as R,e as m}from"./index-BFt0Ikit.js";import{r as s}from"./vendor-react-Dfcn4nkY.js";import{C as S}from"./CheckCircleIcon-njgD2g6Y.js";import{X as A}from"./XCircleIcon-Cx3nNHJy.js";import{E as D}from"./EyeIcon-DnPQewAG.js";import{C as g}from"./ConfirmationModal-Dt4DDcZS.js";import"./vendor-jspdf-Bh_S0msn.js";import"./vendor-utils-DmyZJLyO.js";import"./vendor-ui-DKtFGipk.js";import"./ExclamationIcon-CJ8kVB9p.js";const F=()=>{const[x,f]=s.useState([]),[u,h]=s.useState(!0),[E,O]=s.useState(null),[y,i]=s.useState(!1),[v,l]=s.useState(!1),[a,o]=s.useState(null),[p,N]=s.useState("Documento ilegível"),[j,r]=s.useState(!1);s.useEffect(()=>{c()},[]);const c=async()=>{h(!0);try{const t=await d.listPendingKyc();f(t)}catch(t){console.error(t)}finally{h(!1)}},b=async t=>{try{const n=await R.getSignedUrls("site",[t],300);n.length>0&&window.open(n[0],"_blank")}catch(n){alert("Erro ao gerar link do documento: "+m(n))}},w=async()=>{if(a){r(!0);try{await d.approveKyc(a.id),i(!1),o(null),c()}catch(t){alert(m(t))}finally{r(!1)}}},C=async()=>{if(a){r(!0);try{await d.rejectKyc(a.id,p),l(!1),o(null),c()}catch(t){alert(m(t))}finally{r(!1)}}};return e.jsxs("div",{className:"text-white animate-fade-in",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2 text-primary font-poppins",children:"Fila de Verificação (KYC)"}),e.jsx("p",{className:"text-gray-400 mb-8",children:"Revise documentos de identidade para validar perfis."}),e.jsx("div",{className:"bg-gray-800 rounded-xl border border-gray-700 overflow-hidden shadow-xl",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{className:"bg-gray-900 text-gray-400 text-xs uppercase font-bold",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-4",children:"Usuário"}),e.jsx("th",{className:"p-4",children:"Tipo"}),e.jsx("th",{className:"p-4",children:"Data Envio"}),e.jsx("th",{className:"p-4 text-right",children:"Ações"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-700 text-sm",children:u?e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"p-8 text-center",children:"Carregando fila..."})}):x.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"p-8 text-center text-gray-500",children:"Nenhuma solicitação pendente."})}):x.map(t=>e.jsxs("tr",{className:"hover:bg-gray-750 transition-colors",children:[e.jsxs("td",{className:"p-4",children:[e.jsx("p",{className:"font-bold text-white",children:t.nome}),e.jsx("p",{className:"text-xs text-gray-500",children:t.email})]}),e.jsx("td",{className:"p-4 capitalize",children:t.tipo}),e.jsx("td",{className:"p-4 text-gray-400",children:new Date(t.criado_em).toLocaleDateString()}),e.jsxs("td",{className:"p-4 text-right flex justify-end gap-2",children:[e.jsx("button",{onClick:()=>t.documento_url&&b(t.documento_url),className:"p-2 bg-gray-700 hover:bg-gray-600 rounded text-white shadow",title:"Ver Documento",children:e.jsx(D,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>{o(t),i(!0)},className:"p-2 bg-green-600 hover:bg-green-500 rounded text-white shadow",title:"Aprovar",children:e.jsx(S,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>{o(t),l(!0)},className:"p-2 bg-red-600 hover:bg-red-500 rounded text-white shadow",title:"Rejeitar",children:e.jsx(A,{className:"w-5 h-5"})})]})]},t.id))})]})})}),e.jsx(g,{isOpen:y,onClose:()=>i(!1),onConfirm:w,title:"Aprovar Verificação",message:e.jsxs("p",{children:["Você confirma que o documento enviado por ",e.jsx("strong",{children:a==null?void 0:a.nome})," é válido e legível?"]}),confirmText:"Confirmar",isConfirming:j}),e.jsx(g,{isOpen:v,onClose:()=>l(!1),onConfirm:C,title:"Rejeitar Verificação",message:e.jsxs("div",{children:[e.jsx("p",{children:"Por que este documento está sendo rejeitado?"}),e.jsxs("select",{value:p,onChange:t=>N(t.target.value),className:"w-full mt-3 bg-gray-900 border border-gray-700 rounded p-2 text-sm text-white",children:[e.jsx("option",{children:"Documento ilegível"}),e.jsx("option",{children:"Foto cortada"}),e.jsx("option",{children:"Documento expirado"}),e.jsx("option",{children:"Identidade não corresponde ao nome"}),e.jsx("option",{children:"Outros motivos"})]})]}),confirmText:"Rejeitar",isConfirming:j})]})};export{F as default};
