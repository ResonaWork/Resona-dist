import{j as e,w as y,e as u,u as q,b as U}from"./index-BRiOCH-Z.js";import{r as s}from"./vendor-react-Dfcn4nkY.js";import{U as z}from"./UploadIcon-C6RS7x-H.js";import{C as O}from"./CheckCircleIcon-B46rUiSJ.js";import{P as T}from"./PlusIcon-CfHyqMLa.js";import{T as M}from"./TrashIcon-BwB9Gk6W.js";import"./vendor-pdf-CuP9pQX9.js";import"./vendor-utils-DmyZJLyO.js";import"./vendor-ui-DKtFGipk.js";const C=({bucketName:g,fileName:h,label:f,description:r,onUploadSuccess:j})=>{const[v,N]=s.useState(!1),[m,i]=s.useState(null),[o,p]=s.useState(!1),w=async t=>{var l;const c=(l=t.target.files)==null?void 0:l[0];if(c){N(!0),i(null),p(!1);try{await y.uploadAsset(g,h,c),p(!0),j(),setTimeout(()=>p(!1),3e3)}catch(x){i(u(x))}finally{N(!1)}}};return e.jsxs("div",{className:"bg-gray-900 p-4 rounded-lg border border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-bold text-white",children:f}),e.jsx("p",{className:"text-xs text-gray-500",children:r})]}),o&&e.jsx(O,{className:"w-5 h-5 text-green-500 animate-fade-in"})]}),e.jsxs("label",{className:`mt-2 flex items-center justify-center w-full h-12 border-2 border-dashed rounded-lg cursor-pointer transition-colors ${m?"border-red-500 bg-red-500/10":"border-gray-600 hover:border-primary hover:bg-gray-800"}`,children:[v?e.jsx("div",{className:"w-5 h-5 border-2 border-primary border-t-transparent rounded-full animate-spin"}):e.jsxs("div",{className:"flex items-center gap-2 text-gray-400",children:[e.jsx(z,{className:"w-4 h-4"}),e.jsx("span",{className:"text-xs font-bold",children:"Selecionar Arquivo"})]}),e.jsx("input",{type:"file",className:"hidden",onChange:w,disabled:v,accept:"image/*,.ico"})]}),m&&e.jsx("p",{className:"text-xs text-red-400 mt-2",children:m})]})},Q=()=>{const{refreshSiteConfig:g,genres:h,refreshGenres:f,siteConfig:r}=q(),[j,v]=s.useState([]),[N,m]=s.useState(!0),[i,o]=s.useState(null),[p,w]=s.useState("logo_and_name"),[t,c]=s.useState({opacity:.6,blur:0,color:"#000000"}),[l,x]=s.useState({head:"",bodyStart:"",bodyEnd:""}),[n,b]=s.useState({supabaseUrl:"",supabaseAnonKey:"",geminiApiKey:"",stripePublishableKey:""}),[S,A]=s.useState(""),[k,K]=s.useState(!1);s.useEffect(()=>{if(i){const a=setTimeout(()=>o(null),5e3);return()=>clearTimeout(a)}},[i]),s.useEffect(()=>{w(r.brandingOption),c({opacity:r.heroOpacity,blur:r.heroBlur,color:r.heroOverlayColor}),x({head:r.scriptHead||"",bodyStart:r.scriptBodyStart||"",bodyEnd:r.scriptBodyEnd||""}),b({supabaseUrl:r.supabaseUrl||"",supabaseAnonKey:r.supabaseAnonKey||"",geminiApiKey:r.geminiApiKey||"",stripePublishableKey:r.stripePublishableKey||""}),(async()=>{m(!0);try{const{data:d,error:E}=await U.from("usuarios").select("*").in("role",["moderador","analista"]).order("nome",{ascending:!0});if(E)throw E;v(d||[])}catch(d){console.error("Error fetching staff data:",d),o({message:"Erro ao carregar equipe: "+u(d),type:"error"})}finally{m(!1)}})()},[r]);const G=async()=>{try{await y.updateSystemConfig({brandingOption:p,heroOpacity:t.opacity,heroBlur:t.blur,heroOverlayColor:t.color,scriptHead:l.head,scriptBodyStart:l.bodyStart,scriptBodyEnd:l.bodyEnd,supabaseUrl:n.supabaseUrl,supabaseAnonKey:n.supabaseAnonKey,geminiApiKey:n.geminiApiKey,stripePublishableKey:n.stripePublishableKey}),g(),o({message:"Configurações visuais salvas com sucesso.",type:"success"})}catch(a){o({message:"Erro ao salvar: "+u(a),type:"error"})}},I=async()=>{try{await y.updateHomeBackground("home-bg.jpg"),g(),o({message:"Imagem de fundo atualizada com sucesso.",type:"success"})}catch(a){o({message:"Imagem enviada, mas falha ao atualizar config: "+u(a),type:"error"})}},P=async a=>{if(a.preventDefault(),!!S.trim()){K(!0);try{await y.addGenre(S.trim()),A(""),f(),o({message:"Gênero adicionado.",type:"success"})}catch(d){o({message:"Erro ao adicionar gênero: "+u(d),type:"error"})}finally{K(!1)}}},B=async a=>{if(window.confirm("Tem certeza que deseja remover este gênero?"))try{await y.removeGenre(a),f(),o({message:"Gênero removido.",type:"success"})}catch(d){o({message:"Erro ao remover gênero: "+u(d),type:"error"})}};return e.jsxs("div",{className:"text-white animate-fade-in",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold mb-2 text-primary font-poppins",children:"Configurações do Sistema"}),e.jsx("p",{className:"text-gray-400",children:"Gerencie a identidade visual, recursos globais e permissões."})]}),e.jsx("button",{onClick:G,className:"bg-primary hover:bg-primary/90 text-dark font-bold py-2 px-6 rounded-lg shadow-lg transition-all transform hover:scale-105",children:"Salvar Alterações"})]}),i&&e.jsx("div",{className:`p-4 mb-6 rounded-md ${i.type==="success"?"bg-green-500/20 text-green-300":"bg-red-500/20 text-red-300"}`,children:i.message}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-800 p-6 rounded-xl border border-gray-700 shadow-lg",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4 border-b border-gray-700 pb-2",children:"Identidade Visual"}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-3",children:"Exibição da Marca no Header"}),e.jsx("div",{className:"flex gap-4",children:[{value:"logo",label:"Apenas Logo"},{value:"name",label:"Apenas Nome"},{value:"logo_and_name",label:"Logo + Nome"}].map(a=>e.jsx("button",{onClick:()=>w(a.value),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors border ${p===a.value?"bg-primary/20 border-primary text-primary":"bg-gray-900 border-gray-600 text-gray-400 hover:bg-gray-700"}`,children:a.label},a.value))})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(C,{bucketName:"site",fileName:"logo.png",label:"Logo Principal",description:"Imagem exibida no cabeçalho (Recomendado: PNG transparente).",onUploadSuccess:g}),e.jsx(C,{bucketName:"site",fileName:"favicon.ico",label:"Favicon",description:"Ícone da aba do navegador (.ico ou .png).",onUploadSuccess:()=>{}}),e.jsxs("div",{className:"border-t border-gray-700 pt-6",children:[e.jsx("h3",{className:"font-bold text-white mb-4",children:"Hero (Banner Principal)"}),e.jsx(C,{bucketName:"site",fileName:"home-bg.jpg",label:"Imagem de Fundo",description:"Imagem de alta resolução para o banner principal.",onUploadSuccess:I}),e.jsxs("div",{className:"mt-6 space-y-4 bg-gray-900 p-4 rounded-lg border border-gray-700",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Opacidade da Camada Escura"}),e.jsxs("span",{className:"text-xs text-primary font-mono",children:[Math.round(t.opacity*100),"%"]})]}),e.jsx("input",{type:"range",min:"0",max:"1",step:"0.05",value:t.opacity,onChange:a=>c({...t,opacity:parseFloat(a.target.value)}),className:"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-primary"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Desfoque (Blur)"}),e.jsxs("span",{className:"text-xs text-primary font-mono",children:[t.blur,"px"]})]}),e.jsx("input",{type:"range",min:"0",max:"20",step:"1",value:t.blur,onChange:a=>c({...t,blur:parseInt(a.target.value)}),className:"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer accent-primary"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"text-sm font-medium text-gray-300",children:"Cor da Camada"}),e.jsx("input",{type:"color",value:t.color,onChange:a=>c({...t,color:a.target.value}),className:"h-8 w-16 bg-transparent border border-gray-600 rounded cursor-pointer"})]}),e.jsx("div",{className:"text-xs text-gray-500 mt-2 text-center",children:'* Clique em "Salvar Alterações" no topo para aplicar.'})]})]})]})]}),e.jsxs("div",{className:"bg-gray-800 p-6 rounded-xl border border-gray-700 shadow-lg",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4 border-b border-gray-700 pb-2",children:"Scripts Externos & Tags"}),e.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"Injete scripts customizados (GA4, Facebook Pixel, GTM) em partes específicas do site."}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Scripts no <head>"}),e.jsx("textarea",{value:l.head,onChange:a=>x({...l,head:a.target.value}),placeholder:"<!-- Google Tag Manager --> ...",className:"w-full h-32 bg-gray-900 border border-gray-600 rounded-md p-3 text-xs font-mono text-gray-300 focus:ring-1 focus:ring-primary outline-none"}),e.jsx("p",{className:"text-[10px] text-gray-500 mt-1",children:"Carregado antes de qualquer outro conteúdo."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Scripts no Início do <body>"}),e.jsx("textarea",{value:l.bodyStart,onChange:a=>x({...l,bodyStart:a.target.value}),placeholder:"<!-- GTM noscript --> ...",className:"w-full h-32 bg-gray-900 border border-gray-600 rounded-md p-3 text-xs font-mono text-gray-300 focus:ring-1 focus:ring-primary outline-none"}),e.jsx("p",{className:"text-[10px] text-gray-500 mt-1",children:"Ideal para tags noscript ou widgets de chat."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Scripts no Final do <body>"}),e.jsx("textarea",{value:l.bodyEnd,onChange:a=>x({...l,bodyEnd:a.target.value}),placeholder:"<!-- Custom scripts --> ...",className:"w-full h-32 bg-gray-900 border border-gray-600 rounded-md p-3 text-xs font-mono text-gray-300 focus:ring-1 focus:ring-primary outline-none"}),e.jsx("p",{className:"text-[10px] text-gray-500 mt-1",children:"Carregado após toda a estrutura visual estar pronta."})]})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-800 p-6 rounded-xl border border-gray-700 shadow-lg",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4 border-b border-gray-700 pb-2",children:"Gêneros Musicais"}),e.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Adicione ou remova gêneros disponíveis para os artistas."}),e.jsxs("form",{onSubmit:P,className:"flex gap-2 mb-6",children:[e.jsx("input",{type:"text",value:S,onChange:a=>A(a.target.value),placeholder:"Novo Gênero (ex: Jazz Fusion)",className:"flex-grow bg-gray-900 border border-gray-600 rounded-md py-2 px-3 text-white focus:outline-none focus:ring-2 focus:ring-primary text-sm"}),e.jsx("button",{type:"submit",disabled:k||!S.trim(),className:"bg-primary hover:bg-primary/80 text-dark font-bold px-4 py-2 rounded-md transition-colors disabled:opacity-50",children:e.jsx(T,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"flex flex-wrap gap-2 max-h-60 overflow-y-auto custom-scrollbar p-1",children:h.length>0?h.map(a=>e.jsxs("div",{className:"group flex items-center gap-2 bg-gray-900 border border-gray-600 px-3 py-1.5 rounded-full text-sm hover:border-primary transition-colors",children:[e.jsx("span",{className:"text-gray-200",children:a.nome}),e.jsx("button",{onClick:()=>B(a.id),className:"text-gray-500 hover:text-red-400 opacity-0 group-hover:opacity-100 transition-opacity",title:"Remover",children:e.jsx(M,{className:"w-3 h-3"})})]},a.id)):e.jsx("p",{className:"text-gray-500 italic text-sm",children:"Nenhum gênero cadastrado."})})]}),e.jsxs("div",{className:"bg-gray-800 p-6 rounded-xl border border-gray-700 shadow-lg border-l-4 border-l-red-500",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4 border-b border-gray-700 pb-2 flex items-center gap-2",children:"Chaves de API & Integrações"}),e.jsx("p",{className:"text-sm text-gray-400 mb-6 font-medium bg-red-500/10 p-2 rounded border border-red-500/20",children:"Cuidado: Estas chaves são sensíveis. Apenas altere se souber o que está fazendo."}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase mb-1",children:"Supabase URL"}),e.jsx("input",{type:"text",value:n.supabaseUrl,onChange:a=>b({...n,supabaseUrl:a.target.value}),className:"w-full bg-gray-900 border border-gray-700 rounded-md py-2 px-3 text-sm text-gray-300 font-mono",placeholder:"https://your-project.supabase.co"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase mb-1",children:"Supabase Anon Key"}),e.jsx("input",{type:"password",value:n.supabaseAnonKey,onChange:a=>b({...n,supabaseAnonKey:a.target.value}),className:"w-full bg-gray-900 border border-gray-700 rounded-md py-2 px-3 text-sm text-gray-300 font-mono",placeholder:"eyJhbGciOiJIUzI1..."})]}),e.jsxs("div",{className:"pt-4 border-t border-gray-700 mt-4",children:[e.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase mb-1",children:"Gemini AI API Key"}),e.jsx("input",{type:"password",value:n.geminiApiKey,onChange:a=>b({...n,geminiApiKey:a.target.value}),className:"w-full bg-gray-900 border border-gray-700 rounded-md py-2 px-3 text-sm text-gray-300 font-mono",placeholder:"AIzaSy..."}),e.jsx("p",{className:"text-[10px] text-gray-500 mt-1 italic",children:"Usada para Matchmaking e Análise de Sentimento."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-400 uppercase mb-1",children:"Stripe Publishable Key"}),e.jsx("input",{type:"text",value:n.stripePublishableKey,onChange:a=>b({...n,stripePublishableKey:a.target.value}),className:"w-full bg-gray-900 border border-gray-700 rounded-md py-2 px-3 text-sm text-gray-300 font-mono",placeholder:"pk_test_..."})]})]})]}),e.jsxs("div",{className:"bg-gray-800 p-6 rounded-xl border border-gray-700 shadow-lg",children:[e.jsx("div",{className:"flex justify-between items-center mb-4 border-b border-gray-700 pb-2",children:e.jsx("h2",{className:"text-xl font-bold text-white",children:"Equipe Administrativa"})}),N?e.jsx("p",{className:"text-gray-500 text-center py-4",children:"Carregando equipe..."}):j.length===0?e.jsx("p",{className:"text-gray-500 text-center py-4",children:"Nenhum membro da equipe encontrado."}):e.jsx("div",{className:"space-y-3",children:j.map(a=>e.jsxs("div",{className:"flex items-center justify-between bg-gray-900 p-3 rounded-lg border border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-700 flex items-center justify-center font-bold text-xs text-gray-400 overflow-hidden",children:a.foto_url?e.jsx("img",{src:U.storage.from("perfis").getPublicUrl(a.foto_url).data.publicUrl,alt:a.nome,className:"w-full h-full object-cover"}):a.nome.substring(0,2).toUpperCase()}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold text-white",children:a.nome}),e.jsx("p",{className:"text-xs text-gray-500",children:a.email})]})]}),e.jsx("span",{className:"text-xs px-2 py-1 rounded bg-gray-800 text-gray-300 border border-gray-600 capitalize",children:a.role})]},a.id))}),e.jsx("p",{className:"text-xs text-gray-500 mt-4 text-center",children:"Para adicionar novos administradores, altere o 'role' do usuário na página de Usuários ou diretamente no banco de dados."})]})]})]})]})};export{Q as default};
