import{b as n,j as e,e as g}from"./index-Cc-Lnn9x.js";import{r as t}from"./vendor-react-Dfcn4nkY.js";import{M as u}from"./MailIcon-BbooFhml.js";import{C as v}from"./CheckCircleIcon-DMttEdVL.js";import{T as y}from"./TrashIcon-Dw3P_7Ho.js";import{S as N}from"./SearchIcon-DH3o1suK.js";import"./vendor-jspdf-Bh_S0msn.js";import"./vendor-utils-DmyZJLyO.js";import"./vendor-ui-DKtFGipk.js";const R=()=>{const[c,l]=t.useState([]),[f,d]=t.useState(!0),[x,m]=t.useState(null),[i,b]=t.useState(""),h=t.useCallback(async()=>{d(!0),m(null);try{const{data:r,error:a}=await n.from("mensagens_contato").select("*").order("criado_em",{ascending:!1});if(a)throw a;l(r||[])}catch(r){m("Falha ao carregar as mensagens."),console.error(r)}finally{d(!1)}},[]);t.useEffect(()=>{h()},[h]);const w=async r=>{try{const{error:a}=await n.from("mensagens_contato").update({lida:!0}).eq("id",r);if(a)throw a;l(o=>o.map(s=>s.id===r?{...s,lida:!0}:s))}catch(a){alert("Erro ao marcar como lida: "+g(a))}},j=async r=>{if(window.confirm("Tem certeza que deseja excluir esta mensagem?"))try{const{error:a}=await n.from("mensagens_contato").delete().eq("id",r);if(a)throw a;l(o=>o.filter(s=>s.id!==r))}catch(a){alert("Erro ao excluir mensagem: "+g(a))}},p=c.filter(r=>r.nome.toLowerCase().includes(i.toLowerCase())||r.email.toLowerCase().includes(i.toLowerCase())||r.tipo.toLowerCase().includes(i.toLowerCase()));return e.jsxs("div",{className:"text-white animate-fade-in relative pb-20",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-end mb-12 gap-8",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-heading-hero mb-3 uppercase",children:["CENTRAL DE ",e.jsx("span",{className:"text-primary italic",children:"MENSAGENS"})]}),e.jsx("p",{className:"text-section-label text-gray-500",children:"Logs de Comunicação e Rastreamento de Origem"})]}),e.jsxs("div",{className:"flex items-center gap-4 bg-white/[0.03] p-4 rounded-2xl border border-white/5 backdrop-blur-xl",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-primary/10 flex items-center justify-center text-primary shadow-lg border border-primary/20",children:e.jsx(u,{className:"w-5 h-5"})}),e.jsxs("div",{className:"pr-4",children:[e.jsx("div",{className:"text-section-label text-gray-600",children:"Fluxo Total"}),e.jsxs("div",{className:"text-xl font-mono font-black text-white leading-none tracking-tighter",children:[c.length," MSGS"]})]})]})]}),x&&e.jsxs("div",{className:"glass-card mb-8 p-6 rounded-2xl border-red-500/20 bg-red-500/5 text-red-500 text-[10px] font-black uppercase tracking-[0.3em] text-center shadow-2xl animate-pulse",children:["Falha na Comunicação: ",x]}),e.jsx("div",{className:"glass-card p-6 rounded-3xl mb-10 border-white/5 shadow-2xl flex items-center gap-4 group",children:e.jsxs("div",{className:"relative flex-grow",children:[e.jsx("input",{type:"text",placeholder:"BUSCAR MENSAGENS (NOME, EMAIL, ASSUNTO)...",value:i,onChange:r=>b(r.target.value),className:"w-full bg-white/5 border border-white/10 rounded-xl py-4 pl-12 pr-6 focus:outline-none focus:ring-2 focus:ring-primary/50 text-white font-black uppercase tracking-widest text-[10px] transition-all placeholder:text-gray-600 focus:bg-white/10"}),e.jsx(N,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-500 group-hover:text-primary transition-colors"})]})}),e.jsx("div",{className:"glass-card rounded-3xl overflow-hidden shadow-2xl border-white/5",children:f?e.jsxs("div",{className:"p-20 text-center",children:[e.jsx("div",{className:"w-12 h-12 border-4 border-primary/20 border-t-primary rounded-full animate-spin mx-auto mb-6"}),e.jsx("p",{className:"text-[10px] font-black uppercase tracking-[0.4em] text-gray-600 animate-pulse",children:"Decodificando Mensagens..."})]}):p.length===0?e.jsx("div",{className:"p-20 text-center text-[10px] font-black uppercase tracking-[0.4em] text-gray-600",children:"Nenhuma mensagem detectada."}):e.jsx("div",{className:"divide-y divide-white/5",children:p.map(r=>e.jsxs("div",{className:`group p-6 transition-all duration-500 hover:bg-white/[0.02] relative overflow-hidden ${r.lida?"":"bg-primary/[0.03]"}`,children:[!r.lida&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute left-0 top-0 h-full w-1 border-l-4 border-primary shadow-[0_0_20px_rgba(var(--primary-rgb),0.5)]"}),e.jsx("div",{className:"absolute top-6 right-6 w-2 h-2 bg-primary rounded-full animate-pulse shadow-[0_0_15px_rgba(var(--primary-rgb),0.8)]"})]}),e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start gap-6 relative z-10",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-xl bg-white/5 flex items-center justify-center font-black text-lg text-gray-400 border border-white/5 group-hover:border-primary/30 transition-all uppercase",children:r.nome.charAt(0)}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-black text-white font-poppins tracking-tighter leading-none group-hover:text-primary transition-colors uppercase",children:r.nome}),e.jsxs("div",{className:"flex items-center gap-3 mt-1.5",children:[e.jsx("span",{className:"text-[10px] font-mono font-bold text-gray-500 uppercase tracking-widest",children:r.email}),e.jsx("span",{className:"w-1 h-1 rounded-full bg-gray-800"}),e.jsx("span",{className:"px-2.5 py-0.5 bg-white/5 text-gray-500 text-[8px] font-black rounded-full uppercase tracking-widest border border-white/5",children:r.tipo})]})]})]}),e.jsxs("div",{className:"mt-6 relative",children:[e.jsx("div",{className:"absolute -left-4 top-0 bottom-0 w-0.5 bg-white/5 group-hover:bg-primary/20 transition-all"}),e.jsx("p",{className:"text-lg text-gray-300 font-medium font-poppins tracking-tight italic leading-relaxed pl-4",children:r.mensagem})]})]}),e.jsxs("div",{className:"flex flex-col items-end shrink-0 gap-6",children:[e.jsx("span",{className:"text-[10px] font-mono font-black text-gray-600 uppercase tracking-tighter",children:new Date(r.criado_em).toLocaleString("pt-BR")}),e.jsxs("div",{className:"flex gap-4 opacity-40 group-hover:opacity-100 transition-opacity",children:[!r.lida&&e.jsx("button",{onClick:()=>w(r.id),className:"w-10 h-10 flex items-center justify-center bg-green-500/10 text-green-500 hover:bg-green-500 hover:text-white rounded-xl border border-green-500/20 transition-all active:scale-90 shadow-lg",title:"Marcar como lida",children:e.jsx(v,{className:"w-5 h-5"})}),e.jsx("a",{href:`mailto:${r.email}`,className:"w-10 h-10 flex items-center justify-center bg-primary/10 text-primary hover:bg-primary hover:text-white rounded-xl border border-primary/20 transition-all active:scale-90 shadow-lg",title:"Responder",children:e.jsx(u,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>j(r.id),className:"w-10 h-10 flex items-center justify-center bg-red-500/10 text-red-500 hover:bg-red-500 hover:text-white rounded-xl border border-red-500/20 transition-all active:scale-90 shadow-lg",title:"Excluir",children:e.jsx(y,{className:"w-5 h-5"})})]})]})]})]},r.id))})})]})};export{R as default};
