import{j as e,c as N}from"./index-B3LDTW8P.js";import{r as m,L as C}from"./vendor-react-Dfcn4nkY.js";import{P as k}from"./PlusIcon-iw0qjhSx.js";import{C as A}from"./CreateContractModal-BWQbXPVs.js";import{i as S,a as P}from"./ChevronLeftIcon-BN7Nb-uz.js";import{E as _}from"./ExclamationIcon-Bo2WpRJi.js";import{L}from"./LockClosedIcon-CJYgsydu.js";import{C as I}from"./CheckCircleIcon-B-pqGhzV.js";import{F as E}from"./FileSignatureIcon-Cs2S_2iG.js";import{X as F}from"./XCircleIcon-Dz6_c6AJ.js";import{C as $}from"./ClockIcon-BUCyT-bQ.js";import{E as B}from"./EmptyState-CO2Ugf_k.js";import{M}from"./MapPinIcon-jVJfwbgC.js";const R=()=>e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg animate-pulse",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("div",{className:"h-5 bg-gray-700 rounded w-48 mb-2"}),e.jsx("div",{className:"h-4 bg-gray-700 rounded w-32"})]}),e.jsx("div",{className:"h-5 bg-gray-700 rounded-full w-24"})]}),e.jsx("div",{className:"flex justify-end mt-2",children:e.jsx("div",{className:"h-5 bg-gray-700 rounded w-20"})})]}),z=({contract:s,profile:f})=>{const r=Array.isArray(s.artistas)?s.artistas[0]:s.artistas,l=Array.isArray(s.estabelecimentos)?s.estabelecimentos[0]:s.estabelecimentos,o=Array.isArray(r==null?void 0:r.usuarios)?r.usuarios[0]:r==null?void 0:r.usuarios,i=Array.isArray(l==null?void 0:l.usuarios)?l.usuarios[0]:l==null?void 0:l.usuarios,h=(o==null?void 0:o.nome)||"Artista não definido",w=(i==null?void 0:i.nome)||"Local não definido",x=(i==null?void 0:i.cidade)||"Localização não definida",a=f.tipo==="artista",u=s.status==="enviado"&&(a&&!s.assinatura_artista||!a&&!s.assinatura_estabelecimento),p=!a&&s.status==="assinado"&&!s.data_pagamento,d=u||p,y=new Date(s.data_evento),t=new Date,c=s.status==="concluido",j=y>t;let n=null,g="border-gray-700/50",b="bg-gray-800/40",v="";return c?j?(n=e.jsxs("span",{className:"text-[10px] uppercase font-bold text-blue-300 bg-blue-500/10 px-2 py-0.5 rounded border border-blue-500/20 flex items-center gap-1",children:[e.jsx(L,{className:"w-3 h-3"})," Em Custódia"]}),g="border-blue-500/30",b="bg-blue-900/10"):(n=e.jsxs("span",{className:"text-[10px] uppercase font-bold text-green-400 bg-green-500/10 px-2 py-0.5 rounded border border-green-500/20 flex items-center gap-1",children:[e.jsx(I,{className:"w-3 h-3"})," Liberado"]}),g="border-green-500/30",b="bg-green-900/10"):s.status==="cancelado"?(n=e.jsxs("span",{className:"text-[10px] uppercase font-bold text-red-400 bg-red-500/10 px-2 py-0.5 rounded border border-red-500/20 flex items-center gap-1",children:[e.jsx(F,{className:"w-3 h-3"})," Cancelado"]}),g="border-red-500/30",b="bg-red-900/10"):d&&(g="border-yellow-500/50",v="shadow-[0_0_15px_rgba(234,179,8,0.1)]",b="bg-yellow-900/10"),e.jsx(C,{to:`/contratos/${s.id}`,className:`block rounded-xl transition-all duration-300 overflow-hidden group border backdrop-blur-md hover:-translate-y-1 hover:shadow-xl ${b} ${g} ${v}`,children:e.jsxs("div",{className:"p-5 flex flex-col h-full",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"min-w-0 flex-1 pr-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${d?"bg-yellow-500 animate-pulse":c?"bg-green-500":"bg-gray-600"}`}),e.jsx("p",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-wider",children:a?"Contratante":"Artista"})]}),e.jsx("h3",{className:"font-bold text-white text-lg group-hover:text-primary transition-colors truncate font-poppins",children:a?w:h}),e.jsxs("div",{className:"flex items-center gap-1 mt-1 text-xs text-gray-400",children:[e.jsx(M,{className:"w-3 h-3"})," ",a?x:(o==null?void 0:o.cidade)||"Brasil"]})]}),e.jsx("div",{className:"text-right flex-shrink-0",children:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsxs("span",{className:"text-xs text-gray-500 font-mono mb-0.5",children:["#",s.id.substring(0,6)]}),e.jsxs("div",{className:"text-white font-mono font-bold text-lg tracking-tight bg-black/20 px-2 py-1 rounded border border-white/5",children:[e.jsx("span",{className:"text-xs text-gray-500 align-top mr-1",children:"R$"}),s.valor?s.valor.toLocaleString("pt-BR",{minimumFractionDigits:2}):"0,00"]})]})})]}),e.jsxs("div",{className:"mt-auto pt-4 border-t border-white/5 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-300 bg-black/20 px-2 py-1 rounded",children:[e.jsx($,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"font-medium",children:y.toLocaleDateString("pt-BR",{timeZone:"UTC",weekday:"short",day:"2-digit",month:"short"})})]}),e.jsx("div",{children:n})]}),d&&e.jsxs("div",{className:"mt-3 bg-yellow-500/10 rounded-lg px-3 py-2 flex items-center justify-center gap-2 text-xs font-bold text-yellow-300 border border-yellow-500/20",children:[e.jsx(_,{className:"w-4 h-4 flex-shrink-0"}),u?"Sua assinatura pendente":"Pagamento pendente"]})]})})},D=({profile:s})=>{const[f,r]=m.useState([]),[l,o]=m.useState(!0),[i,h]=m.useState(""),[w,x]=m.useState(!1),[a,u]=m.useState(""),p=s.tipo==="artista"?S(s).complete:P(s).complete,d=m.useCallback(async()=>{var c,j;const t=s.tipo==="artista"?(c=s.artista)==null?void 0:c.id:(j=s.estabelecimento)==null?void 0:j.id;if(!s||!t){o(!1),r([]);return}o(!0),h("");try{const n=await N.listByProfile(t,s.tipo,a||void 0);r(n)}catch(n){h("Falha ao buscar contratos."),console.error(n.message)}finally{o(!1)}},[s,a]);m.useEffect(()=>{d()},[d]);const y=[{value:"",label:"Todos"},{value:"enviado",label:"Pendentes"},{value:"assinado",label:"Aguard. Pagamento"},{value:"concluido",label:"Confirmados"},{value:"cancelado",label:"Cancelados"}];return e.jsxs("div",{className:"animate-fade-in",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-6 mb-8",children:[e.jsx("div",{className:"w-full md:w-auto overflow-x-auto pb-2 md:pb-0 scrollbar-hide",children:e.jsx("div",{className:"flex items-center gap-2 p-1",children:y.map(t=>e.jsx("button",{onClick:()=>u(t.value),className:`px-5 py-2.5 rounded-full text-sm font-bold whitespace-nowrap transition-all duration-300 border ${a===t.value?"bg-gradient-to-r from-primary to-blue-500 text-dark border-transparent shadow-[0_0_15px_rgba(81,210,238,0.4)] transform scale-105":"bg-gray-800 text-gray-400 border-gray-700 hover:border-gray-500 hover:text-white hover:bg-gray-750"}`,children:t.label},t.value))})}),e.jsxs("button",{onClick:()=>x(!0),disabled:!p,title:p?"Novo Contrato":"Complete seu perfil para criar contratos",className:`w-full md:w-auto flex items-center justify-center gap-2 font-bold py-3 px-6 rounded-full transition-all duration-300 transform shadow-xl ${p?"bg-white text-dark hover:scale-105 hover:shadow-[0_0_20px_rgba(255,255,255,0.3)]":"bg-gray-700 text-gray-500 cursor-not-allowed opacity-50"}`,children:[e.jsx(k,{className:"w-5 h-5"}),"Novo Contrato"]})]}),!p&&e.jsx("div",{className:"mb-8 bg-yellow-500/10 border border-yellow-500/50 rounded-lg p-4 backdrop-blur-sm animate-fade-in",children:e.jsxs("p",{className:"text-yellow-200 text-sm text-center flex items-center justify-center gap-2 font-medium",children:[e.jsx("span",{className:"w-2 h-2 bg-yellow-500 rounded-full animate-pulse"}),'Seu perfil está incompleto. Você precisa preencher todos os dados obrigatórios na aba "Perfil" para poder criar e assinar contratos.']})}),l?e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-2 xl:grid-cols-3",children:Array.from({length:6}).map((t,c)=>e.jsx(R,{},c))}):i?e.jsx("p",{className:"text-center text-red-400 bg-red-500/10 p-6 rounded-xl border border-red-500/20",children:i}):f.length===0?e.jsx(B,{icon:E,title:a?"Nenhum contrato nesta categoria":"Sua agenda está vazia",description:a?"Tente mudar o filtro para ver outros contratos.":"Você ainda não possui contratos. Inicie uma nova proposta para formalizar seus shows e garantir seu pagamento.",actionLabel:a?"Limpar Filtros":"Criar Primeiro Contrato",onAction:a?()=>u(""):()=>x(!0)}):e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-2 xl:grid-cols-3",children:f.map(t=>e.jsx(z,{contract:t,profile:s},t.id))}),w&&e.jsx(A,{currentUserProfile:s,onClose:()=>x(!1),onContractCreated:()=>{x(!1),u(""),d()}})]})};export{D as C};
