import{j as e,b as y,e as I}from"./index-Cc-Lnn9x.js";import{r as g}from"./vendor-react-Dfcn4nkY.js";import{U as L}from"./UsersIcon-DGnNkzTA.js";import{F as $}from"./FileSignatureIcon-CkuZe52x.js";import{C as O}from"./CheckCircleIcon-DMttEdVL.js";import{C as P}from"./CreditCardIcon-OXjEnC_f.js";import{M as T}from"./MapPinIcon-CPSUTHrZ.js";import"./vendor-jspdf-Bh_S0msn.js";import"./vendor-utils-DmyZJLyO.js";import"./vendor-ui-DKtFGipk.js";const z=({data:t,color:x="#51D2EE",height:b=200})=>{var m,c,d;if(!t||t.length===0)return e.jsx("div",{className:"h-full flex items-center justify-center text-gray-600 text-xs",children:"Sem dados suficientes"});const h=Math.max(...t.map(i=>i.value))||1,o=t.map((i,l)=>{const r=l/(t.length-1)*100,a=100-i.value/h*100;return`${r},${a}`}).join(" "),p=`0,100 ${o} 100,100`;return e.jsxs("div",{className:"w-full h-full relative group",children:[e.jsxs("svg",{viewBox:"0 0 100 100",preserveAspectRatio:"none",className:"w-full h-full overflow-visible",children:[e.jsx("line",{x1:"0",y1:"0",x2:"100",y2:"0",stroke:"#374151",strokeWidth:"0.5",strokeDasharray:"2"}),e.jsx("line",{x1:"0",y1:"50",x2:"100",y2:"50",stroke:"#374151",strokeWidth:"0.5",strokeDasharray:"2"}),e.jsx("line",{x1:"0",y1:"100",x2:"100",y2:"100",stroke:"#374151",strokeWidth:"0.5"}),e.jsx("polygon",{points:p,fill:x,fillOpacity:"0.1"}),e.jsx("polyline",{points:o,fill:"none",stroke:x,strokeWidth:"2",vectorEffect:"non-scaling-stroke"}),t.map((i,l)=>{const r=l/(t.length-1)*100,a=100-i.value/h*100;return e.jsx("circle",{cx:r,cy:a,r:"3",fill:x,className:"opacity-0 group-hover:opacity-100 transition-opacity duration-200",vectorEffect:"non-scaling-stroke",children:e.jsx("title",{children:`${i.fullDate}: ${i.value}`})},l)})]}),e.jsxs("div",{className:"flex justify-between mt-2 text-[10px] text-gray-500 font-mono",children:[e.jsx("span",{children:(m=t[0])==null?void 0:m.label}),e.jsx("span",{children:(c=t[Math.floor(t.length/2)])==null?void 0:c.label}),e.jsx("span",{children:(d=t[t.length-1])==null?void 0:d.label})]})]})},F=({data:t,color:x="#7942D8",height:b=200})=>{var c,d,i;if(!t||t.length===0)return e.jsx("div",{className:"h-full flex items-center justify-center text-gray-600 text-xs",children:"Sem dados suficientes"});const h=Math.max(...t.map(l=>l.value))||1,o=100/t.length,p=.2*o,m=o-p;return e.jsxs("div",{className:"w-full h-full relative",children:[e.jsxs("svg",{viewBox:"0 0 100 100",preserveAspectRatio:"none",className:"w-full h-full overflow-visible",children:[e.jsx("line",{x1:"0",y1:"0",x2:"100",y2:"0",stroke:"#374151",strokeWidth:"0.5",strokeDasharray:"2"}),e.jsx("line",{x1:"0",y1:"50",x2:"100",y2:"50",stroke:"#374151",strokeWidth:"0.5",strokeDasharray:"2"}),e.jsx("line",{x1:"0",y1:"100",x2:"100",y2:"100",stroke:"#374151",strokeWidth:"0.5"}),t.map((l,r)=>{const a=l.value/h*100,n=r*o+p/2,j=100-a;return e.jsx("rect",{x:n,y:j,width:m,height:a,fill:x,className:"hover:opacity-80 transition-opacity",children:e.jsx("title",{children:`${l.fullDate}: ${l.value} usuários`})},r)})]}),e.jsxs("div",{className:"flex justify-between mt-2 text-[10px] text-gray-500 font-mono",children:[e.jsx("span",{children:(c=t[0])==null?void 0:c.label}),e.jsx("span",{children:(d=t[Math.floor(t.length/2)])==null?void 0:d.label}),e.jsx("span",{children:(i=t[t.length-1])==null?void 0:i.label})]})]})},se=()=>{const[t,x]=g.useState({userCount:0,artistsCount:0,venuesCount:0,activeContractsCount:0,newUsers24h:0,grossVolume:0}),[b,h]=g.useState([]),[o,p]=g.useState({usersGrowth:[],revenueGrowth:[]}),[m,c]=g.useState(!0),[d,i]=g.useState(null),l=()=>{const r=[];for(let a=29;a>=0;a--){const n=new Date;n.setDate(n.getDate()-a),n.setHours(0,0,0,0),r.push(n)}return r};return g.useEffect(()=>{(async()=>{c(!0);try{const{data:a,error:n}=await y.from("usuarios").select("id, tipo, criado_em");if(n)throw n;const j=a.length,E=a.filter(s=>s.tipo==="artista").length,A=a.filter(s=>s.tipo==="estabelecimento").length,R=new Date,V=new Date(R.getTime()-1440*60*1e3),M=a.filter(s=>new Date(s.criado_em)>V).length,k=l(),W=k.map(s=>{const u=s.toISOString().split("T")[0],w=s.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"}),N=a.filter(f=>f.criado_em.startsWith(u)).length;return{label:w,value:N,fullDate:s.toLocaleDateString("pt-BR")}}),{data:v,error:D}=await y.from("contratos").select("id, status, valor, taxa_servico, criado_em, data_pagamento");if(D)throw D;const _=v.filter(s=>["assinado","concluido"].includes(s.status)).length,B=v.reduce((s,u)=>s+(u.valor||0)+(u.taxa_servico||0),0),G=k.map(s=>{const u=s.toISOString().split("T")[0],w=s.toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit"}),N=v.filter(f=>f.criado_em.startsWith(u)).reduce((f,S)=>f+(S.valor||0)+(S.taxa_servico||0),0);return{label:w,value:N,fullDate:s.toLocaleDateString("pt-BR")}});x({userCount:j,artistsCount:E,venuesCount:A,activeContractsCount:_,newUsers24h:M,grossVolume:B}),p({usersGrowth:W,revenueGrowth:G});const{data:U,error:C}=await y.from("usuarios").select("*, artista:artistas(*), estabelecimento:estabelecimentos(*)").order("criado_em",{ascending:!1}).limit(5);if(C)throw C;h((U||[]).map(s=>({...s,artista:Array.isArray(s.artista)?s.artista[0]:s.artista,estabelecimento:Array.isArray(s.estabelecimento)?s.estabelecimento[0]:s.estabelecimento})))}catch(a){console.error("Error fetching admin dashboard data:",a),i(I(a))}finally{c(!1)}})()},[]),m?e.jsx("div",{className:"text-white text-center p-8",children:"Carregando dashboard..."}):d?e.jsxs("div",{className:"text-red-400 text-center p-8",children:["Erro: ",d]}):e.jsxs("div",{className:"text-white animate-fade-in pb-16",children:[e.jsxs("div",{className:"flex flex-col mb-12",children:[e.jsxs("h1",{className:"text-heading-hero mb-3 uppercase",children:["CENTRO DE ",e.jsx("span",{className:"text-primary italic",children:"COMANDO"})]}),e.jsx("p",{className:"text-section-label text-gray-500",children:"Visão Geral do Negócio e Sinais Vitais do Ecossistema"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 mb-12",children:[e.jsxs("div",{className:"glass-card p-6 rounded-3xl border-white/5 relative overflow-hidden group hover:p-7 transition-all",children:[e.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 bg-blue-500/10 rounded-full blur-[40px] pointer-events-none group-hover:bg-blue-500/20 transition-colors"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("p",{className:"text-[10px] font-black uppercase tracking-[0.3em] text-gray-500",children:"Total Usuários"}),e.jsx("div",{className:"w-12 h-12 bg-blue-500/10 rounded-2xl flex items-center justify-center border border-blue-500/20 group-hover:scale-110 transition-transform",children:e.jsx(L,{className:"w-6 h-6 text-blue-400"})})]}),e.jsx("h3",{className:"text-5xl font-black text-white font-poppins tracking-tighter leading-none mb-4",children:t.userCount}),e.jsxs("div",{className:"flex gap-4 text-[9px] font-black uppercase tracking-widest text-gray-400 border-t border-white/5 pt-4",children:[e.jsxs("span",{children:["Artistas: ",e.jsx("strong",{className:"text-white",children:t.artistsCount})]}),e.jsxs("span",{children:["Locais: ",e.jsx("strong",{className:"text-white",children:t.venuesCount})]})]})]})]}),e.jsxs("div",{className:"glass-card p-6 rounded-3xl border-white/5 relative overflow-hidden group hover:p-7 transition-all",children:[e.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 bg-green-500/10 rounded-full blur-[40px] pointer-events-none group-hover:bg-green-500/20 transition-colors"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("p",{className:"text-[10px] font-black uppercase tracking-[0.3em] text-gray-500",children:"Novos (24h)"}),e.jsx("div",{className:"w-12 h-12 bg-green-500/10 rounded-2xl flex items-center justify-center border border-green-500/20 group-hover:scale-110 transition-transform",children:e.jsx(O,{className:"w-6 h-6 text-green-400"})})]}),e.jsxs("h3",{className:"text-5xl font-black text-green-400 font-poppins tracking-tighter leading-none mb-4",children:["+",t.newUsers24h]}),e.jsx("p",{className:"text-[9px] font-black uppercase tracking-widest text-gray-400 border-t border-white/5 pt-4",children:"Pico de Crescimento Diário"})]})]}),e.jsxs("div",{className:"glass-card p-6 rounded-3xl border-white/5 relative overflow-hidden group hover:p-7 transition-all",children:[e.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 bg-primary/10 rounded-full blur-[40px] pointer-events-none group-hover:bg-primary/20 transition-colors"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("p",{className:"text-[10px] font-black uppercase tracking-[0.3em] text-gray-500",children:"Contratos Ativos"}),e.jsx("div",{className:"w-12 h-12 bg-primary/10 rounded-2xl flex items-center justify-center border border-primary/20 group-hover:scale-110 transition-transform",children:e.jsx($,{className:"w-6 h-6 text-primary"})})]}),e.jsx("h3",{className:"text-5xl font-black text-white font-poppins tracking-tighter leading-none mb-4",children:t.activeContractsCount}),e.jsx("p",{className:"text-[9px] font-black uppercase tracking-widest text-gray-400 border-t border-white/5 pt-4",children:"Ativos e Concluídos"})]})]}),e.jsxs("div",{className:"glass-card p-6 rounded-3xl border-white/5 relative overflow-hidden group hover:p-7 transition-all",children:[e.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 bg-yellow-500/10 rounded-full blur-[40px] pointer-events-none group-hover:bg-yellow-500/20 transition-colors"}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("p",{className:"text-[10px] font-black uppercase tracking-[0.3em] text-gray-500",children:"Volume Total"}),e.jsx("div",{className:"w-12 h-12 bg-yellow-500/10 rounded-2xl flex items-center justify-center border border-yellow-500/20 group-hover:scale-110 transition-transform",children:e.jsx(P,{className:"w-6 h-6 text-yellow-500"})})]}),e.jsxs("h3",{className:"text-4xl font-black text-yellow-500 font-mono tracking-tighter leading-none mb-4",children:["R$ ",t.grossVolume.toLocaleString("pt-BR",{notation:"compact"})]}),e.jsx("p",{className:"text-[9px] font-black uppercase tracking-widest text-gray-400 border-t border-white/5 pt-4",children:"GMV do Ecossistema"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-12",children:[e.jsxs("div",{className:"glass-card p-8 rounded-3xl border-white/5 relative overflow-hidden group",children:[e.jsxs("div",{className:"mb-10",children:[e.jsx("h3",{className:"text-section-label text-gray-500 mb-2",children:"Pulso Social"}),e.jsx("p",{className:"text-xl font-black font-poppins text-white tracking-tighter uppercase",children:"Crescimento da Comunidade"})]}),e.jsx("div",{className:"h-64 w-full",children:e.jsx(F,{data:o.usersGrowth,color:"#7942D8"})})]}),e.jsxs("div",{className:"glass-card p-8 rounded-3xl border-white/5 relative overflow-hidden group",children:[e.jsxs("div",{className:"mb-10",children:[e.jsx("h3",{className:"text-section-label text-gray-500 mb-2",children:"Motor Financeiro"}),e.jsx("p",{className:"text-xl font-black font-poppins text-white tracking-tighter uppercase",children:"Volume de Contratos (GMV)"})]}),e.jsx("div",{className:"h-64 w-full",children:e.jsx(z,{data:o.revenueGrowth,color:"#51D2EE"})})]})]}),e.jsxs("div",{className:"glass-card rounded-3xl border-white/5 overflow-hidden",children:[e.jsxs("div",{className:"p-8 border-b border-white/5 bg-white/[0.02]",children:[e.jsx("h3",{className:"text-section-label text-gray-500",children:"Últimas Integrações"}),e.jsx("p",{className:"text-xl font-black font-poppins text-white tracking-tighter mt-1 uppercase",children:"Usuários Recentes no Ecossistema"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{className:"bg-white/5 text-section-label text-gray-400",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-6 pl-10",children:"Identidade do Usuário"}),e.jsx("th",{className:"p-6",children:"Classificação"}),e.jsx("th",{className:"p-6 text-center",children:"Contato Digital"}),e.jsx("th",{className:"p-6 text-center",children:"Geolocalização"}),e.jsx("th",{className:"p-6 text-right pr-10",children:"Selo de Entrada"})]})}),e.jsx("tbody",{className:"divide-y divide-white/[0.02] text-sm",children:b.map(r=>e.jsxs("tr",{className:"hover:bg-white/[0.02] transition-colors group",children:[e.jsx("td",{className:"p-6 pl-10",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-white/5 border border-white/10 flex items-center justify-center font-black text-xs text-primary group-hover:bg-primary group-hover:text-dark transition-all",children:r.nome.charAt(0)}),e.jsx("span",{className:"font-black text-white font-poppins tracking-tight uppercase",children:r.nome})]})}),e.jsx("td",{className:"p-6",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-[9px] font-black uppercase tracking-widest ${r.tipo==="artista"?"bg-blue-500/10 text-blue-400 border border-blue-500/20":"bg-purple-500/10 text-purple-400 border border-purple-500/20"}`,children:r.tipo})}),e.jsx("td",{className:"p-6 text-center",children:e.jsx("span",{className:"text-gray-400 font-mono text-xs",children:r.email})}),e.jsx("td",{className:"p-6 text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-2 text-gray-400 text-[11px] font-black uppercase tracking-[0.2em]",children:[e.jsx(T,{className:"w-3.5 h-3.5 text-primary opacity-50"}),r.cidade||"N/A"]})}),e.jsx("td",{className:"p-6 text-right pr-10 text-gray-500 text-[10px] font-black font-mono",children:new Date(r.criado_em).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"})})]},r.id))})]})})]})]})};export{se as default};
