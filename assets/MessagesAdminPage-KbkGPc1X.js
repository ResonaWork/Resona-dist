import{b as i,j as e,e as p}from"./index-DlAvHY7j.js";import{r as s}from"./vendor-react-Dfcn4nkY.js";import{M as j}from"./MailIcon-CRpmBQGJ.js";import{C as w}from"./CheckCircleIcon-ChAVo4Go.js";import{T as N}from"./TrashIcon-DYCb4kG1.js";import{S as v}from"./SearchIcon-BYpUjHCe.js";import"./vendor-jspdf-Bh_S0msn.js";import"./vendor-utils-DmyZJLyO.js";import"./vendor-ui-DKtFGipk.js";const q=()=>{const[g,n]=s.useState([]),[u,c]=s.useState(!0),[d,m]=s.useState(null),[o,f]=s.useState(""),x=s.useCallback(async()=>{c(!0),m(null);try{const{data:r,error:a}=await i.from("mensagens_contato").select("*").order("criado_em",{ascending:!1});if(a)throw a;n(r||[])}catch(r){m("Falha ao carregar as mensagens."),console.error(r)}finally{c(!1)}},[]);s.useEffect(()=>{x()},[x]);const y=async r=>{try{const{error:a}=await i.from("mensagens_contato").update({lida:!0}).eq("id",r);if(a)throw a;n(l=>l.map(t=>t.id===r?{...t,lida:!0}:t))}catch(a){alert("Erro ao marcar como lida: "+p(a))}},b=async r=>{if(window.confirm("Tem certeza que deseja excluir esta mensagem?"))try{const{error:a}=await i.from("mensagens_contato").delete().eq("id",r);if(a)throw a;n(l=>l.filter(t=>t.id!==r))}catch(a){alert("Erro ao excluir mensagem: "+p(a))}},h=g.filter(r=>r.nome.toLowerCase().includes(o.toLowerCase())||r.email.toLowerCase().includes(o.toLowerCase())||r.tipo.toLowerCase().includes(o.toLowerCase()));return e.jsxs("div",{className:"text-white animate-fade-in",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2 text-primary font-poppins",children:"Mensagens de Contato"}),e.jsx("p",{className:"text-gray-400 mb-8",children:"Mensagens enviadas através do formulário de contato do site."}),d&&e.jsx("div",{className:"p-3 rounded-md mb-6 text-center text-sm bg-red-500/20 text-red-400",children:d}),e.jsx("div",{className:"bg-gray-800 p-4 rounded-lg mb-6 border border-gray-700 flex items-center gap-4",children:e.jsxs("div",{className:"relative flex-grow",children:[e.jsx("input",{type:"text",placeholder:"Buscar por nome, email ou assunto...",value:o,onChange:r=>f(r.target.value),className:"w-full bg-gray-900 border border-gray-600 rounded-md py-2 pl-10 pr-4 focus:outline-none focus:ring-2 focus:ring-secondary text-white"}),e.jsx(v,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"})]})}),e.jsx("div",{className:"bg-gray-800 rounded-xl overflow-hidden shadow-lg border border-gray-700",children:u?e.jsx("div",{className:"text-center p-8 text-gray-500",children:"Carregando mensagens..."}):h.length===0?e.jsx("div",{className:"text-center p-8 text-gray-500",children:"Nenhuma mensagem encontrada."}):e.jsx("div",{className:"divide-y divide-gray-700",children:h.map(r=>e.jsxs("div",{className:`p-4 hover:bg-gray-700/30 transition-colors ${r.lida?"border-l-4 border-transparent":"bg-secondary/5 border-l-4 border-secondary"}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-bold text-white flex items-center gap-2",children:[r.nome,e.jsxs("span",{className:"text-xs font-normal text-gray-400",children:["<",r.email,">"]})]}),e.jsx("span",{className:"text-xs bg-gray-700 px-2 py-0.5 rounded text-gray-300 mt-1 inline-block",children:r.tipo})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-gray-500 mr-2",children:new Date(r.criado_em).toLocaleString()}),!r.lida&&e.jsx("button",{onClick:()=>y(r.id),className:"p-1.5 text-green-400 hover:bg-green-500/20 rounded",title:"Marcar como lida",children:e.jsx(w,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>b(r.id),className:"p-1.5 text-red-400 hover:bg-red-500/20 rounded",title:"Excluir",children:e.jsx(N,{className:"w-5 h-5"})})]})]}),e.jsx("p",{className:"text-gray-300 text-sm whitespace-pre-wrap mt-2 pl-2 border-l-2 border-gray-700",children:r.mensagem}),e.jsx("div",{className:"mt-3 flex justify-end",children:e.jsxs("a",{href:`mailto:${r.email}`,className:"text-xs text-primary hover:underline flex items-center gap-1",children:[e.jsx(j,{className:"w-3 h-3"})," Responder por Email"]})})]},r.id))})})]})};export{q as default};
