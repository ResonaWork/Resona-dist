import{j as e,d as mt,s as Z,C as Pe,e as O,u as Mt,a as K,f as zt,g as Ie,m as $e,b as ve,n as It,c as xt,p as Xe,h as $t,B as Je,i as Ft,k as Fe,l as Ye}from"./index-B3LDTW8P.js";import{R as Tt,L as re,g as Lt,r as c,u as He,c as ht,h as Bt}from"./vendor-react-Dfcn4nkY.js";import{U as de}from"./UserCircleIcon-CZiOhhVw.js";import{F as pt}from"./FileSignatureIcon-Cs2S_2iG.js";import{M as ue}from"./MessagesIcon-By5icoLF.js";import{H as ut}from"./HomeIcon-C2jieivf.js";import{C as we}from"./CalendarIcon-C4XWClfW.js";import{T as Ne}from"./TrendingUpIcon-DeMqO18y.js";import{C as Se}from"./CreditCardIcon-9gMzdsrI.js";import{E as Ot}from"./EyeIcon-BOeXQoQz.js";import{U as ce}from"./UploadIcon--okvfToU.js";import{C as le,R as gt}from"./ReviewList-ClyPr58T.js";import{_ as qt,a as Y}from"./vendor-utils-DmyZJLyO.js";import{P as Ce}from"./PhotographIcon-CbjgoHuu.js";import{E as je}from"./ExclamationIcon-Bo2WpRJi.js";import{M as Me}from"./MapPinIcon-jVJfwbgC.js";import{i as he,C as Ut,a as Vt}from"./ChevronLeftIcon-BN7Nb-uz.js";import{F as Ee}from"./FileIcon-GFa3WrPW.js";import{T as ge}from"./TrashIcon-DZaGTioq.js";import{M as Te}from"./MusicNoteIcon-Crh1STvI.js";import{S as ne}from"./SparklesIcon-l-DXXC5B.js";import{E as Ae}from"./EmptyState-CO2Ugf_k.js";import{C as oe}from"./CheckCircleIcon-B-pqGhzV.js";import{C as fe}from"./ClockIcon-BUCyT-bQ.js";import{P as ft}from"./PlusIcon-iw0qjhSx.js";import{C as Wt}from"./ConfirmationModal-B5EtYYGl.js";import{U as bt}from"./UsersIcon-D_nQN3_H.js";import{S as Ze}from"./ShieldIcon-C-6X9YWF.js";import{X as Ht}from"./XCircleIcon-Dz6_c6AJ.js";import{L as We}from"./LockClosedIcon-CJYgsydu.js";import{S as ie}from"./StarIcon-BUPEoD4K.js";import{S as Zt}from"./SearchIcon-DsGgk2Dm.js";import{A as Gt}from"./ArrowLeftIcon-Ds-_Azb2.js";import{C as vt}from"./ContractsList-CC1fyc9S.js";import{C as Re}from"./ChevronRightIcon-Cd5T9x7e.js";import{D as Xt}from"./DownloadIcon-CbxOWAKK.js";import{i as pe,c as yt,g as Jt,a as Yt,b as Kt}from"./financeUtils-CtoX7Xu7.js";import{T as Qt}from"./TrophyIcon-Cl3uZTsQ.js";import{S as ea}from"./SEO-VERqfMsS.js";import"./vendor-jspdf-Bh_S0msn.js";import"./vendor-ui-DKtFGipk.js";import"./CreateContractModal-BWQbXPVs.js";const jt=({title:s,subtitle:r,tabs:t,activeTab:a,onTabClick:o,children:i,profile:n})=>{var f,m;const[l,d]=Tt.useState(!1),h=({id:u,label:S,icon:b})=>e.jsxs("button",{onClick:()=>o(u),className:`snap-start flex items-center gap-2 px-4 py-3 text-sm font-semibold rounded-md transition-colors whitespace-nowrap outline-none focus:ring-2 focus:ring-primary focus:ring-opacity-50 ${a===u?"bg-secondary text-white":"text-gray-300 hover:bg-gray-700"}`,children:[b,S]});return e.jsxs(e.Fragment,{children:[e.jsx("section",{className:"bg-gray-900 py-8 md:py-12",children:e.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl md:text-4xl font-bold text-white font-poppins",children:s}),e.jsx("p",{className:"mt-2 text-base md:text-lg text-gray-400",children:r})]}),e.jsx("div",{className:"flex-shrink-0",children:e.jsxs(re,{to:`/${n.tipo}/${n.id}`,className:"flex items-center gap-2 bg-gray-700 hover:bg-gray-600 text-white font-semibold py-3 px-4 rounded-md transition-colors justify-center w-full sm:w-auto",children:[e.jsx(Ot,{className:"w-5 h-5"}),"Ver Perfil Público"]})})]})})}),e.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-6 md:py-12 min-w-0",children:[e.jsxs("div",{className:`lg:hidden mb-6 w-full relative ${l?"z-50":"z-20"}`,children:[e.jsxs("button",{onClick:()=>d(!l),className:"w-full flex items-center justify-between bg-gray-800 border border-gray-700 text-white rounded-lg py-3 px-4 shadow-sm hover:border-gray-500 transition-colors",children:[e.jsxs("span",{className:"flex items-center gap-3 font-medium",children:[(f=t.find(u=>u.id===a))==null?void 0:f.icon,(m=t.find(u=>u.id===a))==null?void 0:m.label]}),e.jsx("svg",{className:`h-5 w-5 text-gray-400 transition-transform ${l?"rotate-180":""}`,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),l&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>d(!1)}),e.jsx("div",{className:"absolute top-full left-0 right-0 mt-2 bg-gray-800 border border-gray-700 rounded-lg shadow-xl z-50 max-h-80 overflow-y-auto animate-fade-in",children:t.map(u=>e.jsxs("button",{onClick:()=>{o(u.id),d(!1)},className:`w-full text-left px-4 py-3 flex items-center gap-3 hover:bg-gray-700 transition-colors border-b border-gray-700/50 last:border-0 ${a===u.id?"text-primary bg-gray-700/30 font-bold":"text-gray-300"}`,children:[u.icon,u.label]},u.id))})]})]}),e.jsx("div",{className:"hidden lg:block relative mb-6",children:e.jsx("div",{className:"flex items-center gap-2 border-b border-gray-700 pb-2 overflow-x-auto whitespace-nowrap scrollbar-hide snap-x snap-mandatory px-0",children:t.map(u=>e.jsx(h,{...u},u.id))})}),e.jsx("div",{className:"bg-gray-800 p-4 sm:p-6 md:p-8 rounded-lg shadow-lg overflow-hidden min-w-0",children:i})]}),e.jsx("style",{children:".input-style { display: block; width: 100%; background-color: #1f2937; border: 1px solid #4b5563; border-radius: 0.375rem; padding: 0.75rem; font-size: 1rem; color: white; transition: border-color 0.2s, box-shadow 0.2s; } .input-style:focus { outline: none; border-color: #51D2EE; box-shadow: 0 0 0 2px rgba(81, 210, 238, 0.5); }"})]})};var Le,Ke;function ta(){if(Ke)return Le;Ke=1;var s=!1,r,t,a,o,i,n,l,d,h,f,m,u,S,b,w;function D(){if(!s){s=!0;var E=navigator.userAgent,y=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(E),j=/(Mac OS X)|(Windows)|(Linux)/.exec(E);if(u=/\b(iPhone|iP[ao]d)/.exec(E),S=/\b(iP[ao]d)/.exec(E),f=/Android/i.exec(E),b=/FBAN\/\w+;/i.exec(E),w=/Mobile/i.exec(E),m=!!/Win64/.exec(E),y){r=y[1]?parseFloat(y[1]):y[5]?parseFloat(y[5]):NaN,r&&document&&document.documentMode&&(r=document.documentMode);var R=/(?:Trident\/(\d+.\d+))/.exec(E);n=R?parseFloat(R[1])+4:r,t=y[2]?parseFloat(y[2]):NaN,a=y[3]?parseFloat(y[3]):NaN,o=y[4]?parseFloat(y[4]):NaN,o?(y=/(?:Chrome\/(\d+\.\d+))/.exec(E),i=y&&y[1]?parseFloat(y[1]):NaN):i=NaN}else r=t=a=i=o=NaN;if(j){if(j[1]){var P=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(E);l=P?parseFloat(P[1].replace("_",".")):!0}else l=!1;d=!!j[2],h=!!j[3]}else l=d=h=!1}}var M={ie:function(){return D()||r},ieCompatibilityMode:function(){return D()||n>r},ie64:function(){return M.ie()&&m},firefox:function(){return D()||t},opera:function(){return D()||a},webkit:function(){return D()||o},safari:function(){return M.webkit()},chrome:function(){return D()||i},windows:function(){return D()||d},osx:function(){return D()||l},linux:function(){return D()||h},iphone:function(){return D()||u},mobile:function(){return D()||u||S||f||w},nativeApp:function(){return D()||b},android:function(){return D()||f},ipad:function(){return D()||S}};return Le=M,Le}var Be,Qe;function aa(){if(Qe)return Be;Qe=1;var s=!!(typeof window<"u"&&window.document&&window.document.createElement),r={canUseDOM:s,canUseWorkers:typeof Worker<"u",canUseEventListeners:s&&!!(window.addEventListener||window.attachEvent),canUseViewport:s&&!!window.screen,isInWorker:!s};return Be=r,Be}var Oe,et;function sa(){if(et)return Oe;et=1;var s=aa(),r;s.canUseDOM&&(r=document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0);/**
 * Checks if an event is supported in the current execution environment.
 *
 * NOTE: This will not work correctly for non-generic events such as `change`,
 * `reset`, `load`, `error`, and `select`.
 *
 * Borrows from Modernizr.
 *
 * @param {string} eventNameSuffix Event name, e.g. "click".
 * @param {?boolean} capture Check if the capture phase is supported.
 * @return {boolean} True if the event is supported.
 * @internal
 * @license Modernizr 3.0.0pre (Custom Build) | MIT
 */function t(a,o){if(!s.canUseDOM||o&&!("addEventListener"in document))return!1;var i="on"+a,n=i in document;if(!n){var l=document.createElement("div");l.setAttribute(i,"return;"),n=typeof l[i]=="function"}return!n&&r&&a==="wheel"&&(n=document.implementation.hasFeature("Events.wheel","3.0")),n}return Oe=t,Oe}var qe,tt;function ra(){if(tt)return qe;tt=1;var s=ta(),r=sa(),t=10,a=40,o=800;function i(n){var l=0,d=0,h=0,f=0;return"detail"in n&&(d=n.detail),"wheelDelta"in n&&(d=-n.wheelDelta/120),"wheelDeltaY"in n&&(d=-n.wheelDeltaY/120),"wheelDeltaX"in n&&(l=-n.wheelDeltaX/120),"axis"in n&&n.axis===n.HORIZONTAL_AXIS&&(l=d,d=0),h=l*t,f=d*t,"deltaY"in n&&(f=n.deltaY),"deltaX"in n&&(h=n.deltaX),(h||f)&&n.deltaMode&&(n.deltaMode==1?(h*=a,f*=a):(h*=o,f*=o)),h&&!l&&(l=h<1?-1:1),f&&!d&&(d=f<1?-1:1),{spinX:l,spinY:d,pixelX:h,pixelY:f}}return i.getEventType=function(){return s.firefox()?"DOMMouseScroll":r("wheel")?"wheel":"mousewheel"},qe=i,qe}var Ue,at;function oa(){return at||(at=1,Ue=ra()),Ue}var ia=oa();const na=Lt(ia);function la(s,r,t,a,o,i){i===void 0&&(i=0);var n=be(s,r,i),l=n.width,d=n.height,h=Math.min(l,t),f=Math.min(d,a);return h>f*o?{width:f*o,height:f}:{width:h,height:h/o}}function ca(s){return s.width>s.height?s.width/s.naturalWidth:s.height/s.naturalHeight}function ye(s,r,t,a,o){o===void 0&&(o=0);var i=be(r.width,r.height,o),n=i.width,l=i.height;return{x:st(s.x,n,t.width,a),y:st(s.y,l,t.height,a)}}function st(s,r,t,a){var o=r*a/2-t/2;return ze(s,-o,o)}function rt(s,r){return Math.sqrt(Math.pow(s.y-r.y,2)+Math.pow(s.x-r.x,2))}function ot(s,r){return Math.atan2(r.y-s.y,r.x-s.x)*180/Math.PI}function da(s,r,t,a,o,i,n){i===void 0&&(i=0),n===void 0&&(n=!0);var l=n?ma:xa,d=be(r.width,r.height,i),h=be(r.naturalWidth,r.naturalHeight,i),f={x:l(100,((d.width-t.width/o)/2-s.x/o)/d.width*100),y:l(100,((d.height-t.height/o)/2-s.y/o)/d.height*100),width:l(100,t.width/d.width*100/o),height:l(100,t.height/d.height*100/o)},m=Math.round(l(h.width,f.width*h.width/100)),u=Math.round(l(h.height,f.height*h.height/100)),S=h.width>=h.height*a,b=S?{width:Math.round(u*a),height:u}:{width:m,height:Math.round(m/a)},w=Y(Y({},b),{x:Math.round(l(h.width-b.width,f.x*h.width/100)),y:Math.round(l(h.height-b.height,f.y*h.height/100))});return{croppedAreaPercentages:f,croppedAreaPixels:w}}function ma(s,r){return Math.min(s,Math.max(0,r))}function xa(s,r){return r}function ha(s,r,t,a,o,i){var n=be(r.width,r.height,t),l=ze(a.width/n.width*(100/s.width),o,i),d={x:l*n.width/2-a.width/2-n.width*l*(s.x/100),y:l*n.height/2-a.height/2-n.height*l*(s.y/100)};return{crop:d,zoom:l}}function pa(s,r,t){var a=ca(r);return t.height>t.width?t.height/(s.height*a):t.width/(s.width*a)}function ua(s,r,t,a,o,i){t===void 0&&(t=0);var n=be(r.naturalWidth,r.naturalHeight,t),l=ze(pa(s,r,a),o,i),d=a.height>a.width?a.height/s.height:a.width/s.width,h={x:((n.width-s.width)/2-s.x)*d,y:((n.height-s.height)/2-s.y)*d};return{crop:h,zoom:l}}function it(s,r){return{x:(r.x+s.x)/2,y:(r.y+s.y)/2}}function ga(s){return s*Math.PI/180}function be(s,r,t){var a=ga(t);return{width:Math.abs(Math.cos(a)*s)+Math.abs(Math.sin(a)*r),height:Math.abs(Math.sin(a)*s)+Math.abs(Math.cos(a)*r)}}function ze(s,r,t){return Math.min(Math.max(s,r),t)}function De(){for(var s=[],r=0;r<arguments.length;r++)s[r]=arguments[r];return s.filter(function(t){return typeof t=="string"&&t.length>0}).join(" ").trim()}var fa=`.reactEasyCrop_Container {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  overflow: hidden;
  user-select: none;
  touch-action: none;
  cursor: move;
  display: flex;
  justify-content: center;
  align-items: center;
}

.reactEasyCrop_Image,
.reactEasyCrop_Video {
  will-change: transform; /* this improves performances and prevent painting issues on iOS Chrome */
}

.reactEasyCrop_Contain {
  max-width: 100%;
  max-height: 100%;
  margin: auto;
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
}
.reactEasyCrop_Cover_Horizontal {
  width: 100%;
  height: auto;
}
.reactEasyCrop_Cover_Vertical {
  width: auto;
  height: 100%;
}

.reactEasyCrop_CropArea {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  border: 1px solid rgba(255, 255, 255, 0.5);
  box-sizing: border-box;
  box-shadow: 0 0 0 9999em;
  color: rgba(0, 0, 0, 0.5);
  overflow: hidden;
}

.reactEasyCrop_CropAreaRound {
  border-radius: 50%;
}

.reactEasyCrop_CropAreaGrid::before {
  content: ' ';
  box-sizing: border-box;
  position: absolute;
  border: 1px solid rgba(255, 255, 255, 0.5);
  top: 0;
  bottom: 0;
  left: 33.33%;
  right: 33.33%;
  border-top: 0;
  border-bottom: 0;
}

.reactEasyCrop_CropAreaGrid::after {
  content: ' ';
  box-sizing: border-box;
  position: absolute;
  border: 1px solid rgba(255, 255, 255, 0.5);
  top: 33.33%;
  bottom: 33.33%;
  left: 0;
  right: 0;
  border-left: 0;
  border-right: 0;
}
`,ba=1,va=3,ya=1,wt=(function(s){qt(r,s);function r(){var t=s!==null&&s.apply(this,arguments)||this;return t.cropperRef=c.createRef(),t.imageRef=c.createRef(),t.videoRef=c.createRef(),t.containerPosition={x:0,y:0},t.containerRef=null,t.styleRef=null,t.containerRect=null,t.mediaSize={width:0,height:0,naturalWidth:0,naturalHeight:0},t.dragStartPosition={x:0,y:0},t.dragStartCrop={x:0,y:0},t.gestureZoomStart=0,t.gestureRotationStart=0,t.isTouching=!1,t.lastPinchDistance=0,t.lastPinchRotation=0,t.rafDragTimeout=null,t.rafPinchTimeout=null,t.wheelTimer=null,t.currentDoc=typeof document<"u"?document:null,t.currentWindow=typeof window<"u"?window:null,t.resizeObserver=null,t.previousCropSize=null,t.isInitialized=!1,t.state={cropSize:null,hasWheelJustStarted:!1,mediaObjectFit:void 0},t.initResizeObserver=function(){if(!(typeof window.ResizeObserver>"u"||!t.containerRef)){var a=!0;t.resizeObserver=new window.ResizeObserver(function(o){if(a){a=!1;return}t.computeSizes()}),t.resizeObserver.observe(t.containerRef)}},t.preventZoomSafari=function(a){return a.preventDefault()},t.cleanEvents=function(){t.currentDoc&&(t.currentDoc.removeEventListener("mousemove",t.onMouseMove),t.currentDoc.removeEventListener("mouseup",t.onDragStopped),t.currentDoc.removeEventListener("touchmove",t.onTouchMove),t.currentDoc.removeEventListener("touchend",t.onDragStopped),t.currentDoc.removeEventListener("gesturechange",t.onGestureChange),t.currentDoc.removeEventListener("gestureend",t.onGestureEnd),t.currentDoc.removeEventListener("scroll",t.onScroll))},t.clearScrollEvent=function(){t.containerRef&&t.containerRef.removeEventListener("wheel",t.onWheel),t.wheelTimer&&clearTimeout(t.wheelTimer)},t.onMediaLoad=function(){var a=t.computeSizes();a&&(t.previousCropSize=a,t.emitCropData(),t.setInitialCrop(a),t.isInitialized=!0),t.props.onMediaLoaded&&t.props.onMediaLoaded(t.mediaSize)},t.setInitialCrop=function(a){if(t.props.initialCroppedAreaPercentages){var o=ha(t.props.initialCroppedAreaPercentages,t.mediaSize,t.props.rotation,a,t.props.minZoom,t.props.maxZoom),i=o.crop,n=o.zoom;t.props.onCropChange(i),t.props.onZoomChange&&t.props.onZoomChange(n)}else if(t.props.initialCroppedAreaPixels){var l=ua(t.props.initialCroppedAreaPixels,t.mediaSize,t.props.rotation,a,t.props.minZoom,t.props.maxZoom),i=l.crop,n=l.zoom;t.props.onCropChange(i),t.props.onZoomChange&&t.props.onZoomChange(n)}},t.computeSizes=function(){var a,o,i,n,l,d,h=t.imageRef.current||t.videoRef.current;if(h&&t.containerRef){t.containerRect=t.containerRef.getBoundingClientRect(),t.saveContainerPosition();var f=t.containerRect.width/t.containerRect.height,m=((a=t.imageRef.current)===null||a===void 0?void 0:a.naturalWidth)||((o=t.videoRef.current)===null||o===void 0?void 0:o.videoWidth)||0,u=((i=t.imageRef.current)===null||i===void 0?void 0:i.naturalHeight)||((n=t.videoRef.current)===null||n===void 0?void 0:n.videoHeight)||0,S=h.offsetWidth<m||h.offsetHeight<u,b=m/u,w=void 0;if(S)switch(t.state.mediaObjectFit){default:case"contain":w=f>b?{width:t.containerRect.height*b,height:t.containerRect.height}:{width:t.containerRect.width,height:t.containerRect.width/b};break;case"horizontal-cover":w={width:t.containerRect.width,height:t.containerRect.width/b};break;case"vertical-cover":w={width:t.containerRect.height*b,height:t.containerRect.height};break}else w={width:h.offsetWidth,height:h.offsetHeight};t.mediaSize=Y(Y({},w),{naturalWidth:m,naturalHeight:u}),t.props.setMediaSize&&t.props.setMediaSize(t.mediaSize);var D=t.props.cropSize?t.props.cropSize:la(t.mediaSize.width,t.mediaSize.height,t.containerRect.width,t.containerRect.height,t.props.aspect,t.props.rotation);return(((l=t.state.cropSize)===null||l===void 0?void 0:l.height)!==D.height||((d=t.state.cropSize)===null||d===void 0?void 0:d.width)!==D.width)&&t.props.onCropSizeChange&&t.props.onCropSizeChange(D),t.setState({cropSize:D},t.recomputeCropPosition),t.props.setCropSize&&t.props.setCropSize(D),D}},t.saveContainerPosition=function(){if(t.containerRef){var a=t.containerRef.getBoundingClientRect();t.containerPosition={x:a.left,y:a.top}}},t.onMouseDown=function(a){t.currentDoc&&(a.preventDefault(),t.currentDoc.addEventListener("mousemove",t.onMouseMove),t.currentDoc.addEventListener("mouseup",t.onDragStopped),t.saveContainerPosition(),t.onDragStart(r.getMousePoint(a)))},t.onMouseMove=function(a){return t.onDrag(r.getMousePoint(a))},t.onScroll=function(a){t.currentDoc&&(a.preventDefault(),t.saveContainerPosition())},t.onTouchStart=function(a){t.currentDoc&&(t.isTouching=!0,!(t.props.onTouchRequest&&!t.props.onTouchRequest(a))&&(t.currentDoc.addEventListener("touchmove",t.onTouchMove,{passive:!1}),t.currentDoc.addEventListener("touchend",t.onDragStopped),t.saveContainerPosition(),a.touches.length===2?t.onPinchStart(a):a.touches.length===1&&t.onDragStart(r.getTouchPoint(a.touches[0]))))},t.onTouchMove=function(a){a.preventDefault(),a.touches.length===2?t.onPinchMove(a):a.touches.length===1&&t.onDrag(r.getTouchPoint(a.touches[0]))},t.onGestureStart=function(a){t.currentDoc&&(a.preventDefault(),t.currentDoc.addEventListener("gesturechange",t.onGestureChange),t.currentDoc.addEventListener("gestureend",t.onGestureEnd),t.gestureZoomStart=t.props.zoom,t.gestureRotationStart=t.props.rotation)},t.onGestureChange=function(a){if(a.preventDefault(),!t.isTouching){var o=r.getMousePoint(a),i=t.gestureZoomStart-1+a.scale;if(t.setNewZoom(i,o,{shouldUpdatePosition:!0}),t.props.onRotationChange){var n=t.gestureRotationStart+a.rotation;t.props.onRotationChange(n)}}},t.onGestureEnd=function(a){t.cleanEvents()},t.onDragStart=function(a){var o,i,n=a.x,l=a.y;t.dragStartPosition={x:n,y:l},t.dragStartCrop=Y({},t.props.crop),(i=(o=t.props).onInteractionStart)===null||i===void 0||i.call(o)},t.onDrag=function(a){var o=a.x,i=a.y;t.currentWindow&&(t.rafDragTimeout&&t.currentWindow.cancelAnimationFrame(t.rafDragTimeout),t.rafDragTimeout=t.currentWindow.requestAnimationFrame(function(){if(t.state.cropSize&&!(o===void 0||i===void 0)){var n=o-t.dragStartPosition.x,l=i-t.dragStartPosition.y,d={x:t.dragStartCrop.x+n,y:t.dragStartCrop.y+l},h=t.props.restrictPosition?ye(d,t.mediaSize,t.state.cropSize,t.props.zoom,t.props.rotation):d;t.props.onCropChange(h)}}))},t.onDragStopped=function(){var a,o;t.isTouching=!1,t.cleanEvents(),t.emitCropData(),(o=(a=t.props).onInteractionEnd)===null||o===void 0||o.call(a)},t.onWheel=function(a){if(t.currentWindow&&!(t.props.onWheelRequest&&!t.props.onWheelRequest(a))){a.preventDefault();var o=r.getMousePoint(a),i=na(a).pixelY,n=t.props.zoom-i*t.props.zoomSpeed/200;t.setNewZoom(n,o,{shouldUpdatePosition:!0}),t.state.hasWheelJustStarted||t.setState({hasWheelJustStarted:!0},function(){var l,d;return(d=(l=t.props).onInteractionStart)===null||d===void 0?void 0:d.call(l)}),t.wheelTimer&&clearTimeout(t.wheelTimer),t.wheelTimer=t.currentWindow.setTimeout(function(){return t.setState({hasWheelJustStarted:!1},function(){var l,d;return(d=(l=t.props).onInteractionEnd)===null||d===void 0?void 0:d.call(l)})},250)}},t.getPointOnContainer=function(a,o){var i=a.x,n=a.y;if(!t.containerRect)throw new Error("The Cropper is not mounted");return{x:t.containerRect.width/2-(i-o.x),y:t.containerRect.height/2-(n-o.y)}},t.getPointOnMedia=function(a){var o=a.x,i=a.y,n=t.props,l=n.crop,d=n.zoom;return{x:(o+l.x)/d,y:(i+l.y)/d}},t.setNewZoom=function(a,o,i){var n=i===void 0?{}:i,l=n.shouldUpdatePosition,d=l===void 0?!0:l;if(!(!t.state.cropSize||!t.props.onZoomChange)){var h=ze(a,t.props.minZoom,t.props.maxZoom);if(d){var f=t.getPointOnContainer(o,t.containerPosition),m=t.getPointOnMedia(f),u={x:m.x*h-f.x,y:m.y*h-f.y},S=t.props.restrictPosition?ye(u,t.mediaSize,t.state.cropSize,h,t.props.rotation):u;t.props.onCropChange(S)}t.props.onZoomChange(h)}},t.getCropData=function(){if(!t.state.cropSize)return null;var a=t.props.restrictPosition?ye(t.props.crop,t.mediaSize,t.state.cropSize,t.props.zoom,t.props.rotation):t.props.crop;return da(a,t.mediaSize,t.state.cropSize,t.getAspect(),t.props.zoom,t.props.rotation,t.props.restrictPosition)},t.emitCropData=function(){var a=t.getCropData();if(a){var o=a.croppedAreaPercentages,i=a.croppedAreaPixels;t.props.onCropComplete&&t.props.onCropComplete(o,i),t.props.onCropAreaChange&&t.props.onCropAreaChange(o,i)}},t.emitCropAreaChange=function(){var a=t.getCropData();if(a){var o=a.croppedAreaPercentages,i=a.croppedAreaPixels;t.props.onCropAreaChange&&t.props.onCropAreaChange(o,i)}},t.recomputeCropPosition=function(){var a,o;if(t.state.cropSize){var i=t.props.crop;if(t.isInitialized&&(!((a=t.previousCropSize)===null||a===void 0)&&a.width)&&(!((o=t.previousCropSize)===null||o===void 0)&&o.height)){var n=Math.abs(t.previousCropSize.width-t.state.cropSize.width)>1e-6||Math.abs(t.previousCropSize.height-t.state.cropSize.height)>1e-6;if(n){var l=t.state.cropSize.width/t.previousCropSize.width,d=t.state.cropSize.height/t.previousCropSize.height;i={x:t.props.crop.x*l,y:t.props.crop.y*d}}}var h=t.props.restrictPosition?ye(i,t.mediaSize,t.state.cropSize,t.props.zoom,t.props.rotation):i;t.previousCropSize=t.state.cropSize,t.props.onCropChange(h),t.emitCropData()}},t.onKeyDown=function(a){var o,i,n=t.props,l=n.crop,d=n.onCropChange,h=n.keyboardStep,f=n.zoom,m=n.rotation,u=h;if(t.state.cropSize){a.shiftKey&&(u*=.2);var S=Y({},l);switch(a.key){case"ArrowUp":S.y-=u,a.preventDefault();break;case"ArrowDown":S.y+=u,a.preventDefault();break;case"ArrowLeft":S.x-=u,a.preventDefault();break;case"ArrowRight":S.x+=u,a.preventDefault();break;default:return}t.props.restrictPosition&&(S=ye(S,t.mediaSize,t.state.cropSize,f,m)),a.repeat||(i=(o=t.props).onInteractionStart)===null||i===void 0||i.call(o),d(S)}},t.onKeyUp=function(a){var o,i;switch(a.key){case"ArrowUp":case"ArrowDown":case"ArrowLeft":case"ArrowRight":a.preventDefault();break;default:return}t.emitCropData(),(i=(o=t.props).onInteractionEnd)===null||i===void 0||i.call(o)},t}return r.prototype.componentDidMount=function(){!this.currentDoc||!this.currentWindow||(this.containerRef&&(this.containerRef.ownerDocument&&(this.currentDoc=this.containerRef.ownerDocument),this.currentDoc.defaultView&&(this.currentWindow=this.currentDoc.defaultView),this.initResizeObserver(),typeof window.ResizeObserver>"u"&&this.currentWindow.addEventListener("resize",this.computeSizes),this.props.zoomWithScroll&&this.containerRef.addEventListener("wheel",this.onWheel,{passive:!1}),this.containerRef.addEventListener("gesturestart",this.onGestureStart)),this.currentDoc.addEventListener("scroll",this.onScroll),this.props.disableAutomaticStylesInjection||(this.styleRef=this.currentDoc.createElement("style"),this.styleRef.setAttribute("type","text/css"),this.props.nonce&&this.styleRef.setAttribute("nonce",this.props.nonce),this.styleRef.innerHTML=fa,this.currentDoc.head.appendChild(this.styleRef)),this.imageRef.current&&this.imageRef.current.complete&&this.onMediaLoad(),this.props.setImageRef&&this.props.setImageRef(this.imageRef),this.props.setVideoRef&&this.props.setVideoRef(this.videoRef),this.props.setCropperRef&&this.props.setCropperRef(this.cropperRef))},r.prototype.componentWillUnmount=function(){var t,a;!this.currentDoc||!this.currentWindow||(typeof window.ResizeObserver>"u"&&this.currentWindow.removeEventListener("resize",this.computeSizes),(t=this.resizeObserver)===null||t===void 0||t.disconnect(),this.containerRef&&this.containerRef.removeEventListener("gesturestart",this.preventZoomSafari),this.styleRef&&((a=this.styleRef.parentNode)===null||a===void 0||a.removeChild(this.styleRef)),this.cleanEvents(),this.props.zoomWithScroll&&this.clearScrollEvent())},r.prototype.componentDidUpdate=function(t){var a,o,i,n,l,d,h,f,m;t.rotation!==this.props.rotation?(this.computeSizes(),this.recomputeCropPosition()):t.aspect!==this.props.aspect?this.computeSizes():t.objectFit!==this.props.objectFit?this.computeSizes():t.zoom!==this.props.zoom?this.recomputeCropPosition():((a=t.cropSize)===null||a===void 0?void 0:a.height)!==((o=this.props.cropSize)===null||o===void 0?void 0:o.height)||((i=t.cropSize)===null||i===void 0?void 0:i.width)!==((n=this.props.cropSize)===null||n===void 0?void 0:n.width)?this.computeSizes():(((l=t.crop)===null||l===void 0?void 0:l.x)!==((d=this.props.crop)===null||d===void 0?void 0:d.x)||((h=t.crop)===null||h===void 0?void 0:h.y)!==((f=this.props.crop)===null||f===void 0?void 0:f.y))&&this.emitCropAreaChange(),t.zoomWithScroll!==this.props.zoomWithScroll&&this.containerRef&&(this.props.zoomWithScroll?this.containerRef.addEventListener("wheel",this.onWheel,{passive:!1}):this.clearScrollEvent()),t.video!==this.props.video&&((m=this.videoRef.current)===null||m===void 0||m.load());var u=this.getObjectFit();u!==this.state.mediaObjectFit&&this.setState({mediaObjectFit:u},this.computeSizes)},r.prototype.getAspect=function(){var t=this.props,a=t.cropSize,o=t.aspect;return a?a.width/a.height:o},r.prototype.getObjectFit=function(){var t,a,o,i;if(this.props.objectFit==="cover"){var n=this.imageRef.current||this.videoRef.current;if(n&&this.containerRef){this.containerRect=this.containerRef.getBoundingClientRect();var l=this.containerRect.width/this.containerRect.height,d=((t=this.imageRef.current)===null||t===void 0?void 0:t.naturalWidth)||((a=this.videoRef.current)===null||a===void 0?void 0:a.videoWidth)||0,h=((o=this.imageRef.current)===null||o===void 0?void 0:o.naturalHeight)||((i=this.videoRef.current)===null||i===void 0?void 0:i.videoHeight)||0,f=d/h;return f<l?"horizontal-cover":"vertical-cover"}return"horizontal-cover"}return this.props.objectFit},r.prototype.onPinchStart=function(t){var a=r.getTouchPoint(t.touches[0]),o=r.getTouchPoint(t.touches[1]);this.lastPinchDistance=rt(a,o),this.lastPinchRotation=ot(a,o),this.onDragStart(it(a,o))},r.prototype.onPinchMove=function(t){var a=this;if(!(!this.currentDoc||!this.currentWindow)){var o=r.getTouchPoint(t.touches[0]),i=r.getTouchPoint(t.touches[1]),n=it(o,i);this.onDrag(n),this.rafPinchTimeout&&this.currentWindow.cancelAnimationFrame(this.rafPinchTimeout),this.rafPinchTimeout=this.currentWindow.requestAnimationFrame(function(){var l=rt(o,i),d=a.props.zoom*(l/a.lastPinchDistance);a.setNewZoom(d,n,{shouldUpdatePosition:!1}),a.lastPinchDistance=l;var h=ot(o,i),f=a.props.rotation+(h-a.lastPinchRotation);a.props.onRotationChange&&a.props.onRotationChange(f),a.lastPinchRotation=h})}},r.prototype.render=function(){var t=this,a,o=this.props,i=o.image,n=o.video,l=o.mediaProps,d=o.cropperProps,h=o.transform,f=o.crop,m=f.x,u=f.y,S=o.rotation,b=o.zoom,w=o.cropShape,D=o.showGrid,M=o.roundCropAreaPixels,E=o.style,y=E.containerStyle,j=E.cropAreaStyle,R=E.mediaStyle,P=o.classes,$=P.containerClassName,_=P.cropAreaClassName,p=P.mediaClassName,g=(a=this.state.mediaObjectFit)!==null&&a!==void 0?a:this.getObjectFit();return c.createElement("div",{onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart,ref:function(C){return t.containerRef=C},"data-testid":"container",style:y,className:De("reactEasyCrop_Container",$)},i?c.createElement("img",Y({alt:"",className:De("reactEasyCrop_Image",g==="contain"&&"reactEasyCrop_Contain",g==="horizontal-cover"&&"reactEasyCrop_Cover_Horizontal",g==="vertical-cover"&&"reactEasyCrop_Cover_Vertical",p)},l,{src:i,ref:this.imageRef,style:Y(Y({},R),{transform:h||"translate(".concat(m,"px, ").concat(u,"px) rotate(").concat(S,"deg) scale(").concat(b,")")}),onLoad:this.onMediaLoad})):n&&c.createElement("video",Y({autoPlay:!0,playsInline:!0,loop:!0,muted:!0,className:De("reactEasyCrop_Video",g==="contain"&&"reactEasyCrop_Contain",g==="horizontal-cover"&&"reactEasyCrop_Cover_Horizontal",g==="vertical-cover"&&"reactEasyCrop_Cover_Vertical",p)},l,{ref:this.videoRef,onLoadedMetadata:this.onMediaLoad,style:Y(Y({},R),{transform:h||"translate(".concat(m,"px, ").concat(u,"px) rotate(").concat(S,"deg) scale(").concat(b,")")}),controls:!1}),(Array.isArray(n)?n:[{src:n}]).map(function(x){return c.createElement("source",Y({key:x.src},x))})),this.state.cropSize&&c.createElement("div",Y({ref:this.cropperRef,style:Y(Y({},j),{width:M?Math.round(this.state.cropSize.width):this.state.cropSize.width,height:M?Math.round(this.state.cropSize.height):this.state.cropSize.height}),tabIndex:0,onKeyDown:this.onKeyDown,onKeyUp:this.onKeyUp,"data-testid":"cropper",className:De("reactEasyCrop_CropArea",w==="round"&&"reactEasyCrop_CropAreaRound",D&&"reactEasyCrop_CropAreaGrid",_)},d)))},r.defaultProps={zoom:1,rotation:0,aspect:4/3,maxZoom:va,minZoom:ba,cropShape:"rect",objectFit:"contain",showGrid:!0,style:{},classes:{},mediaProps:{},cropperProps:{},zoomSpeed:1,restrictPosition:!0,zoomWithScroll:!0,keyboardStep:ya},r.getMousePoint=function(t){return{x:Number(t.clientX),y:Number(t.clientY)}},r.getTouchPoint=function(t){return{x:Number(t.clientX),y:Number(t.clientY)}},r})(c.Component);const ja=s=>new Promise((r,t)=>{const a=new Image;a.addEventListener("load",()=>r(a)),a.addEventListener("error",o=>t(o)),a.setAttribute("crossOrigin","anonymous"),a.src=s});function Nt(s){return s*Math.PI/180}function wa(s,r,t){const a=Nt(t);return{width:Math.abs(Math.cos(a)*s)+Math.abs(Math.sin(a)*r),height:Math.abs(Math.sin(a)*s)+Math.abs(Math.cos(a)*r)}}async function Ct(s,r,t=0,a={horizontal:!1,vertical:!1}){const o=await ja(s),i=document.createElement("canvas"),n=i.getContext("2d");if(!n)return null;const l=Nt(t),{width:d,height:h}=wa(o.width,o.height,t);i.width=d,i.height=h,n.translate(d/2,h/2),n.rotate(l),n.scale(a.horizontal?-1:1,a.vertical?-1:1),n.translate(-o.width/2,-o.height/2),n.drawImage(o,0,0);const f=n.getImageData(r.x,r.y,r.width,r.height);return i.width=r.width,i.height=r.height,n.putImageData(f,0,0),new Promise((m,u)=>{i.toBlob(S=>{m(S)},"image/jpeg")})}const St=({url:s,onUpload:r})=>{const{user:t}=mt(),[a,o]=c.useState(null),[i,n]=c.useState(!1),[l,d]=c.useState(""),[h,f]=c.useState(null),[m,u]=c.useState({x:0,y:0}),[S,b]=c.useState(1),[w,D]=c.useState(null),[M,E]=c.useState(!1),y=c.useRef(null);c.useEffect(()=>{if(s){const p=Z.getPublicUrl("perfis",s);o(`${p}?t=${new Date().getTime()}`)}else o(null)},[s]);const j=async p=>{if(p.target.files&&p.target.files.length>0){const g=p.target.files[0],x=new FileReader;x.addEventListener("load",()=>{var C;f(((C=x.result)==null?void 0:C.toString())||""),E(!0)}),x.readAsDataURL(g)}},R=(p,g)=>{D(g)},P=async()=>{if(!(!h||!w))try{n(!0);const p=await Ct(h,w);if(!p)throw new Error("Erro ao cortar a imagem.");const g=new File([p],`avatar_${Date.now()}.jpg`,{type:"image/jpeg"});await _(g),E(!1),f(null),b(1)}catch(p){d(O(p)),n(!1)}},$=()=>{E(!1),f(null),b(1),y.current&&(y.current.value="")},_=async p=>{if(t)try{d("");const g=`${t.id}/avatar`,x=`${g}/v_${Date.now()}.jpg`;try{const C=await Z.list("perfis",g);if(C&&C.length>0){const k=C.map(I=>`${g}/${I.name}`);await Z.remove("perfis",k)}}catch(C){console.warn("Limpando fotos antigas...",C)}await Z.upload("perfis",x,p),r(x,{onSuccess:()=>{},onError:()=>{d("Falha ao salvar no perfil.")}})}catch(g){d(O(g))}finally{n(!1)}};return e.jsxs("div",{children:[e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"w-48 h-48 rounded-full overflow-hidden border-4 border-gray-600 group-hover:border-primary transition-colors duration-300 flex items-center justify-center bg-gray-700",children:a?e.jsx("img",{src:a,alt:"Avatar",className:"w-full h-full object-cover"}):e.jsx(de,{className:"w-24 h-24 text-gray-500"})}),e.jsx("label",{htmlFor:"avatar-input",className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-50 flex flex-col items-center justify-center cursor-pointer rounded-full transition-all duration-300",children:e.jsxs("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:[e.jsx(ce,{className:"w-10 h-10 text-white mb-2"}),e.jsx("span",{className:"text-white font-bold text-center",children:i?"Enviando...":"Alterar Foto"})]})}),e.jsx("input",{ref:y,style:{visibility:"hidden",position:"absolute"},type:"file",id:"avatar-input",accept:"image/*",onChange:j,disabled:i})]}),l&&e.jsx("p",{className:"text-sm text-red-400 mt-2 text-center",children:l}),M&&h&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-80 p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg w-full max-w-md overflow-hidden shadow-2xl animate-fade-in",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-bold text-white font-poppins",children:"Ajustar Foto"}),e.jsx("button",{onClick:$,className:"text-gray-400 hover:text-white",children:e.jsx(Pe,{className:"w-6 h-6"})})]}),e.jsx("div",{className:"relative w-full h-80 bg-black",children:e.jsx(wt,{image:h,crop:m,zoom:S,aspect:1,onCropChange:u,onCropComplete:R,onZoomChange:b,cropShape:"round",showGrid:!1})}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsx("input",{type:"range",value:S,min:1,max:3,step:.1,onChange:p=>b(Number(p.target.value)),className:"w-full h-2 bg-gray-600 rounded-lg appearance-none cursor-pointer accent-primary"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{onClick:$,className:"flex-1 py-2 px-4 border border-gray-600 rounded-md text-white hover:bg-gray-700",children:"Cancelar"}),e.jsx("button",{onClick:P,disabled:i,className:"flex-1 py-2 px-4 bg-secondary text-white font-bold rounded-md flex items-center justify-center gap-2",children:i?"Salvando...":e.jsxs(e.Fragment,{children:[e.jsx(le,{className:"w-5 h-5"})," Salvar"]})})]})]})]})})]})},_t=({currentPath:s,bucketName:r,userId:t,onUploadComplete:a})=>{const[o,i]=c.useState(null),[n,l]=c.useState(!1),[d,h]=c.useState(""),[f,m]=c.useState(null),[u,S]=c.useState({x:0,y:0}),[b,w]=c.useState(1),[D,M]=c.useState(null),[E,y]=c.useState(!1),j=c.useRef(null);c.useEffect(()=>{if(s){const g=Z.getPublicUrl(r,s);i(`${g}?t=${new Date().getTime()}`)}else i(null)},[s,r]);const R=async g=>{if(!g.target.files||g.target.files.length===0)return;h("");const x=g.target.files[0];if(x.size>5*1024*1024){h("A imagem deve ter no máximo 5MB.");return}const C=new FileReader;C.addEventListener("load",()=>{var k;m(((k=C.result)==null?void 0:k.toString())||null),y(!0)}),C.readAsDataURL(x)},P=(g,x)=>{M(x)},$=()=>{y(!1),m(null),w(1),j.current&&(j.current.value="")},_=async()=>{if(!(!f||!D))try{l(!0);const g=await Ct(f,D);if(!g)throw new Error("Erro ao cortar a imagem.");const x=new File([g],"cover.jpg",{type:"image/jpeg"});await p(x),y(!1),m(null),w(1)}catch(g){h(O(g)),l(!1)}},p=async g=>{try{const C=`cover_${Date.now()}.jpg`,k=`${t}/cover/${C}`;if(s)try{await Z.remove(r,[s])}catch(V){console.warn("Erro ao remover capa antiga:",V)}const I=await Z.upload(r,k,g),J=Z.getPublicUrl(r,I);i(`${J}?t=${new Date().getTime()}`),await a(I)}catch(x){h("Erro ao salvar imagem: "+O(x))}finally{l(!1),j.current&&(j.current.value="")}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative w-full h-48 md:h-64 rounded-lg overflow-hidden bg-gray-800 border-2 border-dashed border-gray-600 group hover:border-primary transition-all duration-300 mb-8",children:[o?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:o,alt:"Capa do Perfil",className:"w-full h-full object-cover group-hover:opacity-50 transition-opacity duration-300"}),e.jsxs("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex flex-col items-center justify-center",children:[e.jsx(ce,{className:"w-10 h-10 text-white mb-2"}),e.jsx("span",{className:"text-white font-bold text-sm",children:"Alterar Capa"})]})]}):e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center text-gray-500 group-hover:text-primary transition-colors",children:[e.jsx(Ce,{className:"w-12 h-12 mb-2"}),e.jsx("span",{className:"font-medium",children:"Adicionar Foto de Capa"}),e.jsx("span",{className:"text-xs mt-1 text-gray-600",children:"Recomendado: 1200x400px"})]}),n&&!E&&e.jsxs("div",{className:"absolute inset-0 bg-black/70 flex flex-col items-center justify-center z-10",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-white mb-2"}),e.jsx("span",{className:"text-white text-xs",children:"Enviando..."})]}),e.jsx("input",{ref:j,type:"file",accept:"image/png, image/jpeg, image/jpg, image/webp",className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer z-20",onChange:R,disabled:n}),d&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-red-500/90 text-white text-xs p-2 text-center z-30",children:d})]}),E&&f&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-90 p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg w-full max-w-3xl overflow-hidden shadow-2xl animate-fade-in flex flex-col max-h-[90vh]",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center flex-shrink-0",children:[e.jsx("h3",{className:"text-lg font-bold text-white font-poppins",children:"Ajustar Capa"}),e.jsx("button",{onClick:$,className:"text-gray-400 hover:text-white",children:e.jsx(Pe,{className:"w-6 h-6"})})]}),e.jsx("div",{className:"relative w-full flex-grow bg-black min-h-[300px] h-[50vh]",children:e.jsx(wt,{image:f,crop:u,zoom:b,aspect:3/1,onCropChange:S,onCropComplete:P,onZoomChange:w,showGrid:!0})}),e.jsxs("div",{className:"p-4 space-y-4 bg-gray-800 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-400",children:[e.jsx("span",{className:"flex-shrink-0",children:"Zoom"}),e.jsx("input",{type:"range",value:b,min:1,max:3,step:.1,"aria-labelledby":"Zoom",onChange:g=>w(Number(g.target.value)),className:"w-full h-2 bg-gray-600 rounded-lg appearance-none cursor-pointer accent-primary"})]}),e.jsxs("div",{className:"flex gap-4 pt-2",children:[e.jsx("button",{onClick:$,className:"flex-1 py-3 px-4 border border-gray-600 rounded-md text-white hover:bg-gray-700 transition-colors font-medium",children:"Cancelar"}),e.jsx("button",{onClick:_,disabled:n,className:"flex-1 py-3 px-4 bg-secondary text-white font-bold rounded-md hover:bg-opacity-90 transition-colors flex items-center justify-center gap-2",children:n?"Salvando...":e.jsxs(e.Fragment,{children:[e.jsx(le,{className:"w-5 h-5"})," Salvar Capa"]})})]})]})]})})]})},_e=s=>s.replace(/\D/g,""),Na=(s,r)=>{const t=s.trim();if(!t)return{valid:!1,error:"Chave PIX não pode estar vazia"};switch(r){case"cpf":return Ca(t);case"cnpj":return Sa(t);case"email":const a=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;return{valid:a.test(t),error:a.test(t)?void 0:"E-mail inválido"};case"celular":const o=_e(t),i=o.length===11&&o.startsWith("0")===!1;return{valid:i,error:i?void 0:"Celular deve ter 11 dígitos (DDD + número)"};case"aleatoria":const n=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;return{valid:n.test(t),error:n.test(t)?void 0:"Formato de chave aleatória inválido"};default:return{valid:!1,error:"Tipo de chave desconhecido"}}},Ca=s=>{const r=s.replace(/\D/g,"");if(r.length!==11)return{valid:!1,error:"CPF deve ter 11 dígitos"};if(/^(\d)\1{10}$/.test(r))return{valid:!1,error:"CPF inválido"};let t=0;for(let o=0;o<9;o++)t+=parseInt(r.charAt(o))*(10-o);let a=11-t%11;if(a>=10&&(a=0),a!==parseInt(r.charAt(9)))return{valid:!1,error:"CPF inválido"};t=0;for(let o=0;o<10;o++)t+=parseInt(r.charAt(o))*(11-o);return a=11-t%11,a>=10&&(a=0),a!==parseInt(r.charAt(10))?{valid:!1,error:"CPF inválido"}:{valid:!0}},Sa=s=>{const r=s.replace(/\D/g,"");if(r.length!==14)return{valid:!1,error:"CNPJ deve ter 14 dígitos"};if(/^(\d)\1{13}$/.test(r))return{valid:!1,error:"CNPJ inválido"};let t=r.length-2,a=r.substring(0,t);const o=r.substring(t);let i=0,n=t-7;for(let d=t;d>=1;d--)i+=parseInt(a.charAt(t-d))*n--,n<2&&(n=9);let l=i%11<2?0:11-i%11;if(l!==parseInt(o.charAt(0)))return{valid:!1,error:"CNPJ inválido"};t=t+1,a=r.substring(0,t),i=0,n=t-7;for(let d=t;d>=1;d--)i+=parseInt(a.charAt(t-d))*n--,n<2&&(n=9);return l=i%11<2?0:11-i%11,l!==parseInt(o.charAt(1))?{valid:!1,error:"CNPJ inválido"}:{valid:!0}},_a=s=>{var t,a,o,i,n,l;const r=[];if((!s.nome||s.nome.trim().length<3)&&r.push("Nome artístico deve ter pelo menos 3 caracteres"),s.telefone){const d=_e(s.telefone);d.length!==10&&d.length!==11&&r.push("Telefone deve ter 10 ou 11 dígitos")}if(s.descricao&&s.descricao.length>0&&s.descricao.length<20&&r.push("Descrição deve ter pelo menos 20 caracteres ou ficar vazia"),(t=s.dados_bancarios)!=null&&t.chave_pix&&((a=s.dados_bancarios)!=null&&a.tipo_chave)){const d=Na(s.dados_bancarios.chave_pix,s.dados_bancarios.tipo_chave);d.valid||r.push(d.error||"Chave PIX inválida")}return(o=s.dados_bancarios)!=null&&o.chave_pix&&!((i=s.dados_bancarios)!=null&&i.tipo_chave)&&r.push("Selecione o tipo da chave PIX"),!((n=s.dados_bancarios)!=null&&n.chave_pix)&&((l=s.dados_bancarios)!=null&&l.tipo_chave)&&r.push("Informe a chave PIX"),{valid:r.length===0,errors:r}},ka=s=>{const r=[];if((!s.nome||s.nome.trim().length<3)&&r.push("Nome do estabelecimento deve ter pelo menos 3 caracteres"),s.telefone){const t=_e(s.telefone);t.length!==10&&t.length!==11&&r.push("Telefone deve ter 10 ou 11 dígitos")}if(s.capacidade!==null&&s.capacidade!==void 0){const t=Number(s.capacidade);(isNaN(t)||t<=0)&&r.push("Capacidade deve ser um número positivo")}return s.descricao&&s.descricao.length>0&&s.descricao.length<20&&r.push("Descrição deve ter pelo menos 20 caracteres ou ficar vazia"),{valid:r.length===0,errors:r}},Da=s=>{if(!s)return null;const r={};return Object.keys(s).forEach(t=>{const a=s[t];a&&typeof a=="string"&&a.trim()!==""&&(r[t]=a.trim())}),Object.keys(r).length>0?r:null},kt=s=>{if(!s)return null;const r={};return Object.keys(s).forEach(t=>{const a=s[t];a&&typeof a=="string"&&a.trim()!==""&&(r[t]=a.trim())}),Object.keys(r).length>0?r:null},nt=[{key:"monday",label:"Segunda-feira"},{key:"tuesday",label:"Terça-feira"},{key:"wednesday",label:"Quarta-feira"},{key:"thursday",label:"Quinta-feira"},{key:"friday",label:"Sexta-feira"},{key:"saturday",label:"Sábado"},{key:"sunday",label:"Domingo"}],Ea=({initialProfile:s,onProfileUpdate:r})=>{const{genres:t}=Mt(),[a,o]=c.useState("idle"),[i,n]=c.useState(""),[l,d]=c.useState(""),[h,f]=c.useState(!1),[m,u]=c.useState(null),S=he(s),[b,w]=c.useState({nome:"",telefone:"",cidade:"",foto_url:"",foto_capa:"",genero_musical:"",descricao:"",midias_sociais:{instagram:"",youtube:"",site:""},dados_bancarios:{banco:"",agencia:"",conta:"",chave_pix:"",tipo_chave:""},disponibilidade:{},rider_tecnico_url:null,mapa_palco_url:null});c.useEffect(()=>{var _,p,g,x,C,k,I,J,V,A,z,W,q,Q,N,B,X,G,T,se,ee,te;if(s){const L={};nt.forEach(F=>{L[F.key]={active:!1,start:"18:00",end:"23:00"}});const U=((_=s.artista)==null?void 0:_.disponibilidade)||{},v={...L,...U};w({nome:s.nome||"",telefone:s.telefone||"",cidade:s.cidade||"",foto_url:s.foto_url||"",foto_capa:((p=s.artista)==null?void 0:p.foto_capa)||"",genero_musical:((g=s.artista)==null?void 0:g.genero_musical)||"",descricao:((x=s.artista)==null?void 0:x.descricao)||"",midias_sociais:{instagram:((k=(C=s.artista)==null?void 0:C.midias_sociais)==null?void 0:k.instagram)||"",youtube:((J=(I=s.artista)==null?void 0:I.midias_sociais)==null?void 0:J.youtube)||"",site:((A=(V=s.artista)==null?void 0:V.midias_sociais)==null?void 0:A.site)||""},dados_bancarios:{banco:((W=(z=s.artista)==null?void 0:z.dados_bancarios)==null?void 0:W.banco)||"",agencia:((Q=(q=s.artista)==null?void 0:q.dados_bancarios)==null?void 0:Q.agencia)||"",conta:((B=(N=s.artista)==null?void 0:N.dados_bancarios)==null?void 0:B.conta)||"",chave_pix:((G=(X=s.artista)==null?void 0:X.dados_bancarios)==null?void 0:G.chave_pix)||"",tipo_chave:((se=(T=s.artista)==null?void 0:T.dados_bancarios)==null?void 0:se.tipo_chave)||""},disponibilidade:v,rider_tecnico_url:((ee=s.artista)==null?void 0:ee.rider_tecnico_url)||null,mapa_palco_url:((te=s.artista)==null?void 0:te.mapa_palco_url)||null})}},[s]);const D=async(_,p)=>{if(!_.target.files||_.target.files.length===0)return;const g=_.target.files[0];u(p);try{const x=`${s.auth_id}/docs/${p}_${Date.now()}.${g.name.split(".").pop()}`,C=await Z.upload("artista",x,g);await K.updateArtist(s.id,null,{[p==="rider"?"rider_tecnico_url":"mapa_palco_url"]:C}),w(k=>({...k,[p==="rider"?"rider_tecnico_url":"mapa_palco_url"]:C})),r()}catch(x){n(O(x))}finally{u(null)}},M=_=>{const{id:p,value:g}=_.target;w(x=>({...x,[p]:g})),a!=="idle"&&o("idle")},E=_=>{const{name:p,value:g}=_.target;w(x=>({...x,midias_sociais:{...x.midias_sociais,[p]:g}})),a!=="idle"&&o("idle")},y=_=>{const{name:p,value:g}=_.target;w(x=>({...x,dados_bancarios:{...x.dados_bancarios,[p]:g}})),a!=="idle"&&o("idle")},j=(_,p,g)=>{w(x=>({...x,disponibilidade:{...x.disponibilidade,[_]:{...x.disponibilidade[_],[p]:g}}})),a!=="idle"&&o("idle")},R=(_,p)=>{K.updateBasicInfo(s.id,{foto_url:_}).then(()=>{d("Foto de perfil atualizada!"),r(),p.onSuccess()}).catch(g=>{d("Falha ao salvar a foto."),p.onError()})},P=async _=>{try{await K.updateArtist(s.id,null,{foto_capa:_}),w(p=>({...p,foto_capa:_})),r()}catch(p){n("Erro ao salvar foto de capa: "+O(p)),o("error")}},$=async _=>{_.preventDefault(),o("saving"),n("");const p=_a(b);if(!p.valid){o("error"),n(p.errors.join("; "));return}const g=b.telefone?_e(b.telefone):"",x=Da(b.dados_bancarios);let C=x;if(x!=null&&x.chave_pix&&(x!=null&&x.tipo_chave)){const I=x.tipo_chave==="cpf"||x.tipo_chave==="cnpj"?x.chave_pix.replace(/\D/g,""):x.chave_pix.trim();C={...x,chave_pix:I}}const k=kt(b.midias_sociais);try{await K.updateArtist(s.id,{nome:b.nome.trim(),telefone:g,cidade:b.cidade.trim()},{genero_musical:b.genero_musical,descricao:b.descricao.trim(),midias_sociais:k||{},dados_bancarios:C||{},disponibilidade:b.disponibilidade}),o("success"),r().catch(I=>{console.warn("Erro ao atualizar contexto:",I)}),setTimeout(()=>o("idle"),3e3)}catch(I){o("error"),n(O(I))}};return e.jsx("div",{className:"space-y-12",children:e.jsxs("form",{onSubmit:$,children:[e.jsx("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6",children:e.jsx("h2",{className:"text-2xl font-bold font-poppins text-white",children:"Editar Perfil"})}),!S.complete&&e.jsxs("div",{className:"mb-8 bg-gray-900 border-l-4 border-yellow-500 p-4 rounded-r-lg shadow-md transition-all",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(je,{className:"w-5 h-5 text-yellow-500 flex-shrink-0"}),e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-gray-300",children:["Seu perfil está incompleto. Preencha os ",e.jsxs("strong",{children:[S.missing.length," itens restantes"]}),"."]})})]}),e.jsx("button",{type:"button",onClick:()=>f(!h),className:"text-xs font-semibold text-primary hover:underline",children:h?"Ocultar":"Ver Pendências"})]}),h&&e.jsx("div",{className:"mt-3 pl-8 animate-fade-in",children:e.jsx("ul",{className:"list-disc text-xs text-gray-400 space-y-1",children:S.missing.map((_,p)=>e.jsx("li",{children:String(_)},p))})})]}),e.jsx(_t,{currentPath:b.foto_capa,bucketName:"artista",userId:s.auth_id,onUploadComplete:P}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 items-start mb-8",children:[e.jsxs("div",{className:"lg:col-span-1 flex flex-col items-center",children:[e.jsx(St,{url:b.foto_url,onUpload:R}),l&&e.jsx("p",{className:"text-sm text-green-400 mt-2 text-center",children:l})]}),e.jsxs("div",{className:"lg:col-span-2 grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"nome",className:"block text-sm font-medium text-gray-300",children:"Nome Artístico / Banda"}),e.jsx("input",{type:"text",id:"nome",value:b.nome,onChange:M,className:"mt-1 input-style"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"telefone",className:"block text-sm font-medium text-gray-300",children:"Telefone (Somente números)"}),e.jsx("input",{type:"tel",id:"telefone",value:b.telefone,onChange:M,className:"mt-1 input-style",placeholder:"(00) 00000-0000"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"cidade",className:"block text-sm font-medium text-gray-300",children:"Cidade"}),e.jsx("input",{type:"text",id:"cidade",value:b.cidade,onChange:M,className:"mt-1 input-style"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"genero_musical",className:"block text-sm font-medium text-gray-300",children:"Gênero Principal"}),e.jsxs("select",{id:"genero_musical",value:b.genero_musical,onChange:M,className:"mt-1 input-style",children:[e.jsx("option",{value:"",children:"Selecione"}),t.map(_=>e.jsx("option",{value:_.nome,children:_.nome},_.id))]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{htmlFor:"descricao",className:"block text-sm font-medium text-gray-300",children:"Sobre (Bio)"}),e.jsx("textarea",{id:"descricao",rows:4,value:b.descricao,onChange:M,className:"mt-1 input-style",placeholder:"Conte sua história..."})]}),e.jsxs("div",{className:"md:col-span-2 space-y-4",children:[e.jsx("h3",{className:"text-lg font-bold text-white flex items-center gap-2",children:"Redes Sociais"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"instagram",className:"block text-sm font-medium text-gray-300",children:"Instagram"}),e.jsx("input",{type:"text",name:"instagram",id:"instagram",value:b.midias_sociais.instagram,onChange:E,className:"mt-1 input-style",placeholder:"@usuario"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"youtube",className:"block text-sm font-medium text-gray-300",children:"YouTube"}),e.jsx("input",{type:"text",name:"youtube",id:"youtube",value:b.midias_sociais.youtube,onChange:E,className:"mt-1 input-style",placeholder:"Canal URL"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"site",className:"block text-sm font-medium text-gray-300",children:"Site / Linktree"}),e.jsx("input",{type:"text",name:"site",id:"site",value:b.midias_sociais.site,onChange:E,className:"mt-1 input-style",placeholder:"https://..."})]})]})]}),e.jsxs("div",{className:"md:col-span-2 bg-gray-900/50 p-6 rounded-2xl border border-gray-700",children:[e.jsxs("h3",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx(Se,{className:"w-5 h-5 text-green-400"})," Dados para Recebimento (PIX)"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Banco"}),e.jsx("input",{type:"text",name:"banco",value:b.dados_bancarios.banco,onChange:y,className:"input-style",placeholder:"Ex: Nubank"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Agência"}),e.jsx("input",{type:"text",name:"agencia",value:b.dados_bancarios.agencia,onChange:y,className:"input-style",placeholder:"0001"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Conta"}),e.jsx("input",{type:"text",name:"conta",value:b.dados_bancarios.conta,onChange:y,className:"input-style",placeholder:"12345-6"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Chave PIX"}),e.jsx("input",{type:"text",name:"chave_pix",value:b.dados_bancarios.chave_pix,onChange:y,className:"input-style",placeholder:"CPF, E-mail, Celular ou Aleatória"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Tipo de Chave"}),e.jsxs("select",{name:"tipo_chave",value:b.dados_bancarios.tipo_chave,onChange:y,className:"input-style",children:[e.jsx("option",{value:"",children:"Selecione"}),e.jsx("option",{value:"cpf",children:"CPF"}),e.jsx("option",{value:"cnpj",children:"CNPJ"}),e.jsx("option",{value:"email",children:"E-mail"}),e.jsx("option",{value:"celular",children:"Celular"}),e.jsx("option",{value:"aleatoria",children:"Chave Aleatória"})]})]})]}),e.jsx("p",{className:"mt-4 text-[10px] text-gray-500 italic",children:"* Estes dados são confidenciais e utilizados exclusivamente para o repasse de seus cachês via plataforma."})]}),e.jsxs("div",{className:"md:col-span-2 bg-gray-900/50 p-6 rounded-2xl border border-gray-700",children:[e.jsxs("h3",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx(we,{className:"w-5 h-5 text-blue-400"})," Disponibilidade Semanal"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:nt.map(_=>{const p=b.disponibilidade[_.key]||{active:!1,start:"18:00",end:"23:00"};return e.jsxs("div",{className:`p-3 rounded-xl border transition-all ${p.active?"bg-gray-800 border-primary/50":"bg-gray-900/30 border-gray-800 opacity-75 hover:opacity-100"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:`text-sm font-bold ${p.active?"text-white":"text-gray-500"}`,children:_.label}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer",checked:p.active,onChange:g=>j(_.key,"active",g.target.checked)}),e.jsx("div",{className:"w-9 h-5 bg-gray-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-primary"})]})]}),p.active&&e.jsxs("div",{className:"flex items-center gap-2 animate-fade-in",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"time",value:p.start,onChange:g=>j(_.key,"start",g.target.value),className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-2 py-1 text-xs text-center text-white focus:border-primary focus:outline-none"})}),e.jsx("span",{className:"text-gray-500 text-xs",children:"até"}),e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"time",value:p.end,onChange:g=>j(_.key,"end",g.target.value),className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-2 py-1 text-xs text-center text-white focus:border-primary focus:outline-none"})})]})]},_.key)})})]}),e.jsxs("div",{className:"bg-gray-900/50 p-6 rounded-2xl border border-gray-700",children:[e.jsxs("h3",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx(Ee,{className:"w-5 h-5 text-primary"})," Rider Técnico (PDF/Imagem)"]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("label",{className:"flex-1 flex flex-col items-center justify-center py-4 border-2 border-dashed border-gray-700 rounded-xl cursor-pointer hover:bg-gray-800 transition-all",children:[e.jsx(ce,{className:`w-6 h-6 mb-2 ${m==="rider"?"animate-bounce":"text-gray-500"}`}),e.jsx("span",{className:"text-xs font-bold text-gray-400",children:b.rider_tecnico_url?"Alterar Rider":"Enviar Rider"}),e.jsx("input",{type:"file",className:"hidden",accept:".pdf,image/*",onChange:_=>D(_,"rider")})]}),b.rider_tecnico_url&&e.jsx("div",{className:"w-12 h-12 bg-green-500/10 rounded-full flex items-center justify-center text-green-500 border border-green-500/30",children:e.jsx(le,{className:"w-6 h-6"})})]})]}),e.jsxs("div",{className:"bg-gray-900/50 p-6 rounded-2xl border border-gray-700",children:[e.jsxs("h3",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx(Me,{className:"w-5 h-5 text-secondary"})," Mapa de Palco"]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("label",{className:"flex-1 flex flex-col items-center justify-center py-4 border-2 border-dashed border-gray-700 rounded-xl cursor-pointer hover:bg-gray-800 transition-all",children:[e.jsx(ce,{className:`w-6 h-6 mb-2 ${m==="mapa"?"animate-bounce":"text-gray-500"}`}),e.jsx("span",{className:"text-xs font-bold text-gray-400",children:b.mapa_palco_url?"Alterar Mapa":"Enviar Mapa"}),e.jsx("input",{type:"file",className:"hidden",accept:".pdf,image/*",onChange:_=>D(_,"mapa")})]}),b.mapa_palco_url&&e.jsx("div",{className:"w-12 h-12 bg-green-500/10 rounded-full flex items-center justify-center text-green-500 border border-green-500/30",children:e.jsx(le,{className:"w-6 h-6"})})]})]})]}),e.jsx("div",{className:"flex justify-end mt-10",children:e.jsxs("button",{type:"submit",disabled:a==="saving",className:"bg-primary text-dark font-black py-4 px-12 rounded-full hover:bg-white transition-all shadow-xl shadow-primary/20 flex items-center gap-2",children:[a==="saving"?"Salvando...":"Salvar Perfil",a==="success"&&e.jsx(le,{className:"w-5 h-5"})]})}),i&&e.jsx("p",{className:"text-red-400 text-right mt-2 text-sm",children:i})]})})},Ve=({className:s})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:s,fill:"currentColor",viewBox:"0 0 24 24",strokeWidth:0,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.75 9.812l-12-6.75A1.125 1.125 0 008.25 4.125v13.5A1.125 1.125 0 009.75 18.75l12-6.75a1.125 1.125 0 000-1.938z"})}),Aa=({isOpen:s,onClose:r,analysis:t})=>{if(!s||!t)return null;const a=t.resultado;return e.jsx("div",{className:"fixed inset-0 bg-black/90 z-50 flex justify-center items-center p-4 backdrop-blur-sm animate-fade-in",children:e.jsxs("div",{className:"bg-gray-900 text-white rounded-2xl shadow-2xl w-full max-w-2xl relative p-0 overflow-hidden border border-gray-800 flex flex-col max-h-[90vh]",children:[e.jsxs("div",{className:"bg-gradient-to-r from-indigo-900 to-gray-900 p-6 border-b border-gray-800 flex justify-between items-center relative overflow-hidden",children:[e.jsxs("div",{className:"relative z-10",children:[e.jsxs("h2",{className:"text-xl font-bold font-poppins flex items-center gap-2",children:[e.jsx(ne,{className:"text-indigo-400 w-6 h-6 animate-pulse"}),"AI Soundcheck: Raio-X Sonoro"]}),e.jsx("p",{className:"text-xs text-indigo-300 mt-1 uppercase font-black tracking-widest",children:"Analisado por Gemini Flash Audio"})]}),e.jsx("button",{onClick:r,className:"text-gray-400 hover:text-white relative z-10",children:e.jsx(Pe,{})}),e.jsx("div",{className:"absolute right-0 top-0 w-32 h-32 bg-indigo-500/10 blur-3xl rounded-full"})]}),e.jsxs("div",{className:"overflow-y-auto p-8 space-y-8",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-gray-850 p-4 rounded-xl border border-gray-800",children:[e.jsx("p",{className:"text-[10px] text-gray-500 uppercase font-black mb-1",children:"Gênero Detectado"}),e.jsx("p",{className:"text-lg font-bold text-white",children:a.genero_sugerido})]}),e.jsxs("div",{className:"bg-gray-850 p-4 rounded-xl border border-gray-800",children:[e.jsx("p",{className:"text-[10px] text-gray-500 uppercase font-black mb-1",children:"Qualidade Técnica"}),e.jsx("p",{className:`text-lg font-bold ${a.qualidade_tecnica==="Excelente"?"text-green-400":"text-yellow-400"}`,children:a.qualidade_tecnica})]}),e.jsxs("div",{className:"bg-gray-850 p-4 rounded-xl border border-gray-800",children:[e.jsx("p",{className:"text-[10px] text-gray-500 uppercase font-black mb-1",children:"Nível de Energia"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-lg font-bold text-white",children:[a.energia,"%"]}),e.jsx("div",{className:"flex-grow h-1.5 bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-primary",style:{width:`${a.energia}%`}})})]})]})]}),e.jsxs("div",{className:"bg-gray-850 p-6 rounded-2xl border border-gray-800",children:[e.jsx("h4",{className:"text-xs font-black text-gray-400 uppercase tracking-widest mb-3",children:"Análise de Timbre"}),e.jsxs("p",{className:"text-gray-200 leading-relaxed italic",children:['"',a.timbre_vocal,'"']})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-black text-gray-400 uppercase tracking-widest mb-4",children:"Sugestões do Produtor IA"}),e.jsx("div",{className:"space-y-3",children:a.sugestoes.map((o,i)=>e.jsxs("div",{className:"flex items-start gap-3 bg-gray-900/50 p-4 rounded-xl border border-gray-800/50 hover:border-indigo-500/30 transition-colors",children:[e.jsx(oe,{className:"w-5 h-5 text-indigo-400 shrink-0 mt-0.5"}),e.jsx("p",{className:"text-sm text-gray-300 leading-relaxed",children:o})]},i))})]})]}),e.jsxs("div",{className:"bg-gray-900 border-t border-gray-800 p-4 flex justify-between items-center text-[10px] text-gray-600 font-bold uppercase tracking-tighter",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(fe,{className:"w-3 h-3"})," Analisado em ",new Date(t.criado_em).toLocaleString()]}),e.jsx("p",{children:"RESONA Audio Intelligence v1.2"})]})]})})},Dt=({profile:s,onUpdate:r})=>{var ee,te;const[t,a]=c.useState("photos"),[o,i]=c.useState([]),[n,l]=c.useState([]),[d,h]=c.useState([]),[f,m]=c.useState([]),[u,S]=c.useState([]),[b,w]=c.useState([]),[D,M]=c.useState(!1),[E,y]=c.useState(null),[j,R]=c.useState(null),[P,$]=c.useState(!1),[_,p]=c.useState(!0),[g,x]=c.useState(""),[C,k]=c.useState(""),[I,J]=c.useState(null),V=s.tipo==="artista",A=V?"artista":"estabelecimento",z=s.plano==="free",W={photos:5,videos:1,audios:1},q=t==="photos"?o:t==="videos"?d:u,Q=t==="photos"?n:t==="videos"?f:b,N=W[t],B=z&&q.length>=N,X=c.useCallback(()=>{var L,U,v,F,H;return V?{photos:((L=s.artista)==null?void 0:L.galeria_fotos)||[],videos:((U=s.artista)==null?void 0:U.galeria_videos)||[],audios:((v=s.artista)==null?void 0:v.galeria_audios)||[]}:{photos:((F=s.estabelecimento)==null?void 0:F.galeria_fotos)||[],videos:((H=s.estabelecimento)==null?void 0:H.galeria_videos)||[],audios:[]}},[V,s]);c.useEffect(()=>{(async()=>{p(!0),x("");const U=Date.now(),v=X();try{const[F,H,ae]=await Promise.all([v.photos.length>0?Z.getSignedUrls(A,v.photos,3600).catch(()=>[]):Promise.resolve([]),v.videos.length>0?Z.getSignedUrls(A,v.videos,3600).catch(()=>[]):Promise.resolve([]),V&&v.audios.length>0?Z.getSignedUrls(A,v.audios,3600).catch(()=>[]):Promise.resolve([])]);i(v.photos),l(F.map(me=>`${me}&t=${U}`)),h(v.videos),m(H),V&&(S(v.audios),w(ae))}catch(F){console.error("Erro no carregamento da galeria:",F),x("Ocorreu um problema ao carregar alguns arquivos.")}finally{p(!1)}})()},[s.id,(ee=s.artista)==null?void 0:ee.galeria_fotos,(te=s.estabelecimento)==null?void 0:te.galeria_fotos,A,V,X]),c.useEffect(()=>{if(C||g){const L=setTimeout(()=>{k(""),x("")},5e3);return()=>clearTimeout(L)}},[C,g]);const G=async L=>{if(!L.target.files||L.target.files.length===0)return;if(B){x(`Limite do plano Free atingido para ${t==="photos"?"fotos":"mídia"}.`);return}$(!0),x("");const U=Array.from(L.target.files);if(z&&q.length+U.length>N){x(`Limite excedido. O máximo é de ${N} itens.`),$(!1);return}let v="portfolio",F=t==="photos"?"galeria_fotos":t==="videos"?"galeria_videos":"galeria_audios";t==="videos"?v="portfolio/videos":t==="audios"&&(v="portfolio/audios");try{const H=[];for(const ae of U){k(`Enviando: ${ae.name}...`);const me=ae.name.split(".").pop(),ke=`${s.auth_id}/${v}/p_${Date.now()}_${Math.random().toString(36).substring(7)}.${me}`;try{const xe=await Z.upload(A,ke,ae);H.push(xe)}catch(xe){console.error(`Falha ao subir arquivo ${ae.name}:`,xe)}}if(H.length>0){const ae=[...q,...H];V?await K.updateArtist(s.id,null,{[F]:ae}):await K.updateVenue(s.id,null,{[F]:ae}),k(`${H.length} arquivo(s) enviados!`),r()}else throw new Error("Nenhum arquivo pôde ser enviado. Verifique sua conexão.")}catch(H){x(O(H))}finally{$(!1),L.target.value=""}},T=async L=>{J(L);let U=t==="photos"?"galeria_fotos":t==="videos"?"galeria_videos":"galeria_audios";try{await Z.remove(A,[L]);const v=q.filter(F=>F!==L);V?await K.updateArtist(s.id,null,{[U]:v}):await K.updateVenue(s.id,null,{[U]:v}),k("Item removido."),r()}catch(v){x(`Erro ao remover: ${O(v)}`)}finally{J(null)}},se=async(L,U)=>{R(L);try{const v=await zt.analyzeAudio(s.id,L,U);y(v),M(!0)}catch(v){alert("Erro na análise: "+O(v))}finally{R(null)}};return e.jsxs("div",{className:"animate-fade-in",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4",children:[e.jsx("h2",{className:"text-2xl font-bold font-poppins text-white",children:"Gerenciar Portfólio"}),z&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-gray-900 border border-gray-700 px-4 py-2 rounded-full shadow-inner",children:[e.jsx("span",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest",children:"Cota:"}),e.jsxs("span",{className:`text-sm font-black font-mono ${B?"text-red-400":"text-primary"}`,children:[q.length,"/",N]})]}),e.jsxs(re,{to:"/planos",className:"flex items-center gap-2 bg-primary/10 hover:bg-primary text-primary hover:text-dark px-4 py-2 rounded-full text-xs font-bold transition-all border border-primary/30",children:[e.jsx(ne,{className:"w-3 h-3"})," Upgrade Pro"]})]})]}),e.jsxs("div",{className:"flex space-x-2 mb-6 bg-gray-800 p-1 rounded-lg w-fit overflow-x-auto scrollbar-hide",children:[e.jsxs("button",{onClick:()=>a("photos"),className:`py-2 px-6 font-bold text-sm rounded-md transition-all flex items-center gap-2 ${t==="photos"?"bg-gray-700 text-white shadow-sm":"text-gray-400 hover:text-white hover:bg-gray-700/50"}`,children:[e.jsx(Ce,{className:"w-4 h-4"})," Fotos"]}),e.jsxs("button",{onClick:()=>a("videos"),className:`py-2 px-6 font-bold text-sm rounded-md transition-all flex items-center gap-2 ${t==="videos"?"bg-gray-700 text-white shadow-sm":"text-gray-400 hover:text-white hover:bg-gray-700/50"}`,children:[e.jsx(Ve,{className:"w-4 h-4"})," Vídeos"]}),V&&e.jsxs("button",{onClick:()=>a("audios"),className:`py-2 px-6 font-bold text-sm rounded-md transition-all flex items-center gap-2 ${t==="audios"?"bg-gray-700 text-white shadow-sm":"text-gray-400 hover:text-white hover:bg-gray-700/50"}`,children:[e.jsx(Te,{className:"w-4 h-4"})," Áudios"]})]}),e.jsx("div",{className:"bg-gray-800 rounded-xl p-6 min-h-[350px] border border-gray-700 shadow-lg relative",children:_?e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-gray-800/50 backdrop-blur-sm rounded-xl z-20",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mb-4"}),e.jsx("p",{className:"text-gray-400 font-medium",children:"Sincronizando arquivos..."})]}):e.jsxs(e.Fragment,{children:[C&&e.jsx("div",{className:"mb-4 p-3 rounded-md text-center text-sm bg-green-500/20 text-green-300 border border-green-500/30 animate-fade-in",children:C}),g&&e.jsx("div",{className:"mb-4 p-3 rounded-md text-center text-sm bg-red-500/20 text-red-400 border border-red-500/30 animate-shake",children:g}),e.jsxs("div",{className:`grid gap-6 mb-6 ${t==="audios"?"grid-cols-1":"grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5"}`,children:[!B&&e.jsxs("label",{className:`relative group rounded-2xl overflow-hidden ${t==="audios"?"h-24":"aspect-square"} bg-gray-900 border-2 border-dashed border-gray-600 hover:border-primary transition-all cursor-pointer flex flex-col items-center justify-center ${P?"opacity-50":""} shadow-inner`,children:[e.jsx("div",{className:"p-3 bg-gray-800 rounded-full group-hover:bg-primary/20 mb-2 transition-colors border border-gray-700 group-hover:border-primary/50",children:e.jsx(ce,{className:"w-6 h-6 text-gray-500 group-hover:text-primary"})}),e.jsx("span",{className:"text-[10px] uppercase font-black text-gray-500 group-hover:text-white tracking-widest transition-colors",children:P?"Aguarde":"Adicionar"}),e.jsx("input",{type:"file",multiple:t==="photos",className:"hidden",onChange:G,disabled:P,accept:t==="photos"?"image/*":t==="videos"?"video/*":"audio/*"})]}),Q.map((L,U)=>{const v=q[U],F=I===v,H=j===v;return e.jsxs("div",{className:`relative group rounded-2xl overflow-hidden ${t==="audios"?"h-24 bg-gray-900 p-4 border border-gray-700 flex items-center gap-4":"aspect-square bg-black border border-gray-700"} shadow-md hover:shadow-2xl hover:border-gray-500 transition-all`,children:[t==="photos"?e.jsx("img",{src:L,alt:"Portfolio",className:`w-full h-full object-cover ${F?"opacity-50":""}`}):t==="videos"?e.jsxs("div",{className:"w-full h-full flex items-center justify-center bg-gray-950",children:[e.jsx(Ve,{className:"w-8 h-8 text-white opacity-50"}),e.jsx("video",{src:L,className:`absolute inset-0 w-full h-full object-cover ${F?"opacity-50":""}`})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center border border-primary/20 shrink-0",children:e.jsx(Te,{className:"w-5 h-5 text-primary"})}),e.jsx("audio",{src:L,controls:!0,className:"w-full h-8 custom-audio-player"}),e.jsxs("button",{onClick:()=>se(v,L),disabled:H,className:"shrink-0 bg-indigo-600 hover:bg-indigo-500 text-white p-2 rounded-lg transition-colors flex items-center gap-2 group/ai",children:[H?e.jsx("span",{className:"animate-spin text-xs",children:"⚡"}):e.jsx(ne,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline text-[10px] font-black uppercase",children:"Soundcheck"})]})]}),e.jsx("div",{className:`absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center ${t==="audios"?"hidden":""}`,children:e.jsx("button",{onClick:()=>T(v),className:`p-2.5 bg-red-600 hover:bg-red-700 text-white rounded-xl transition-all transform hover:scale-110 shadow-lg ${F?"pointer-events-none":""}`,children:F?e.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):e.jsx(ge,{className:"w-5 h-5"})})}),t==="audios"&&e.jsx("button",{onClick:()=>T(v),className:"p-2 text-gray-500 hover:text-red-500 transition-colors",children:e.jsx(ge,{className:"w-5 h-5"})})]},v||U)})]}),q.length===0&&!P&&e.jsx("div",{className:"py-20",children:e.jsx(Ae,{icon:t==="photos"?Ce:t==="videos"?Ve:Te,title:`Galeria de ${t==="photos"?"fotos":t==="videos"?"vídeos":"áudios"} vazia`,description:"Destaque seus melhores momentos para atrair novas oportunidades."})})]})}),e.jsx(Aa,{isOpen:D,onClose:()=>M(!1),analysis:E}),e.jsx("style",{children:`
                .custom-audio-player::-webkit-media-controls-enclosure { background-color: transparent; }
                .custom-audio-player::-webkit-media-controls-panel { filter: invert(1); }
            `})]})},Ra=({profile:s,onUpdate:r})=>{var _;const[t,a]=c.useState([]),[o,i]=c.useState(!0),[n,l]=c.useState(""),[d,h]=c.useState(""),[f,m]=c.useState(""),[u,S]=c.useState(""),[b,w]=c.useState(!1),[D,M]=c.useState(!1),[E,y]=c.useState(null),j=(_=s.artista)==null?void 0:_.id;c.useEffect(()=>{(async()=>{if(!j){i(!1);return}i(!0);try{const g=await Ie.list(j);a(g)}catch(g){l("Falha ao carregar os membros da banda: "+O(g))}finally{i(!1)}})()},[j]),c.useEffect(()=>{if(d||n){const p=setTimeout(()=>{h(""),l("")},5e3);return()=>clearTimeout(p)}},[d,n]);const R=async p=>{if(p.preventDefault(),!(!f||!u||!j)){w(!0),h("Adicionando membro...");try{const g=await Ie.add(j,f,u);a(x=>[...x,g]),m(""),S(""),h("Membro adicionado com sucesso!"),r()}catch(g){l("Erro ao adicionar membro: "+O(g))}finally{w(!1)}}},P=p=>{y(p),M(!0)},$=async()=>{if(E){w(!0);try{await Ie.remove(E.id),a(p=>p.filter(g=>g.id!==E.id)),h("Membro removido com sucesso."),r()}catch(p){l("Erro ao remover membro: "+O(p))}finally{w(!1),M(!1),y(null)}}};return e.jsxs("div",{className:"animate-fade-in",children:[e.jsx("h2",{className:"text-2xl font-bold font-poppins text-white mb-6",children:"Integrantes da Banda"}),e.jsxs("div",{className:"bg-gray-800 rounded-xl border border-gray-700 p-6 mb-8 shadow-lg",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-400 uppercase mb-4",children:"Adicionar Novo Integrante"}),e.jsxs("form",{onSubmit:R,className:"grid grid-cols-1 md:grid-cols-12 gap-4 items-end",children:[e.jsxs("div",{className:"md:col-span-5",children:[e.jsx("label",{htmlFor:"memberName",className:"block text-xs font-medium text-gray-500 mb-1",children:"Nome"}),e.jsx("input",{type:"text",id:"memberName",value:f,onChange:p=>m(p.target.value),required:!0,className:"w-full bg-gray-900 border border-gray-600 rounded-lg p-3 text-white focus:outline-none focus:ring-2 focus:ring-secondary focus:border-transparent transition-all",placeholder:"Ex: João Silva"})]}),e.jsxs("div",{className:"md:col-span-5",children:[e.jsx("label",{htmlFor:"memberInstrument",className:"block text-xs font-medium text-gray-500 mb-1",children:"Função / Instrumento"}),e.jsx("input",{type:"text",id:"memberInstrument",value:u,onChange:p=>S(p.target.value),required:!0,className:"w-full bg-gray-900 border border-gray-600 rounded-lg p-3 text-white focus:outline-none focus:ring-2 focus:ring-secondary focus:border-transparent transition-all",placeholder:"Ex: Guitarra Solo"})]}),e.jsx("div",{className:"md:col-span-2",children:e.jsxs("button",{type:"submit",disabled:b,className:"w-full flex justify-center items-center gap-2 bg-secondary text-white font-bold py-3 px-4 rounded-lg hover:bg-opacity-90 disabled:opacity-50 transition-all shadow-lg shadow-secondary/20 h-[50px]",children:[e.jsx(ft,{className:"w-5 h-5"}),e.jsx("span",{className:"hidden md:inline",children:"Add"}),e.jsx("span",{className:"md:hidden",children:"Adicionar"})]})})]})]}),d&&e.jsx("div",{className:"p-3 mb-6 rounded-lg bg-green-500/10 border border-green-500/20 text-green-400 text-center text-sm",children:d}),n&&e.jsx("div",{className:"p-3 mb-6 rounded-lg bg-red-500/10 border border-red-500/20 text-red-400 text-center text-sm",children:n}),o?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-2"}),"Carregando membros..."]}):e.jsx("div",{className:"space-y-3",children:t.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.map(p=>e.jsxs("div",{className:"bg-gray-800 p-4 rounded-xl border border-gray-700 flex justify-between items-center group hover:border-primary/50 transition-colors shadow-sm hover:shadow-md",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-700 flex items-center justify-center text-gray-400 font-bold text-lg border border-gray-600 group-hover:border-primary/50 group-hover:text-primary transition-colors",children:p.nome.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-white text-lg",children:p.nome}),e.jsx("p",{className:"text-sm text-gray-400",children:p.instrumento})]})]}),e.jsx("button",{onClick:()=>P(p),className:"text-gray-500 hover:text-red-500 p-2 rounded-full hover:bg-red-500/10 transition-colors",title:"Remover integrante",children:e.jsx(ge,{className:"w-5 h-5"})})]},p.id))}):e.jsx(Ae,{icon:bt,title:"Banda Solo?",description:"Você ainda não adicionou nenhum integrante. Adicione músicos, técnicos ou roadies para completar seu perfil."})}),e.jsx(Wt,{isOpen:D,onClose:()=>M(!1),onConfirm:$,title:"Confirmar Remoção",message:e.jsxs("p",{children:["Tem certeza que deseja remover o integrante ",e.jsx("strong",{className:"text-white",children:E==null?void 0:E.nome}),"?"]}),confirmText:"Sim, Remover",isConfirming:b})]})},Ge=({profile:s,onUpdate:r})=>{const[t,a]=c.useState(!1),[o,i]=c.useState(""),[n,l]=c.useState(!1),d=s.status_verificacao;s.tipo;const h=async f=>{if(!f.target.files||f.target.files.length===0)return;const m=f.target.files[0];if(m.size>5*1024*1024){i("O arquivo deve ter no máximo 5MB.");return}a(!0),i(""),l(!1);try{const u=m.name.split(".").pop(),S=`${s.auth_id}/kyc/documento_${Date.now()}.${u}`,b=await Z.upload("site",S,m);await K.submitKyc(s.id,b),l(!0),r()}catch(u){i(O(u))}finally{a(!1)}};return e.jsxs("div",{className:"bg-gray-850 p-6 rounded-2xl border border-gray-700 shadow-inner",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("div",{className:`p-3 rounded-full ${d==="verificado"?"bg-green-500/20 text-green-400":d==="pendente"?"bg-yellow-500/20 text-yellow-400":"bg-primary/20 text-primary"}`,children:e.jsx(Ze,{className:"w-8 h-8"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white font-poppins",children:"Verificação de Identidade"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Aumente sua credibilidade e segurança na rede."})]})]}),e.jsxs("div",{className:"space-y-6",children:[d==="verificado"?e.jsxs("div",{className:"bg-green-500/10 border border-green-500/30 p-4 rounded-xl flex items-start gap-3",children:[e.jsx(oe,{className:"w-5 h-5 text-green-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-green-300 font-bold",children:"Perfil Verificado"}),e.jsx("p",{className:"text-xs text-green-300/70 mt-1",children:"Sua identidade foi confirmada. O selo azul agora aparece ao lado do seu nome em buscas e no perfil público."})]})]}):d==="pendente"?e.jsxs("div",{className:"bg-yellow-500/10 border border-yellow-500/30 p-4 rounded-xl flex items-start gap-3",children:[e.jsx(fe,{className:"w-5 h-5 text-yellow-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-yellow-300 font-bold",children:"Análise em Andamento"}),e.jsx("p",{className:"text-xs text-yellow-300/70 mt-1",children:"Já recebemos seu documento. Nossa equipe revisará os dados em até 48 horas úteis."})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-xl border border-gray-800",children:[e.jsx("h4",{className:"text-sm font-bold text-gray-300 mb-2",children:"Por que verificar?"}),e.jsxs("ul",{className:"text-xs text-gray-500 space-y-2",children:[e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(oe,{className:"w-3 h-3 text-primary"})," Selo de confiança no perfil público"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(oe,{className:"w-3 h-3 text-primary"})," Maior prioridade em recomendações de contratantes"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(oe,{className:"w-3 h-3 text-primary"})," Desbloqueio de saques acima de R$ 5.000,00"]})]})]}),d==="rejeitado"&&e.jsxs("div",{className:"bg-red-500/10 border border-red-500/30 p-4 rounded-xl flex items-start gap-3",children:[e.jsx(Ht,{className:"w-5 h-5 text-red-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-red-300 font-bold",children:"Verificação Reprovada"}),e.jsx("p",{className:"text-xs text-red-300/70 mt-1",children:"Houve um problema com o documento anterior. Por favor, envie uma nova foto nítida do seu RG, CNH ou Cartão CNPJ."})]})]}),e.jsx("div",{className:"relative",children:e.jsxs("label",{className:`w-full flex flex-col items-center justify-center py-8 border-2 border-dashed border-gray-700 rounded-2xl cursor-pointer hover:bg-primary/5 hover:border-primary transition-all ${t?"opacity-50 pointer-events-none":""}`,children:[e.jsx(ce,{className:"w-10 h-10 text-gray-500 mb-2"}),e.jsx("span",{className:"text-sm font-bold text-gray-300",children:t?"Enviando documento...":"Enviar Foto do Documento"}),e.jsx("span",{className:"text-[10px] text-gray-500 mt-1",children:"Formatos: JPG, PNG ou PDF (Máx 5MB)"}),e.jsx("input",{type:"file",className:"hidden",accept:"image/*,.pdf",onChange:h})]})})]}),o&&e.jsx("p",{className:"text-xs text-red-400 text-center",children:o}),n&&e.jsx("p",{className:"text-xs text-green-400 text-center",children:"Documento enviado com sucesso!"})]})]})},Pa=({profile:s,onUpdate:r,initialTab:t})=>{const[a,o]=c.useState("dados");return c.useEffect(()=>{t&&["dados","portfolio","banda","verificacao"].includes(t)&&o(t)},[t]),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap gap-2 border-b border-gray-700 pb-2",children:[e.jsxs("button",{onClick:()=>o("dados"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-bold transition-all ${a==="dados"?"bg-primary text-dark":"text-gray-400 hover:bg-gray-800"}`,children:[e.jsx(de,{className:"w-4 h-4"})," Dados Básicos"]}),e.jsxs("button",{onClick:()=>o("portfolio"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-bold transition-all ${a==="portfolio"?"bg-primary text-dark":"text-gray-400 hover:bg-gray-800"}`,children:[e.jsx(Ce,{className:"w-4 h-4"})," Portfólio"]}),e.jsxs("button",{onClick:()=>o("banda"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-bold transition-all ${a==="banda"?"bg-primary text-dark":"text-gray-400 hover:bg-gray-800"}`,children:[e.jsx(bt,{className:"w-4 h-4"})," Banda"]}),e.jsxs("button",{onClick:()=>o("verificacao"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-bold transition-all ${a==="verificacao"?"bg-primary text-dark":"text-gray-400 hover:bg-gray-800"}`,children:[e.jsx(Ze,{className:"w-4 h-4"})," Verificação"]})]}),e.jsxs("div",{className:"animate-fade-in min-h-[500px]",children:[a==="dados"&&e.jsx(Ea,{initialProfile:s,onProfileUpdate:r}),a==="portfolio"&&e.jsx(Dt,{profile:s,onUpdate:r}),a==="banda"&&e.jsx(Ra,{profile:s,onUpdate:r}),a==="verificacao"&&e.jsx(Ge,{profile:s,onUpdate:r})]})]})},lt={viewsLast30Days:[12,18,15,25,32,28,45,38,42,58,65,60,72,85,90,88,110,105,95,120,135,128],geoDistribution:[{city:"São Paulo, SP",count:450,percentage:45},{city:"Campinas, SP",count:120,percentage:12},{city:"Curitiba, PR",count:90,percentage:9},{city:"Rio de Janeiro, RJ",count:85,percentage:8},{city:"Santos, SP",count:55,percentage:5}]},Ma=({data:s,color:r})=>{const t=Math.max(...s),a=s.map((o,i)=>`${i/(s.length-1)*100},${100-o/t*100}`).join(" ");return e.jsx("svg",{viewBox:"0 0 100 100",className:"w-full h-24 overflow-visible",preserveAspectRatio:"none",children:e.jsx("polyline",{points:a,fill:"none",stroke:r,strokeWidth:"3",vectorEffect:"non-scaling-stroke",strokeLinecap:"round",strokeLinejoin:"round"})})},Et=({profile:s})=>{const r=s.plano==="free";return s.tipo,e.jsxs("div",{className:"relative animate-fade-in",children:[e.jsx("div",{className:"flex justify-between items-center mb-8",children:e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold font-poppins text-white flex items-center gap-2",children:[e.jsx(Ne,{className:"text-primary w-7 h-7"}),"Market Intelligence"]}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Dados detalhados sobre o alcance do seu perfil."})]})}),r&&e.jsxs("div",{className:"absolute inset-0 z-20 bg-gray-900/60 backdrop-blur-md rounded-2xl flex flex-col items-center justify-center text-center p-8 border border-primary/20",children:[e.jsx("div",{className:"w-20 h-20 bg-primary/10 rounded-full flex items-center justify-center mb-6 border border-primary/20 animate-bounce-slow",children:e.jsx(We,{className:"w-10 h-10 text-primary"})}),e.jsx("h3",{className:"text-2xl font-black text-white mb-2",children:"Desbloqueie sua Inteligência"}),e.jsx("p",{className:"text-gray-300 max-w-md mb-8",children:"Assinantes PRO e Business têm acesso a gráficos de conversão, origem dos visitantes e tendências de mercado."}),e.jsxs(re,{to:"/planos",className:"bg-primary text-dark font-black py-4 px-12 rounded-full hover:bg-white transition-all shadow-xl shadow-primary/20 flex items-center gap-2",children:[e.jsx(ne,{className:"w-5 h-5"}),"Fazer Upgrade Agora"]})]}),e.jsxs("div",{className:`grid grid-cols-1 lg:grid-cols-3 gap-6 ${r?"opacity-40 grayscale pointer-events-none":""}`,children:[e.jsxs("div",{className:"lg:col-span-2 bg-gray-850 p-6 rounded-2xl border border-gray-700 shadow-inner",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-[10px] font-black uppercase tracking-widest mb-1",children:"Visualizações de Perfil"}),e.jsx("h4",{className:"text-3xl font-black text-white font-mono",children:"1.284"})]}),e.jsx("span",{className:"bg-green-500/10 text-green-400 text-xs font-bold px-2 py-1 rounded",children:"+14% vs anterior"})]}),e.jsx("div",{className:"h-32 w-full",children:e.jsx(Ma,{data:lt.viewsLast30Days,color:"#51D2EE"})}),e.jsxs("div",{className:"flex justify-between mt-4 text-[10px] text-gray-600 font-bold uppercase tracking-tighter",children:[e.jsx("span",{children:"30 dias atrás"}),e.jsx("span",{children:"Hoje"})]})]}),e.jsxs("div",{className:"bg-gray-850 p-6 rounded-2xl border border-gray-700 shadow-inner",children:[e.jsx("p",{className:"text-gray-500 text-[10px] font-black uppercase tracking-widest mb-6",children:"Funil de Conversão"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[e.jsx("span",{className:"text-gray-400 font-bold",children:"Alcance"}),e.jsx("span",{className:"text-white",children:"100%"})]}),e.jsx("div",{className:"h-2 bg-gray-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-500 w-full"})})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[e.jsx("span",{className:"text-gray-400 font-bold",children:"Interesse (Cliques)"}),e.jsx("span",{className:"text-white",children:"32%"})]}),e.jsx("div",{className:"h-2 bg-gray-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-purple-500 w-[32%]"})})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[e.jsx("span",{className:"text-gray-400 font-bold",children:"Propostas"}),e.jsx("span",{className:"text-primary font-black",children:"8.4%"})]}),e.jsx("div",{className:"h-2 bg-gray-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-primary w-[8.4%]"})})]})]}),e.jsx("div",{className:"mt-8 pt-6 border-t border-gray-800",children:e.jsxs("p",{className:"text-[10px] text-gray-500 leading-relaxed",children:["💡 ",e.jsx("strong",{children:"Dica RESONA:"})," Perfil com vídeos de alta qualidade convertem até 45% mais visitantes em propostas."]})})]}),e.jsxs("div",{className:"bg-gray-850 p-6 rounded-2xl border border-gray-700 shadow-inner lg:col-span-1",children:[e.jsx("p",{className:"text-gray-500 text-[10px] font-black uppercase tracking-widest mb-4",children:"Visitantes por Localidade"}),e.jsx("div",{className:"space-y-4",children:lt.geoDistribution.map((t,a)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Me,{className:"w-3 h-3 text-gray-600"}),e.jsx("span",{className:"text-xs text-gray-300 truncate w-32",children:t.city})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-20 h-1.5 bg-gray-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gray-600",style:{width:`${t.percentage}%`}})}),e.jsxs("span",{className:"text-[10px] font-mono text-gray-500 w-8",children:[t.percentage,"%"]})]})]},a))})]}),e.jsxs("div",{className:"lg:col-span-2 bg-gray-850 p-6 rounded-2xl border border-gray-700 shadow-inner overflow-hidden relative",children:[e.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-5",children:e.jsx(Ne,{className:"w-32 h-32 text-primary"})}),e.jsx("p",{className:"text-gray-500 text-[10px] font-black uppercase tracking-widest mb-6",children:"Performance Financeira (Estimado Anual)"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"p-4 bg-gray-900/50 rounded-xl border border-gray-800",children:[e.jsx("p",{className:"text-gray-500 text-[9px] font-bold uppercase mb-1",children:"Total Faturado"}),e.jsx("p",{className:"text-xl font-black text-white font-mono",children:"R$ 42.5k"})]}),e.jsxs("div",{className:"p-4 bg-gray-900/50 rounded-xl border border-gray-800",children:[e.jsx("p",{className:"text-gray-500 text-[9px] font-bold uppercase mb-1",children:"Ticket Médio"}),e.jsx("p",{className:"text-xl font-black text-primary font-mono",children:"R$ 850"})]}),e.jsxs("div",{className:"p-4 bg-gray-900/50 rounded-xl border border-gray-800",children:[e.jsx("p",{className:"text-gray-500 text-[9px] font-bold uppercase mb-1",children:"Crescimento YoY"}),e.jsx("p",{className:"text-xl font-black text-green-400 font-mono",children:"+28%"})]})]})]})]})]})},za=({profile:s,initialTab:r})=>{const[t,a]=c.useState("analytics");return c.useEffect(()=>{r&&["analytics","avaliacoes"].includes(r)&&a(r)},[r]),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap gap-2 border-b border-gray-700 pb-2",children:[e.jsxs("button",{onClick:()=>a("analytics"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-bold transition-all ${t==="analytics"?"bg-primary text-dark":"text-gray-400 hover:bg-gray-800"}`,children:[e.jsx(Ne,{className:"w-4 h-4"})," Analytics"]}),e.jsxs("button",{onClick:()=>a("avaliacoes"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-bold transition-all ${t==="avaliacoes"?"bg-primary text-dark":"text-gray-400 hover:bg-gray-800"}`,children:[e.jsx(ie,{className:"w-4 h-4"})," Avaliações"]})]}),e.jsxs("div",{className:"animate-fade-in",children:[t==="analytics"&&e.jsx(Et,{profile:s}),t==="avaliacoes"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h3",{className:"text-xl font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx(ie,{className:"w-6 h-6 text-yellow-400"}),"Minha Reputação"]}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Veja o que os estabelecimentos estão dizendo sobre seus shows."}),e.jsx(gt,{targetId:s.id})]})]})]})},Ia=({className:s="w-6 h-6"})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:s,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})}),$a=()=>e.jsxs("div",{className:"flex items-center p-4 animate-pulse",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-700"}),e.jsxs("div",{className:"ml-4 flex-grow",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"h-4 bg-gray-700 rounded w-1/2"}),e.jsx("div",{className:"h-3 bg-gray-700 rounded w-1/4"})]}),e.jsx("div",{className:"h-3 bg-gray-700 rounded w-3/4 mt-2"})]})]}),At=({currentUser:s})=>{const[r,t]=c.useState([]),[a,o]=c.useState(null),[i,n]=c.useState([]),[l,d]=c.useState(""),[h,f]=c.useState(!0),[m,u]=c.useState(!1),[S,b]=c.useState(!1),[w,D]=c.useState(""),M=c.useRef(null),E=()=>{var x;(x=M.current)==null||x.scrollIntoView({behavior:"smooth"})};c.useEffect(()=>{i.length>0&&E()},[i]);const y=c.useCallback(async()=>{f(!0);try{const C=(await $e.getConversations(s.id)).map(k=>({id:k.id,nome_participante:k.nome_participante,foto_participante:k.foto_participante,ultima_mensagem:k.ultima_mensagem||"Nenhuma mensagem ainda.",timestamp_ultima_mensagem:k.timestamp_ultima_mensagem?new Date(k.timestamp_ultima_mensagem).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"}):"",other_participant_id:k.other_participant_id}));t(C)}catch(x){console.error("Error fetching conversations via API:",x.message)}finally{f(!1)}},[s.id]);c.useEffect(()=>{y()},[y]),c.useEffect(()=>{if(!(s!=null&&s.id))return;const x=ve.channel(`notificacoes:${s.id}`);return x.on("postgres_changes",{event:"INSERT",schema:"public",table:"notificacoes",filter:`usuario_id=eq.${s.id}`},C=>{C.new.tipo==="mensagem"&&y()}).subscribe(),()=>{ve.removeChannel(x)}},[s,y]),c.useEffect(()=>{if(!a)return;(async()=>{u(!0);try{const k=await $e.getMessages(a.id);n(k)}catch(k){console.error("Error fetching messages:",k)}finally{u(!1),setTimeout(E,100)}})();const C=ve.channel(`conversa-${a.id}`);return C.on("postgres_changes",{event:"INSERT",schema:"public",table:"mensagens",filter:`conversa_id=eq.${a.id}`},k=>{n(I=>[...I,k.new])}).subscribe(),()=>{ve.removeChannel(C)}},[a]);const j=async x=>{if(x.preventDefault(),!(!l.trim()||!a)){b(!0);try{await $e.sendMessage(a.id,s.id,l),d(""),y(),await It.create({usuario_id:a.other_participant_id,tipo:"mensagem",titulo:`Nova mensagem de ${s.nome}`,descricao:l.substring(0,50)+(l.length>50?"...":""),url_destino:"/painel?open=mensagens"})}catch(C){console.error("Error sending message or notification:",C)}finally{b(!1),setTimeout(E,100)}}},R=x=>{if(!x)return null;const{data:C}=ve.storage.from("perfis").getPublicUrl(x);return C.publicUrl},P=r.filter(x=>x.nome_participante.toLowerCase().includes(w.toLowerCase())),$=()=>{o(null)},_=x=>{const C={};return x.forEach(k=>{const I=new Date(k.criado_em).toISOString().split("T")[0];C[I]||(C[I]=[]),C[I].push(k)}),C},p=x=>{const C=new Date(x+"T00:00:00"),k=new Date,I=new Date(k);return I.setDate(I.getDate()-1),C.toDateString()===k.toDateString()?"Hoje":C.toDateString()===I.toDateString()?"Ontem":C.toLocaleDateString("pt-BR",{weekday:"long",day:"numeric",month:"long"})},g=_(i);return e.jsxs("div",{className:"flex flex-col h-full animate-fade-in",children:[e.jsx("h2",{className:"text-2xl font-bold font-poppins text-white mb-6",children:"Mensagens"}),e.jsxs("div",{className:"flex flex-grow h-[calc(100vh-220px)] min-h-[500px] bg-gray-900 rounded-xl overflow-hidden border border-gray-700 shadow-xl",children:[e.jsxs("div",{className:`w-full md:w-1/3 lg:w-80 border-r border-gray-700 flex flex-col bg-gray-850 ${a?"hidden md:flex":"flex"}`,children:[e.jsx("div",{className:"p-4 border-b border-gray-700 shrink-0 bg-gray-900",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"Buscar conversas...",className:"w-full bg-gray-800 border border-gray-700 rounded-lg py-2.5 pl-10 pr-4 focus:outline-none focus:ring-2 focus:ring-primary text-white text-sm",value:w,onChange:x=>D(x.target.value)}),e.jsx(Zt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"})]})}),e.jsx("div",{className:"flex-grow overflow-y-auto custom-scrollbar bg-gray-850",children:h?e.jsx("div",{children:Array.from({length:5}).map((x,C)=>e.jsx($a,{},C))}):P.length>0?P.map(x=>{const C=R(x.foto_participante),k=(a==null?void 0:a.id)===x.id;return e.jsxs("div",{onClick:()=>o(x),className:`relative flex items-center p-4 cursor-pointer transition-all border-b border-gray-800 last:border-0 ${k?"bg-gray-800 border-l-4 border-l-primary":"hover:bg-gray-800 border-l-4 border-l-transparent"}`,children:[e.jsx("div",{className:"relative flex-shrink-0",children:C?e.jsx("img",{src:C,alt:x.nome_participante,className:"w-12 h-12 rounded-full object-cover ring-2 ring-gray-700"}):e.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-700 flex items-center justify-center",children:e.jsx(de,{className:"w-8 h-8 text-gray-500"})})}),e.jsxs("div",{className:"ml-4 flex-grow overflow-hidden",children:[e.jsxs("div",{className:"flex justify-between items-baseline",children:[e.jsx("h3",{className:`font-bold truncate text-sm ${k?"text-white":"text-gray-200"}`,children:x.nome_participante}),e.jsx("span",{className:"text-[10px] text-gray-500 flex-shrink-0 ml-2",children:x.timestamp_ultima_mensagem})]}),e.jsx("p",{className:`text-xs truncate mt-1 ${k?"text-gray-300":"text-gray-500"}`,children:x.ultima_mensagem})]})]},x.id)}):e.jsx("div",{className:"h-full p-4 flex items-center justify-center",children:e.jsx(Ae,{icon:ue,title:"Nenhuma conversa",description:"Inicie um bate-papo com outros usuários através do perfil deles."})})})]}),e.jsx("div",{className:"flex flex-col h-full relative",children:a?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex items-center bg-gray-900/95 backdrop-blur shadow-md shrink-0 z-10",children:[e.jsx("button",{onClick:$,className:"md:hidden mr-3 text-gray-400 hover:text-white p-1",children:e.jsx(Gt,{className:"w-6 h-6"})}),e.jsxs("div",{className:"flex items-center gap-3",children:[R(a.foto_participante)?e.jsx("img",{src:R(a.foto_participante),alt:a.nome_participante,className:"w-10 h-10 rounded-full object-cover shadow-sm border border-gray-600"}):e.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-700 flex items-center justify-center",children:e.jsx(de,{className:"w-7 h-7 text-gray-500"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-bold text-white leading-tight",children:a.nome_participante}),e.jsxs("span",{className:"text-[10px] text-green-400 flex items-center gap-1 font-medium",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-green-400 rounded-full animate-pulse"})," Online"]})]})]})]}),e.jsxs("div",{className:"flex-grow p-4 md:p-6 overflow-y-auto space-y-6 relative z-10 custom-scrollbar",children:[m?e.jsx("div",{className:"flex justify-center items-center h-full",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):Object.keys(g).length===0?e.jsx("div",{className:"flex h-full items-center justify-center text-gray-500 text-sm italic",children:"Nenhuma mensagem. Diga olá!"}):Object.keys(g).sort().map(x=>e.jsxs("div",{children:[e.jsx("div",{className:"flex justify-center sticky top-0 z-10 mb-4 opacity-90",children:e.jsx("span",{className:"bg-gray-800/80 backdrop-blur-sm text-gray-400 text-[10px] uppercase font-bold px-3 py-1 rounded-full border border-gray-700 tracking-wide",children:p(x)})}),e.jsx("div",{className:"space-y-3",children:g[x].map(C=>{const k=C.remetente_id===s.id;return e.jsx("div",{className:`flex ${k?"justify-end":"justify-start"} animate-fade-in`,children:e.jsxs("div",{className:`max-w-[85%] md:max-w-[70%] p-3.5 shadow-md relative ${k?"bg-gradient-to-br from-primary to-blue-600 text-white rounded-2xl rounded-tr-sm":"bg-gray-800 text-gray-100 rounded-2xl rounded-tl-sm border border-gray-700"}`,children:[e.jsx("p",{className:"text-sm leading-relaxed whitespace-pre-wrap",children:C.texto}),e.jsx("div",{className:`flex items-center justify-end gap-1 mt-1 ${k?"text-blue-100":"text-gray-500"}`,children:e.jsx("span",{className:"text-[10px] font-medium",children:new Date(C.criado_em).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})})})]})},C.id)})})]},x)),e.jsx("div",{ref:M})]}),s.tipo==="artista"&&!he(s).complete&&e.jsx("div",{className:"px-4 pb-2 pt-2 bg-gray-900 z-20",children:e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/50 rounded-lg p-3 backdrop-blur-sm",children:e.jsxs("p",{className:"text-yellow-200 text-xs text-center flex items-center justify-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 bg-yellow-500 rounded-full animate-pulse"}),"Seu perfil de artista está incompleto. Complete-o para enviar mensagens."]})})}),e.jsx("div",{className:"p-4 bg-gray-900 border-t border-gray-700 shrink-0 relative z-20",children:e.jsxs("form",{onSubmit:j,className:"flex items-end gap-2 relative",children:[e.jsx("div",{className:`flex-grow bg-gray-800 rounded-2xl border border-gray-700 transition-all flex items-center shadow-inner ${s.tipo==="artista"&&!he(s).complete?"opacity-50 cursor-not-allowed":"focus-within:border-primary/50"}`,children:e.jsx("textarea",{value:l,onChange:x=>d(x.target.value),onKeyDown:x=>{x.key==="Enter"&&!x.shiftKey&&(x.preventDefault(),j(x))},placeholder:s.tipo==="artista"&&!he(s).complete?"Complete seu perfil para enviar mensagens.":"Digite sua mensagem...",className:"w-full bg-transparent border-none py-3 px-4 text-white placeholder-gray-500 focus:ring-0 max-h-32 min-h-[48px] resize-none custom-scrollbar disabled:cursor-not-allowed",rows:1,disabled:S||s.tipo==="artista"&&!he(s).complete})}),e.jsx("button",{type:"submit",disabled:S||!l.trim()||s.tipo==="artista"&&!he(s).complete,className:"h-12 w-12 bg-gradient-to-r from-primary to-secondary rounded-full text-white hover:shadow-lg hover:scale-105 transition-all disabled:opacity-50 disabled:hover:scale-100 flex items-center justify-center flex-shrink-0",children:S?e.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):e.jsx(Ia,{className:"w-5 h-5 ml-0.5"})})]})})]}):e.jsx("div",{className:"flex flex-col items-center justify-center h-full p-8 text-center relative z-10",children:e.jsx(Ae,{icon:ue,title:"Suas Mensagens",description:"Selecione uma conversa ao lado para ver o histórico ou responda a novas propostas."})})})]})]})},Fa=({isOpen:s,onClose:r,profile:t})=>{var V,A,z,W,q,Q;const[a,o]=c.useState([]),[i,n]=c.useState([]),[l,d]=c.useState(!0),[h,f]=c.useState(""),[m,u]=c.useState("contracts"),[S,b]=c.useState(!1),[w,D]=c.useState("confirm"),[M,E]=c.useState(""),y=50,j=t.tipo==="artista",R=!!((A=(V=t.artista)==null?void 0:V.dados_bancarios)!=null&&A.chave_pix),P=async()=>{var N,B;d(!0);try{const X=j?(N=t.artista)==null?void 0:N.id:(B=t.estabelecimento)==null?void 0:B.id;if(!X)throw new Error("ID do perfil não encontrado.");const[G,T]=await Promise.all([xt.getFinancialHistory(X,t.tipo),j?Xe.getPayoutHistory(t.id):Promise.resolve([])]);o(G),n(T)}catch(X){f(O(X))}finally{d(!1)}};if(c.useEffect(()=>{s&&P()},[s,t,j]),!s)return null;const $=N=>{const B=yt(N.valor,N.taxa_servico);return j?B.cache:B.total},_=a.filter(N=>pe(N.data_evento,N.status)).reduce((N,B)=>N+$(B),0),p=i.filter(N=>N.status!=="rejeitado").reduce((N,B)=>N+B.valor,0),g=Math.max(0,_-p),x=a.filter(N=>N.status==="concluido"&&!pe(N.data_evento,N.status)).reduce((N,B)=>N+$(B),0),C=a.filter(N=>N.status==="assinado"||N.status==="enviado"&&N.valor).reduce((N,B)=>N+$(B),0),k=j&&g>=y&&R&&!S,I=async()=>{if(w!=="processing"){E(""),D("processing");try{await Xe.requestPayout(t.id,g,t.artista.dados_bancarios.chave_pix,t.artista.dados_bancarios.tipo_chave),D("done"),await P()}catch(N){E(O(N)),D("confirm")}}},J=()=>{if(a.length===0)return;const N=["Data Evento",j?"Contratante":"Artista","Status","Previsão Liberação","Valor (R$)","Data Pagamento"],B=a.map(T=>{var U,v,F,H,ae,me,ke,xe;if(T.status==="cancelado"&&!T.data_pagamento)return null;const se=j?Array.isArray(T.estabelecimentos)?(v=(U=T.estabelecimentos[0])==null?void 0:U.usuarios)==null?void 0:v.nome:(H=(F=T.estabelecimentos)==null?void 0:F.usuarios)==null?void 0:H.nome:Array.isArray(T.artistas)?(me=(ae=T.artistas[0])==null?void 0:ae.usuarios)==null?void 0:me.nome:(xe=(ke=T.artistas)==null?void 0:ke.usuarios)==null?void 0:xe.nome,ee=pe(T.data_evento,T.status),te=Jt(T.data_evento);let L=T.status==="concluido"?ee?"Liberado":"Em Custódia":T.status==="cancelado"?"Cancelado":"Pendente";return[new Date(T.data_evento).toLocaleDateString("pt-BR"),`"${se||"N/A"}"`,L,T.status==="concluido"?te.toLocaleDateString("pt-BR"):"-",$(T).toFixed(2),T.data_pagamento?new Date(T.data_pagamento).toLocaleDateString("pt-BR"):"-"].join(",")}).filter(Boolean),X="data:text/csv;charset=utf-8,"+[N.join(","),...B].join(`
`),G=document.createElement("a");G.setAttribute("href",encodeURI(X)),G.setAttribute("download",`resona_extrato_${new Date().toISOString().split("T")[0]}.csv`),document.body.appendChild(G),G.click(),document.body.removeChild(G)};return e.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-80 z-50 flex justify-center items-center p-4 backdrop-blur-sm",children:[e.jsxs("div",{className:"bg-gray-800 text-white rounded-xl shadow-2xl w-full max-w-3xl relative p-6 animate-fade-in border border-gray-700 max-h-[95vh] flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold font-poppins",children:"Carteira Digital"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Gerencie seus ganhos e saques"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:J,disabled:a.length===0,className:"text-primary hover:text-white transition-colors p-2 rounded-md hover:bg-gray-700 disabled:opacity-50",title:"Exportar CSV",children:e.jsx(Xt,{className:"w-6 h-6"})}),e.jsx("button",{onClick:r,className:"text-gray-500 hover:text-white p-2 rounded-md hover:bg-gray-700",children:e.jsx(Pe,{})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 mb-8",children:[e.jsxs("div",{className:"bg-gray-900/50 p-5 rounded-2xl border-2 border-green-500/20 shadow-inner relative overflow-hidden group",children:[e.jsxs("div",{className:"relative z-10",children:[e.jsx("p",{className:"text-gray-500 text-[10px] font-black uppercase tracking-widest mb-1",children:"Saldo Disponível"}),e.jsxs("p",{className:"text-3xl font-black text-green-400 font-mono",children:["R$ ",g.toLocaleString("pt-BR",{minimumFractionDigits:2})]}),j&&e.jsxs("button",{onClick:()=>{D("confirm"),b(!0)},disabled:!k,className:`mt-4 w-full py-2 rounded-lg text-xs font-bold transition-all shadow-lg flex items-center justify-center gap-2 ${k?"bg-green-500 text-dark hover:bg-white hover:scale-105":"bg-gray-800 text-gray-500 cursor-not-allowed border border-gray-700"}`,children:[g<y?`Mínimo R$ ${y.toFixed(2)}`:R?"Solicitar Saque":"Cadastre seu PIX",k&&e.jsx(Ta,{className:"w-3 h-3"})]})]}),e.jsx(oe,{className:"absolute -right-2 -bottom-2 w-16 h-16 text-green-500/10"})]}),e.jsxs("div",{className:"bg-gray-900/50 p-5 rounded-2xl border border-blue-500/20 shadow-inner relative overflow-hidden",children:[e.jsx("p",{className:"text-gray-500 text-[10px] font-black uppercase tracking-widest mb-1",children:"Em Custódia"}),e.jsxs("p",{className:"text-2xl font-black text-blue-300 font-mono",children:["R$ ",x.toLocaleString("pt-BR",{minimumFractionDigits:2})]}),e.jsxs("p",{className:"text-[10px] text-gray-500 mt-2 flex items-center gap-1",children:[e.jsx(We,{className:"w-3 h-3"})," Protegido pelo RESONA"]}),e.jsx(We,{className:"absolute -right-2 -bottom-2 w-16 h-16 text-blue-500/10"})]}),e.jsxs("div",{className:"bg-gray-900/50 p-5 rounded-2xl border border-yellow-500/20 shadow-inner relative overflow-hidden",children:[e.jsx("p",{className:"text-gray-500 text-[10px] font-black uppercase tracking-widest mb-1",children:"Pendente"}),e.jsxs("p",{className:"text-2xl font-black text-yellow-400 font-mono",children:["R$ ",C.toLocaleString("pt-BR",{minimumFractionDigits:2})]}),e.jsxs("p",{className:"text-[10px] text-gray-500 mt-2 flex items-center gap-1",children:[e.jsx(fe,{className:"w-3 h-3"})," Aguardando pagamento"]}),e.jsx(fe,{className:"absolute -right-2 -bottom-2 w-16 h-16 text-yellow-500/10"})]})]}),e.jsxs("div",{className:"flex border-b border-gray-700 mb-6",children:[e.jsx("button",{onClick:()=>u("contracts"),className:`px-6 py-3 text-sm font-bold transition-all border-b-2 ${m==="contracts"?"border-primary text-primary":"border-transparent text-gray-500 hover:text-gray-300"}`,children:"Transações"}),j&&e.jsx("button",{onClick:()=>u("payouts"),className:`px-6 py-3 text-sm font-bold transition-all border-b-2 ${m==="payouts"?"border-primary text-primary":"border-transparent text-gray-500 hover:text-gray-300"}`,children:"Histórico de Saques"})]}),e.jsx("div",{className:"overflow-y-auto flex-grow custom-scrollbar",children:l?e.jsx("div",{className:"text-center py-12 text-gray-500 animate-pulse",children:"Sincronizando carteira..."}):m==="contracts"?a.length===0?e.jsx("div",{className:"py-20 text-center text-gray-600 italic",children:"Sem movimentações financeiras."}):e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{className:"text-gray-500 text-[10px] uppercase font-black sticky top-0 bg-gray-800 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"pb-4",children:"Evento"}),e.jsx("th",{className:"pb-4",children:j?"Origem":"Destino"}),e.jsx("th",{className:"pb-4",children:"Status"}),e.jsx("th",{className:"pb-4 text-right",children:"Valor"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-700 text-sm",children:a.map(N=>{var G,T,se,ee,te,L,U,v;if(N.status==="cancelado"&&!N.data_pagamento)return null;const B=j?Array.isArray(N.estabelecimentos)?(T=(G=N.estabelecimentos[0])==null?void 0:G.usuarios)==null?void 0:T.nome:(ee=(se=N.estabelecimentos)==null?void 0:se.usuarios)==null?void 0:ee.nome:Array.isArray(N.artistas)?(L=(te=N.artistas[0])==null?void 0:te.usuarios)==null?void 0:L.nome:(v=(U=N.artistas)==null?void 0:U.usuarios)==null?void 0:v.nome,X=pe(N.data_evento,N.status);return e.jsxs("tr",{className:"hover:bg-gray-700/30 transition-colors",children:[e.jsxs("td",{className:"py-4",children:[e.jsx("div",{className:"font-bold",children:new Date(N.data_evento).toLocaleDateString("pt-BR")}),e.jsxs("div",{className:"text-[10px] text-gray-500",children:["ID: ",N.id.substring(0,8)]})]}),e.jsx("td",{className:"py-4 text-gray-300",children:B}),e.jsx("td",{className:"py-4",children:N.status==="cancelado"?e.jsx("span",{className:"text-red-400 text-xs font-bold px-2 py-1 rounded bg-red-400/10",children:"Estorno"}):N.status==="concluido"?X?e.jsx("span",{className:"text-green-400 text-xs font-bold px-2 py-1 rounded bg-green-400/10",children:"Liberado"}):e.jsx("span",{className:"text-blue-300 text-xs font-bold px-2 py-1 rounded bg-blue-300/10",children:"Em Custódia"}):e.jsx("span",{className:"text-yellow-500 text-xs font-bold px-2 py-1 rounded bg-yellow-500/10",children:"Pendente"})}),e.jsxs("td",{className:`py-4 text-right font-mono font-bold ${j?"text-green-400":"text-white"}`,children:[j?"+":"-"," R$ ",$(N).toLocaleString("pt-BR",{minimumFractionDigits:2})]})]},N.id)})})]}):i.length===0?e.jsx("div",{className:"py-20 text-center text-gray-600 italic",children:"Você ainda não solicitou nenhum saque."}):e.jsx("div",{className:"space-y-3",children:i.map(N=>e.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-xl border border-gray-700 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${N.status==="pago"?"bg-green-500":N.status==="pendente"?"bg-yellow-500":"bg-blue-500"}`}),e.jsxs("p",{className:"text-sm font-bold text-white capitalize",children:["Saque ",N.status]})]}),e.jsxs("p",{className:"text-[10px] text-gray-500",children:["Solicitado em ",new Date(N.criado_em).toLocaleString("pt-BR")]}),e.jsxs("p",{className:"text-[10px] text-gray-400 mt-1",children:["PIX (",N.tipo_chave,"): ",N.chave_pix]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-lg font-black text-white font-mono",children:["R$ ",N.valor.toLocaleString("pt-BR",{minimumFractionDigits:2})]}),N.data_pagamento&&e.jsxs("p",{className:"text-[9px] text-green-400 font-bold uppercase tracking-widest mt-1",children:["Pago em ",new Date(N.data_pagamento).toLocaleDateString()]})]})]},N.id))})}),e.jsx("div",{className:"mt-6 pt-6 border-t border-gray-700 text-[10px] text-gray-500 text-center",children:"* Pagamentos em custódia são liberados 24h após o evento. Saques podem levar até 48h úteis para processamento."})]}),S&&e.jsx("div",{className:"fixed inset-0 bg-black/95 z-[60] flex justify-center items-center p-4 backdrop-blur-md",children:e.jsx("div",{className:"bg-gray-900 text-white rounded-2xl p-8 max-w-md w-full border border-gray-800 shadow-[0_0_50px_rgba(34,197,94,0.1)] text-center animate-fade-in",children:w==="confirm"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-20 h-20 bg-green-500/10 rounded-full flex items-center justify-center mx-auto mb-6 border border-green-500/20",children:e.jsx(Se,{className:"w-10 h-10 text-green-400"})}),e.jsx("h3",{className:"text-2xl font-black mb-2",children:"Confirmar Saque"}),e.jsx("p",{className:"text-gray-400 text-sm mb-6",children:"Confirme os dados para transferência via PIX."}),e.jsxs("div",{className:"bg-gray-850 p-6 rounded-2xl border border-gray-800 mb-8 text-left",children:[e.jsxs("div",{className:"flex justify-between mb-4",children:[e.jsx("span",{className:"text-gray-500 text-xs font-bold uppercase",children:"Valor Total"}),e.jsxs("span",{className:"text-green-400 font-black font-mono",children:["R$ ",g.toLocaleString("pt-BR",{minimumFractionDigits:2})]})]}),e.jsxs("div",{className:"pt-4 border-t border-gray-800",children:[e.jsx("span",{className:"text-gray-500 text-[10px] font-black uppercase block mb-1",children:"Destino PIX"}),e.jsx("p",{className:"text-sm font-bold text-white truncate",children:(W=(z=t.artista)==null?void 0:z.dados_bancarios)==null?void 0:W.chave_pix}),e.jsxs("p",{className:"text-[10px] text-gray-500 uppercase mt-1",children:["Tipo: ",(Q=(q=t.artista)==null?void 0:q.dados_bancarios)==null?void 0:Q.tipo_chave]})]})]}),M&&e.jsx("p",{className:"mb-4 text-xs text-red-400 bg-red-400/10 p-2 rounded",children:M}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("button",{onClick:()=>b(!1),className:"py-4 bg-gray-800 hover:bg-gray-700 text-white font-bold rounded-xl transition-all",children:"Cancelar"}),e.jsx("button",{onClick:I,className:"py-4 bg-green-500 hover:bg-white text-dark font-black rounded-xl transition-all shadow-lg shadow-green-900/20",children:"Confirmar"})]})]}):w==="processing"?e.jsxs("div",{className:"py-10",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-green-500 mx-auto mb-6"}),e.jsx("h3",{className:"text-xl font-bold",children:"Processando seu pedido..."}),e.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"Comunicando com o sistema financeiro."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-20 h-20 bg-green-500/10 rounded-full flex items-center justify-center mx-auto mb-6 border border-green-500/20",children:e.jsx(oe,{className:"w-10 h-10 text-green-400"})}),e.jsx("h3",{className:"text-2xl font-black mb-2",children:"Pedido Enviado!"}),e.jsx("p",{className:"text-gray-400 text-sm mb-8 leading-relaxed",children:"Sua solicitação de saque foi registrada com sucesso. O prazo para depósito é de até **48 horas úteis**."}),e.jsx("button",{onClick:()=>{b(!1),D("confirm")},className:"w-full py-4 bg-white text-dark font-black rounded-xl hover:bg-primary transition-all",children:"Entendido"})]})})})]})},Ta=({className:s})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:s,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5l7 7-7 7"})}),Rt=({profile:s,setActiveTab:r})=>{const[t,a]=c.useState({pastShows:0,upcomingShows:0,realizedValue:0,escrowValue:0,disputeValue:0,averageRating:s.nota_media||0,reviewCount:0}),[o,i]=c.useState(null),[n,l]=c.useState([]),{notifications:d}=$t(),[h,f]=c.useState(!0),[m,u]=c.useState(null),[S,b]=c.useState(!1),w=s.tipo==="artista",D=s.plano==="pro"||s.plano==="business",M=async()=>{var A,z;f(!0),u(null);try{const W=w?(A=s.artista)==null?void 0:A.id:(z=s.estabelecimento)==null?void 0:z.id;if(!W)return;const Q=await xt.listByProfile(W,s.tipo)||[],N=new Date().toISOString().split("T")[0],B=new Date(`${N}T00:00:00.000Z`).getTime(),X=Q.filter(v=>v.status==="concluido"&&Yt(v.data_evento)),G=Q.filter(v=>{const F=v.status==="assinado"||v.status==="concluido",H=new Date(v.data_evento).getTime();return F&&H>=B}),T=v=>{const F=yt(v.valor,v.taxa_servico);return w?F.cache:F.total},se=Q.filter(v=>pe(v.data_evento,v.status)),ee=Q.filter(v=>v.status==="concluido"&&!pe(v.data_evento,v.status)),te=Q.filter(v=>Kt(v));a({pastShows:X.length,upcomingShows:G.length,realizedValue:se.reduce((v,F)=>v+T(F),0),escrowValue:ee.reduce((v,F)=>v+T(F),0),disputeValue:te.reduce((v,F)=>v+T(F),0),averageRating:s.nota_media||0,reviewCount:0}),await Ft.checkAndUnlock(s.id,"shows",X.length);const L=G.sort((v,F)=>new Date(v.data_evento).getTime()-new Date(F.data_evento).getTime());i(L[0]||null);const U=Q.filter(v=>!!(v.status==="enviado"&&(w&&!v.assinatura_artista||!w&&!v.assinatura_estabelecimento)||v.status==="assinado"&&!w&&!v.data_pagamento));l(U)}catch(W){const q=O(W);console.error("Dashboard overview error:",q),u(q)}finally{f(!1)}};c.useEffect(()=>{M()},[s]);const y=(()=>{if(!s.plano_expiracao)return null;const A=new Date(s.plano_expiracao),z=new Date,W=A.getTime()-z.getTime();return Math.max(0,Math.ceil(W/(1e3*60*60*24)))})(),j=A=>{if(!A)return"Desconhecido";const z=Array.isArray(A)?A[0]:A;if(!z)return"Desconhecido";const W=Array.isArray(z.usuarios)?z.usuarios[0]:z.usuarios,q=(W==null?void 0:W.nome)||z.nome;return typeof q=="string"&&q!=="[object Object]"?q:"Usuário"},R=A=>{if(!A)return"Brasil";const z=Array.isArray(A)?A[0]:A;if(!z)return"Brasil";const W=Array.isArray(z.usuarios)?z.usuarios[0]:z.usuarios,q=(W==null?void 0:W.cidade)||z.cidade;return typeof q=="string"&&q!=="[object Object]"?q:"Brasil"},P=(A,z="-")=>typeof A=="string"&&A!=="[object Object]"?A.charAt(0).toUpperCase()+A.slice(1):typeof A=="number"?String(A):z;if(h)return e.jsx("div",{className:"text-white text-center p-12 animate-pulse",children:"Consolidando visão geral..."});if(m)return e.jsxs("div",{className:"bg-red-500/10 border border-red-500/20 p-8 rounded-2xl text-center",children:[e.jsx(je,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Ops! Houve um problema"}),e.jsx("p",{className:"text-gray-400 mb-6",children:m}),e.jsx("button",{onClick:M,className:"bg-primary text-dark font-bold px-6 py-2 rounded-full hover:bg-white transition-all",children:"Tentar Novamente"})]});const $=t.realizedValue+t.escrowValue+t.disputeValue,_=100,p=Math.round(t.averageRating*50),g=t.pastShows*_+p,x=Math.floor(g/500)+1,C=x*500,k=(x-1)*500,I=C-k,J=I>0?(g-k)/I*100:0,V=J>80;return e.jsxs("div",{className:"space-y-8 animate-fade-in w-full",children:[D&&y!==null&&y<=3&&e.jsxs("div",{className:"bg-gradient-to-r from-red-600 to-red-800 p-4 rounded-xl shadow-lg border border-red-500 flex flex-col md:flex-row items-center justify-between gap-4 animate-pulse",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-white/20 p-2 rounded-full",children:e.jsx(je,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-black text-white uppercase tracking-tight",children:"Sua Assinatura está expirando!"}),e.jsxs("p",{className:"text-xs text-red-100",children:["Resta(m) apenas **",y," dia(s)**. Renove agora para manter seus benefícios e selo verificado."]})]})]}),e.jsx(re,{to:"/planos",className:"bg-white text-red-700 font-bold px-6 py-2 rounded-full hover:bg-red-50 transition-colors shadow-inner whitespace-nowrap",children:"Renovar Agora"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-2 bg-gradient-to-br from-gray-800 to-gray-900 border border-gray-700 p-6 rounded-2xl shadow-xl flex items-center gap-6 overflow-hidden relative",children:[e.jsxs("div",{className:"relative z-10 flex-grow",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsxs("span",{className:"text-[10px] font-black bg-primary text-dark px-2 py-0.5 rounded-md",children:["LEVEL ",x]}),e.jsx("span",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest",children:"Prestígio na Plataforma"})]}),e.jsxs("h2",{className:"text-3xl font-black text-white font-poppins uppercase",children:["RESONA ",P(s.plano)]}),e.jsxs("div",{className:"mt-4 max-w-sm",children:[e.jsxs("div",{className:"flex justify-between text-[10px] font-bold text-gray-500 mb-1.5 uppercase tracking-tighter",children:[e.jsxs("span",{className:`flex items-center gap-1 ${V?"text-primary animate-pulse":""}`,children:[e.jsx(ne,{className:"w-3 h-3"})," Progresso de Nível"]}),e.jsxs("span",{children:[g," / ",C," XP"]})]}),e.jsx("div",{className:"h-2 w-full bg-gray-950 rounded-full overflow-hidden border border-white/5 relative",children:e.jsx("div",{className:`h-full bg-gradient-to-r from-primary to-blue-400 transition-all duration-1000 ${V?"shadow-[0_0_15px_rgba(81,210,238,0.8)] animate-pulse":"shadow-[0_0_10px_rgba(81,210,238,0.3)]"}`,style:{width:`${J}%`}})}),V&&e.jsx("p",{className:"text-[8px] text-primary/70 font-black uppercase mt-1 tracking-widest text-right",children:"Quase lá! Realize mais um show."})]}),e.jsxs("div",{className:"mt-6 flex gap-3",children:[e.jsx(re,{to:"/planos",className:"bg-primary text-dark font-black px-5 py-2 rounded-full text-sm hover:bg-white transition-all shadow-lg shadow-primary/20",children:"Ver Planos"}),e.jsx("button",{onClick:()=>b(!0),className:"text-gray-300 font-bold border border-gray-600 px-5 py-2 rounded-full text-sm hover:text-white hover:bg-gray-800 transition-all",children:"Ver Extrato"})]})]}),e.jsx("div",{className:"hidden md:block relative",children:e.jsx("div",{className:`w-24 h-24 bg-primary/10 rounded-full flex items-center justify-center border-4 transition-all duration-500 ${V?"border-primary shadow-[0_0_30px_rgba(81,210,238,0.4)]":"border-primary/20 shadow-[0_0_20px_rgba(81,210,238,0.2)]"}`,children:e.jsx("span",{className:"text-4xl font-black text-primary",children:x})})}),e.jsx("div",{className:"absolute right-[-20px] top-[-20px] w-40 h-40 bg-primary/5 rounded-full blur-3xl pointer-events-none"})]}),e.jsxs("div",{className:"bg-gray-800 p-6 rounded-2xl border border-gray-700 shadow-xl flex flex-col justify-center text-center",children:[e.jsx("p",{className:"text-gray-400 text-[10px] font-black uppercase mb-2 tracking-widest",children:"Reputação Média"}),e.jsxs("div",{className:"flex items-center justify-center gap-2 mb-1",children:[e.jsx(ie,{className:"w-8 h-8 text-yellow-500"}),e.jsx("span",{className:"text-4xl font-black text-white font-mono",children:t.averageRating.toFixed(1)})]}),e.jsx("div",{className:"flex justify-center text-yellow-500/30",children:[...Array(5)].map((A,z)=>e.jsx(ie,{className:`w-4 h-4 ${z<Math.round(t.averageRating)?"text-yellow-500":""}`},z))}),e.jsx("p",{className:"text-[9px] text-gray-500 uppercase font-bold mt-4",children:"Ponto forte: Profissionalismo"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 w-full",children:[e.jsx("div",{onClick:()=>r("contratos"),className:"bg-gray-800 p-6 rounded-xl border border-gray-700 shadow-lg cursor-pointer hover:-translate-y-1 transition-all group",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-primary text-xs font-bold uppercase tracking-wider mb-2",children:"Agenda"}),e.jsx("p",{className:"text-4xl font-bold text-white font-mono",children:t.upcomingShows}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Confirmados"})]}),e.jsx(we,{className:"w-8 h-8 text-gray-600 group-hover:text-primary transition-colors"})]})}),e.jsx("div",{onClick:()=>b(!0),className:"bg-gray-800 p-6 rounded-xl border border-gray-700 shadow-lg cursor-pointer hover:-translate-y-1 transition-all group",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-green-400 text-xs font-bold uppercase tracking-wider mb-2",children:w?"Ganhos":"Custos"}),e.jsxs("p",{className:"text-3xl font-bold text-white font-mono",children:[e.jsx("span",{className:"text-lg text-gray-400 mr-1 font-sans",children:"R$"}),$.toLocaleString("pt-BR",{notation:"compact"})]}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Extrato"})]}),e.jsx(Se,{className:"w-8 h-8 text-gray-600 group-hover:text-green-400 transition-colors"})]})}),e.jsx("div",{className:"bg-gray-800 p-6 rounded-xl border border-gray-700 shadow-lg",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-xs font-bold uppercase tracking-wider mb-2",children:"Histórico"}),e.jsx("p",{className:"text-4xl font-bold text-white font-mono",children:t.pastShows}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Concluídos"})]}),e.jsx(oe,{className:"w-8 h-8 text-gray-700"})]})}),e.jsx("div",{onClick:()=>r("avaliacoes"),className:"bg-gray-800 p-6 rounded-xl border border-gray-700 shadow-lg cursor-pointer hover:-translate-y-1 transition-all group",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-yellow-500 text-xs font-bold uppercase tracking-wider mb-2",children:"XP Total"}),e.jsx("p",{className:"text-4xl font-bold text-white font-mono",children:g}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Pontos de Carreira"})]}),e.jsx(ie,{className:"w-8 h-8 text-gray-600 group-hover:text-yellow-500 transition-colors"})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 flex flex-col gap-8",children:[e.jsx(Ge,{profile:s,onUpdate:M}),o?e.jsxs("div",{className:"bg-gray-800 rounded-xl border border-gray-700 p-6 shadow-xl flex flex-col md:flex-row gap-6 items-center hover:border-primary/30 transition-all",children:[e.jsxs("div",{className:"w-24 h-24 bg-primary/10 rounded-xl flex flex-col items-center justify-center border border-primary/20 shrink-0 shadow-inner",children:[e.jsx("span",{className:"text-primary font-bold text-xs uppercase",children:new Date(o.data_evento).toLocaleString("pt-BR",{month:"short",timeZone:"UTC"})}),e.jsx("span",{className:"text-4xl font-black text-white",children:new Date(o.data_evento).getUTCDate()})]}),e.jsxs("div",{className:"flex-1 text-center md:text-left min-w-0",children:[e.jsx("span",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-widest",children:"Próxima Apresentação"}),e.jsx("h3",{className:"text-2xl font-bold text-white mt-1 truncate",children:j(w?o.estabelecimentos:o.artistas)}),e.jsxs("p",{className:"text-gray-400 text-sm flex items-center justify-center md:justify-start gap-1 mt-1",children:[e.jsx(Me,{className:"w-3 h-3 text-primary"})," ",w?R(o.estabelecimentos):"Local agendado"]})]}),e.jsx(re,{to:`/contratos/${o.id}`,className:"bg-white text-dark font-black px-8 py-3 rounded-xl hover:bg-primary transition-all shadow-lg whitespace-nowrap",children:"Ver Detalhes"})]}):e.jsxs("div",{className:"bg-gray-900/50 rounded-xl border border-gray-800 p-10 shadow-inner flex flex-col items-center text-center",children:[e.jsx(we,{className:"w-12 h-12 text-gray-700 mb-4"}),e.jsx("h3",{className:"text-lg font-bold text-gray-400",children:"Nenhum palco à vista?"}),e.jsx("p",{className:"text-gray-500 text-sm max-w-xs mt-2 leading-relaxed",children:"Sua agenda de eventos confirmados está livre. Que tal buscar novas oportunidades agora?"}),e.jsxs(re,{to:w?"/estabelecimentos":"/artistas",className:"mt-6 text-primary font-black uppercase text-xs tracking-widest hover:text-white transition-colors flex items-center gap-2",children:["Descobrir ",w?"Locais":"Artistas"," ",e.jsx(Re,{className:"w-3 h-3"})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-xl border border-gray-700 shadow-lg overflow-hidden",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-700 bg-gray-900/30 flex justify-between items-center",children:e.jsxs("h3",{className:"font-bold text-white flex items-center gap-2",children:[e.jsx(Je,{className:"w-5 h-5 text-yellow-500"})," Pendências de Ação"]})}),e.jsx("div",{className:"divide-y divide-gray-700",children:n.length>0?n.map(A=>e.jsxs("div",{className:"p-4 flex items-center justify-between gap-4 group",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-sm font-bold text-white truncate group-hover:text-primary transition-colors",children:j(w?A.estabelecimentos:A.artistas)}),e.jsxs("p",{className:"text-xs text-yellow-500 flex items-center gap-1",children:[e.jsx(je,{className:"w-3 h-3"})," ",A.status==="enviado"?"Assinitura pendente":"Pagamento pendente"]})]}),e.jsx(re,{to:`/contratos/${A.id}`,className:"text-xs font-bold text-dark bg-yellow-500 hover:bg-white px-5 py-2.5 rounded-lg transition-all shadow-md whitespace-nowrap",children:"Resolver"})]},A.id)):e.jsx("p",{className:"p-10 text-center text-gray-500 text-sm italic",children:"Nenhuma pendência contratual encontrada."})})]})]}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-gray-800 rounded-xl border border-gray-700 overflow-hidden shadow-lg h-full flex flex-col",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-700 bg-gray-900/30 flex items-center gap-2",children:[e.jsx(ue,{className:"w-5 h-5 text-primary"}),e.jsx("h3",{className:"font-bold text-white",children:"Atividade Recente"})]}),e.jsx("div",{className:"p-4 space-y-4 flex-grow overflow-y-auto custom-scrollbar",children:d.length>0?d.slice(0,8).map(A=>e.jsxs("div",{className:"flex gap-3 text-sm border-b border-gray-700/50 pb-3 last:border-0 hover:bg-gray-700/20 p-2 rounded transition-colors",children:[e.jsx("div",{className:"mt-1 flex-shrink-0",children:A.tipo==="mensagem"?e.jsx(ue,{className:"w-4 h-4 text-green-400"}):e.jsx(Je,{className:"w-4 h-4 text-primary"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-gray-200 font-bold truncate leading-tight",children:P(A.titulo,"Notificação")}),e.jsx("p",{className:"text-[10px] text-gray-500 mt-0.5 line-clamp-2 leading-relaxed",children:P(A.descricao,"Sem detalhes")})]})]},A.id)):e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-gray-600",children:[e.jsx(fe,{className:"w-10 h-10 mb-2 opacity-20"}),e.jsx("p",{className:"text-sm italic",children:"Nenhuma atividade recente."})]})})]})})]}),e.jsx(Fa,{isOpen:S,onClose:()=>b(!1),profile:s})]})},Pt=({profile:s})=>{const[r,t]=c.useState([]),[a,o]=c.useState(!0),[i,n]=c.useState(null),l=s.plano!=="free";c.useEffect(()=>{(async()=>{o(!0);try{const u=await K.getSubscriptionHistory(s.id);t(u)}catch(u){n(O(u))}finally{o(!1)}})()},[s.id]);const h=(()=>{if(!s.plano_expiracao)return null;const m=new Date(s.plano_expiracao),u=new Date,S=m.getTime()-u.getTime();return Math.max(0,Math.ceil(S/(1e3*60*60*24)))})(),f=h!==null?Math.max(0,Math.min(100,h/30*100)):0;return e.jsxs("div",{className:"space-y-8 animate-fade-in",children:[e.jsx("h2",{className:"text-2xl font-bold font-poppins text-white",children:"Gerenciar Assinatura"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-1 bg-gray-900 rounded-2xl border border-gray-700 overflow-hidden shadow-xl",children:[e.jsxs("div",{className:"p-6 bg-gradient-to-br from-gray-800 to-gray-900 border-b border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:s.plano==="pro"?e.jsx(ne,{className:"text-primary w-6 h-6"}):s.plano==="business"?e.jsx(Qt,{className:"text-yellow-500 w-6 h-6"}):e.jsx(ie,{className:"text-gray-500 w-6 h-6"})}),e.jsx("span",{className:"text-gray-400 text-xs font-black uppercase tracking-widest",children:"Plano Ativo"})]}),e.jsxs("h3",{className:"text-3xl font-black text-white uppercase font-poppins",children:["RESONA ",s.plano]})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[l&&h!==null?e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsx("span",{className:"text-gray-400",children:"Tempo Restante"}),e.jsxs("span",{className:"text-white font-bold",children:[h," dias"]})]}),e.jsx("div",{className:"h-2 bg-gray-800 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full transition-all duration-1000 ${h<=5?"bg-red-500":"bg-primary"}`,style:{width:`${f}%`}})}),e.jsxs("p",{className:"text-[10px] text-gray-500 mt-2 uppercase font-bold tracking-tighter",children:["Expira em: ",new Date(s.plano_expiracao).toLocaleDateString("pt-BR")]})]}):e.jsx("div",{className:"bg-gray-800/50 p-4 rounded-xl border border-gray-700",children:e.jsx("p",{className:"text-sm text-gray-400 leading-relaxed italic",children:"Você está no plano gratuito. Faça o upgrade para desbloquear busca prioritária e selo de verificação."})}),e.jsx("div",{className:"pt-4 border-t border-gray-800",children:e.jsx(re,{to:"/planos",className:"w-full bg-primary text-dark font-black py-3 rounded-xl flex items-center justify-center gap-2 hover:bg-white transition-all shadow-lg shadow-primary/10",children:l?"Renovar / Mudar Plano":"Ver Planos Premium"})})]})]}),e.jsxs("div",{className:"lg:col-span-2 bg-gray-800 rounded-2xl border border-gray-700 shadow-xl overflow-hidden flex flex-col",children:[e.jsx("div",{className:"p-4 border-b border-gray-700 bg-gray-900/30 flex justify-between items-center",children:e.jsxs("h3",{className:"font-bold text-white flex items-center gap-2",children:[e.jsx(fe,{className:"w-5 h-5 text-primary"})," Histórico de Cobrança"]})}),e.jsx("div",{className:"flex-grow overflow-y-auto custom-scrollbar min-h-[300px]",children:a?e.jsx("div",{className:"p-12 text-center text-gray-500 animate-pulse",children:"Carregando histórico..."}):r.length===0?e.jsx("div",{className:"p-12 text-center text-gray-500",children:"Nenhum pagamento registrado."}):e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{className:"bg-gray-900/50 text-[10px] text-gray-500 uppercase font-black sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-4",children:"Data"}),e.jsx("th",{className:"p-4",children:"Plano"}),e.jsx("th",{className:"p-4",children:"Valor"}),e.jsx("th",{className:"p-4",children:"Método"}),e.jsx("th",{className:"p-4 text-center",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-700 text-sm",children:r.map(m=>{var u;return e.jsxs("tr",{className:"hover:bg-gray-700/30 transition-colors",children:[e.jsx("td",{className:"p-4 text-gray-400 font-mono text-xs",children:new Date(m.data_mudanca).toLocaleDateString("pt-BR")}),e.jsx("td",{className:"p-4 font-bold text-white uppercase",children:m.plano_novo}),e.jsxs("td",{className:"p-4 text-gray-300",children:["R$ ",(u=m.valor_pago)==null?void 0:u.toLocaleString("pt-BR",{minimumFractionDigits:2})]}),e.jsx("td",{className:"p-4 text-gray-500 text-xs",children:m.metodo_pagamento==="stripe_simulated"?"Cartão (Stripe)":m.metodo_pagamento==="system_expiry"?"Sistema (Downgrade)":m.metodo_pagamento}),e.jsx("td",{className:"p-4 text-center",children:e.jsx("div",{className:"flex justify-center",children:e.jsx(oe,{className:"w-5 h-5 text-green-500/50"})})})]},m.id)})})]})}),e.jsx("div",{className:"p-4 bg-gray-900/30 border-t border-gray-700 text-center",children:e.jsx("p",{className:"text-[10px] text-gray-600 uppercase font-bold tracking-widest",children:"Cobranças processadas pelo Stripe • Todos os dados são protegidos"})})]})]})]})},La=["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],Ba=({profile:s})=>{var _;const[r,t]=c.useState(new Date),[a,o]=c.useState([]),[i,n]=c.useState(!0),[l,d]=c.useState(""),[h,f]=c.useState(!1),[m,u]=c.useState({date:"",title:"",type:"bloqueio_manual"}),[S,b]=c.useState(!1),w=(_=s.artista)==null?void 0:_.id,D=async()=>{if(w){n(!0);try{const p=await Fe.getConsolidatedAgenda(w,s.id,"","");o(p)}catch(p){d(O(p))}finally{n(!1)}}};c.useEffect(()=>{D()},[w]);const M=(p,g)=>new Date(p,g+1,0).getDate(),E=(p,g)=>new Date(p,g,1).getDay(),y=()=>e.jsxs("div",{className:"flex justify-between items-center mb-8 bg-gray-900/50 p-4 rounded-2xl border border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:e.jsx(we,{className:"text-primary w-6 h-6"})}),e.jsxs("h2",{className:"text-2xl font-black text-white font-poppins",children:[La[r.getMonth()]," ",r.getFullYear()]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>t(new Date(r.getFullYear(),r.getMonth()-1,1)),className:"p-2 hover:bg-gray-700 rounded-lg text-gray-400",children:e.jsx(Ut,{})}),e.jsx("button",{onClick:()=>t(new Date),className:"px-4 py-2 text-xs font-bold bg-gray-800 text-white rounded-lg border border-gray-700 hover:bg-gray-700",children:"Hoje"}),e.jsx("button",{onClick:()=>t(new Date(r.getFullYear(),r.getMonth()+1,1)),className:"p-2 hover:bg-gray-700 rounded-lg text-gray-400",children:e.jsx(Re,{})})]})]}),j=p=>{u({...m,date:p}),f(!0)},R=async p=>{if(p.preventDefault(),!(!w||!m.date||!m.title)){b(!0);try{await Fe.createBlock({artista_id:w,data_inicio:m.date,titulo:m.title,tipo:m.type}),f(!1),u({date:"",title:"",type:"bloqueio_manual"}),D()}catch(g){alert(O(g))}finally{b(!1)}}},P=async p=>{if(window.confirm("Excluir este compromisso?"))try{await Fe.deleteBlock(p),D()}catch(g){alert(O(g))}},$=()=>{const p=r.getFullYear(),g=r.getMonth(),x=[],C=M(p,g),k=E(p,g);for(let I=0;I<k;I++)x.push(e.jsx("div",{className:"h-32 bg-gray-850/30 border border-gray-800/50 rounded-lg"},`empty-${I}`));for(let I=1;I<=C;I++){const J=`${p}-${String(g+1).padStart(2,"0")}-${String(I).padStart(2,"0")}`,V=a.filter(z=>z.date===J),A=new Date().toISOString().split("T")[0]===J;x.push(e.jsxs("div",{onClick:()=>j(J),className:`h-32 p-2 border border-gray-800 bg-gray-850 rounded-lg transition-all hover:border-primary/40 cursor-pointer flex flex-col group overflow-hidden ${A?"ring-1 ring-primary/50 bg-gray-800":""}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsx("span",{className:`text-xs font-bold ${A?"bg-primary text-dark px-1.5 rounded":"text-gray-500"}`,children:I}),e.jsx(ft,{className:"w-3 h-3 text-gray-700 opacity-0 group-hover:opacity-100 transition-opacity"})]}),e.jsx("div",{className:"flex-grow space-y-1 overflow-y-auto scrollbar-hide",children:V.map(z=>e.jsxs("div",{onClick:W=>{W.stopPropagation(),z.type==="manual_block"&&P(z.id)},className:`text-[9px] px-1.5 py-1 rounded-md font-bold truncate border flex items-center justify-between ${z.type==="contract_confirmed"?"bg-green-500/10 text-green-400 border-green-500/30":z.type==="contract_pending"?"bg-yellow-500/10 text-yellow-400 border-yellow-500/30":"bg-gray-700 text-gray-300 border-gray-600"}`,children:[e.jsx("span",{className:"truncate",children:z.title}),z.type==="manual_block"&&e.jsx(ge,{className:"w-2.5 h-2.5 opacity-50 hover:opacity-100"})]},z.id))})]},I))}return x};return e.jsxs("div",{className:"animate-fade-in w-full",children:[y(),e.jsxs("div",{className:"grid grid-cols-7 gap-2 mb-2 text-center text-[10px] font-black text-gray-500 uppercase tracking-widest",children:[e.jsx("div",{children:"Dom"}),e.jsx("div",{children:"Seg"}),e.jsx("div",{children:"Ter"}),e.jsx("div",{children:"Qua"}),e.jsx("div",{children:"Qui"}),e.jsx("div",{children:"Sex"}),e.jsx("div",{children:"Sáb"})]}),e.jsx("div",{className:"grid grid-cols-7 gap-2",children:$()}),e.jsxs("div",{className:"mt-8 flex flex-wrap gap-6 p-4 bg-gray-900/30 rounded-xl border border-gray-800",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs font-bold text-gray-400",children:[e.jsx("div",{className:"w-3 h-3 rounded bg-green-500/20 border border-green-500/40"})," Show Confirmado"]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs font-bold text-gray-400",children:[e.jsx("div",{className:"w-3 h-3 rounded bg-yellow-500/20 border border-yellow-500/40"})," Show Pendente"]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs font-bold text-gray-400",children:[e.jsx("div",{className:"w-3 h-3 rounded bg-gray-700 border border-gray-600"})," Bloqueio Manual"]})]}),h&&e.jsx("div",{className:"fixed inset-0 bg-black/90 z-50 flex justify-center items-center p-4 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-gray-900 text-white rounded-2xl p-6 max-w-md w-full border border-gray-800 shadow-2xl animate-fade-in",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h3",{className:"text-xl font-bold",children:"Bloquear Data"}),e.jsx("button",{onClick:()=>f(!1),children:e.jsx(Re,{className:"rotate-90"})})]}),e.jsxs("form",{onSubmit:R,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Data Selecionada"}),e.jsx("input",{type:"date",value:m.date,disabled:!0,className:"w-full bg-gray-800 border border-gray-700 rounded-lg p-3 text-gray-400"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Título do Compromisso"}),e.jsx("input",{type:"text",value:m.title,onChange:p=>u({...m,title:p.target.value}),required:!0,className:"w-full bg-gray-800 border border-gray-700 rounded-lg p-3 text-white focus:ring-1 focus:ring-primary outline-none",placeholder:"Ex: Ensaio Geral, Viagem, Show Externo"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Tipo"}),e.jsxs("select",{value:m.type,onChange:p=>u({...m,type:p.target.value}),className:"w-full bg-gray-800 border border-gray-700 rounded-lg p-3 text-white",children:[e.jsx("option",{value:"bloqueio_manual",children:"Bloqueio Privado"}),e.jsx("option",{value:"ensaio",children:"Ensaio"}),e.jsx("option",{value:"viagem",children:"Viagem"}),e.jsx("option",{value:"show_externo",children:"Show Fora da Plataforma"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>f(!1),className:"flex-1 py-3 bg-gray-800 hover:bg-gray-700 rounded-xl font-bold",children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:S,className:"flex-1 py-3 bg-primary text-dark font-black rounded-xl hover:bg-white transition-all shadow-lg shadow-primary/20",children:S?"Salvando...":"Confirmar"})]})]})]})})]})},ct=[{id:"overview",label:"Visão Geral",icon:e.jsx(ut,{className:"w-5 h-5"})},{id:"agenda",label:"Agenda",icon:e.jsx(we,{className:"w-5 h-5"})},{id:"contratos",label:"Contratos",icon:e.jsx(pt,{className:"w-5 h-5"})},{id:"mensagens",label:"Mensagens",icon:e.jsx(ue,{className:"w-5 h-5"})},{id:"perfil",label:"Meu Perfil",icon:e.jsx(de,{className:"w-5 h-5"})},{id:"performance",label:"Performance",icon:e.jsx(Ne,{className:"w-5 h-5"})},{id:"assinatura",label:"Assinatura",icon:e.jsx(Se,{className:"w-5 h-5"})}],Oa=({user:s,initialProfile:r,onProfileUpdate:t,openTab:a})=>{const[o,i]=c.useState("overview"),n=He(),l=ht();c.useEffect(()=>{a&&(["portfolio","banda"].includes(a)?i("perfil"):["analytics","avaliacoes"].includes(a)?i("performance"):ct.some(f=>f.id===a)&&i(a),n(l.pathname,{replace:!0}))},[a,n,l.pathname]);const d=()=>{switch(o){case"overview":return e.jsx(Rt,{profile:r,setActiveTab:i});case"agenda":return e.jsx(Ba,{profile:r});case"contratos":return e.jsx(vt,{profile:r});case"mensagens":return e.jsx(At,{currentUser:r});case"perfil":return e.jsx(Pa,{profile:r,onUpdate:t,initialTab:a||void 0});case"performance":return e.jsx(za,{profile:r,initialTab:a||void 0});case"assinatura":return e.jsx(Pt,{profile:r});default:return null}},h=String(r.nome||s.email||"Usuário");return e.jsx(jt,{title:"Painel do Artista",subtitle:e.jsxs(e.Fragment,{children:["Bem-vindo(a) de volta, ",e.jsx("span",{className:"text-primary font-semibold",children:h}),"!"]}),tabs:ct,activeTab:o,onTabClick:i,profile:r,children:d()})},qa=({initialProfile:s,onProfileUpdate:r})=>{const[t,a]=c.useState("idle"),[o,i]=c.useState(""),[n,l]=c.useState(""),[d,h]=c.useState(!1),f=Vt(s),[m,u]=c.useState({nome:"",telefone:"",cidade:"",foto_url:"",foto_capa:"",capacidade:null,descricao:"",endereco:"",midias_sociais:{instagram:"",site:""}});c.useEffect(()=>{if(n){const y=setTimeout(()=>l(""),4e3);return()=>clearTimeout(y)}},[n]),c.useEffect(()=>{var y,j,R,P,$,_,p,g;s&&u({nome:s.nome||"",telefone:s.telefone||"",cidade:s.cidade||"",foto_url:s.foto_url||"",foto_capa:((y=s.estabelecimento)==null?void 0:y.foto_capa)||"",capacidade:((j=s.estabelecimento)==null?void 0:j.capacidade)??null,descricao:((R=s.estabelecimento)==null?void 0:R.descricao)||"",endereco:((P=s.estabelecimento)==null?void 0:P.endereco)||"",midias_sociais:{instagram:((_=($=s.estabelecimento)==null?void 0:$.midias_sociais)==null?void 0:_.instagram)||"",site:((g=(p=s.estabelecimento)==null?void 0:p.midias_sociais)==null?void 0:g.site)||""}})},[s]);const S=y=>{const{id:j,value:R}=y.target;u(P=>{if(j==="capacidade"){const $=parseInt(R,10);return{...P,capacidade:isNaN($)?null:$}}return{...P,[j]:R}}),t!=="idle"&&a("idle")},b=y=>{const{name:j,value:R}=y.target;u(P=>({...P,midias_sociais:{...P.midias_sociais,[j]:R}})),t!=="idle"&&a("idle")},w=(y,j)=>{l(""),K.updateBasicInfo(s.id,{foto_url:y}).then(()=>{l("Foto de perfil atualizada!"),r(),j.onSuccess()}).catch(R=>{console.error("Error updating avatar URL in DB",R),l("Falha ao salvar a foto."),j.onError()})},D=async y=>{i("");try{await K.updateVenue(s.id,null,{foto_capa:y}),u(j=>({...j,foto_capa:y})),r()}catch(j){const R=O(j);console.error("Error updating cover photo:",R),i("Erro ao salvar foto de capa: "+R),a("error")}},M=async y=>{y.preventDefault(),a("saving"),i("");const j=ka(m);if(!j.valid){a("error"),i(j.errors.join("; "));return}const R=m.telefone?_e(m.telefone):"",P=kt(m.midias_sociais);try{await K.updateVenue(s.id,{nome:m.nome.trim(),telefone:R,cidade:m.cidade.trim()},{capacidade:m.capacidade,descricao:m.descricao.trim(),endereco:m.endereco.trim(),midias_sociais:P||{}}),a("success"),r().catch($=>{console.warn("Erro ao atualizar contexto:",$)}),setTimeout(()=>a("idle"),3e3)}catch($){a("error");const _=O($);i(_),console.error(_)}},E=t==="saving"||t==="success";return e.jsxs("form",{onSubmit:M,children:[e.jsx("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6",children:e.jsx("h2",{className:"text-2xl font-bold font-poppins text-white",children:"Editar Perfil"})}),!f.complete&&e.jsxs("div",{className:"mb-8 bg-gray-900 border-l-4 border-yellow-500 p-4 rounded-r-lg shadow-md transition-all",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(je,{className:"w-5 h-5 text-yellow-500 flex-shrink-0"}),e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-gray-300",children:["Seu perfil está incompleto. Preencha os ",e.jsxs("strong",{children:[f.missing.length," itens restantes"]})," para melhorar sua reputação."]})})]}),e.jsx("button",{type:"button",onClick:()=>h(!d),className:"text-xs font-semibold text-primary hover:underline whitespace-nowrap ml-4",children:d?"Ocultar":"Ver Pendências"})]}),d&&e.jsx("div",{className:"mt-3 pl-8 animate-fade-in",children:e.jsx("ul",{className:"list-disc text-xs text-gray-400 space-y-1",children:f.missing.map((y,j)=>e.jsx("li",{children:y},j))})})]}),e.jsx(_t,{currentPath:m.foto_capa,bucketName:"estabelecimento",userId:s.auth_id,onUploadComplete:D}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 items-start mb-8",children:[e.jsxs("div",{className:"lg:col-span-1 flex flex-col items-center",children:[e.jsx(St,{url:m.foto_url,onUpload:w}),e.jsx("p",{className:"text-sm text-gray-400 mt-4 text-center",children:"Clique na imagem para carregar uma nova foto de perfil."}),n&&e.jsx("p",{className:"text-sm text-green-400 mt-2 text-center",children:n})]}),e.jsxs("div",{className:"lg:col-span-2 grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"nome",className:"block text-sm font-medium text-gray-300",children:"Nome do Estabelecimento"}),e.jsx("input",{type:"text",id:"nome",value:m.nome,onChange:S,className:"mt-1 input-style"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-300",children:"Email"}),e.jsx("input",{type:"email",id:"email",value:s.email,disabled:!0,className:"mt-1 input-style bg-gray-700 cursor-not-allowed"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"telefone",className:"block text-sm font-medium text-gray-300",children:"Telefone"}),e.jsx("input",{type:"tel",id:"telefone",value:m.telefone,onChange:S,className:"mt-1 input-style"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"cidade",className:"block text-sm font-medium text-gray-300",children:"Cidade"}),e.jsx("input",{type:"text",id:"cidade",value:m.cidade,onChange:S,className:"mt-1 input-style"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx("div",{className:"md:col-span-2",children:e.jsx("hr",{className:"border-gray-700"})}),e.jsx("div",{className:"md:col-span-2",children:e.jsx("h3",{className:"text-xl font-semibold text-white mt-4",children:"Detalhes do Estabelecimento"})}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"capacidade",className:"block text-sm font-medium text-gray-300",children:"Capacidade (pessoas)"}),e.jsx("input",{type:"number",id:"capacidade",value:m.capacidade??"",onChange:S,className:"mt-1 input-style",placeholder:"Ex: 150"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"endereco",className:"block text-sm font-medium text-gray-300",children:"Endereço Completo"}),e.jsx("input",{type:"text",id:"endereco",value:m.endereco,onChange:S,className:"mt-1 input-style",placeholder:"Rua, Número, Bairro"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{htmlFor:"descricao",className:"block text-sm font-medium text-gray-300",children:"Descrição do Local"}),e.jsx("textarea",{id:"descricao",rows:4,value:m.descricao,onChange:S,className:"mt-1 input-style",placeholder:"Descreva seu espaço, o tipo de público, estrutura, etc."})]}),e.jsx("div",{className:"md:col-span-2",children:e.jsx("h3",{className:"text-lg font-semibold text-white mb-4 mt-4",children:"Mídias Sociais"})}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"instagram",className:"block text-sm font-medium text-gray-300",children:"Usuário do Instagram"}),e.jsx("input",{type:"text",name:"instagram",id:"instagram",value:m.midias_sociais.instagram,onChange:b,className:"mt-1 input-style",placeholder:"seu_usuario_no_instagram"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"site",className:"block text-sm font-medium text-gray-300",children:"Site Oficial"}),e.jsx("input",{type:"url",name:"site",id:"site",value:m.midias_sociais.site,onChange:b,className:"mt-1 input-style",placeholder:"https://seu-site.com"})]}),e.jsxs("div",{className:"md:col-span-2 flex justify-end items-center gap-4",children:[t==="error"&&e.jsx("p",{className:"text-sm text-red-400 mr-auto flex-grow",children:o}),e.jsxs("button",{type:"submit",disabled:E,className:`font-bold py-2 px-6 rounded-full transition-all duration-300 transform hover:scale-105 flex items-center justify-center gap-2
                            ${t==="idle"&&"bg-gradient-to-r from-primary to-secondary text-white hover:shadow-lg hover:shadow-secondary/40"}
                            ${t==="saving"&&"bg-gray-600 text-white cursor-not-allowed"}
                            ${t==="success"&&"bg-green-600 text-white cursor-not-allowed"}
                            ${t==="error"&&"bg-red-600 text-white"}
                        `,children:[t==="saving"&&"Salvando...",t==="success"&&e.jsxs(e.Fragment,{children:[e.jsx(le,{className:"w-5 h-5"})," Salvo!"]}),t==="error"&&"Tentar Novamente",t==="idle"&&"Salvar Perfil Completo"]})]})]})]})},Ua=({profile:s,onUpdate:r})=>{var u,S;const[t,a]=c.useState(null),[o,i]=c.useState(""),[n,l]=c.useState(""),d=async(b,w)=>{if(!b.target.files||b.target.files.length===0)return;const D=b.target.files[0];a(w),i(""),l("");try{const M=D.name.split(".").pop(),E=`${s.auth_id}/docs/venue_${w}_${Date.now()}.${M}`,y=await Z.upload("estabelecimento",E,D);await K.updateVenue(s.id,null,{[w==="lista"?"lista_equipamentos_url":"mapa_palco_url"]:y}),l("Arquivo enviado com sucesso!"),r()}catch(M){i(O(M))}finally{a(null)}},h=async b=>{if(window.confirm("Remover este arquivo?"))try{await K.updateVenue(s.id,null,{[b==="lista"?"lista_equipamentos_url":"mapa_palco_url"]:null}),r()}catch(w){alert(O(w))}},f=(u=s.estabelecimento)==null?void 0:u.lista_equipamentos_url,m=(S=s.estabelecimento)==null?void 0:S.mapa_palco_url;return e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsx("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6",children:e.jsx("h2",{className:"text-2xl font-bold font-poppins text-white",children:"Especificações Técnicas"})}),e.jsx("p",{className:"text-gray-400 text-sm mb-6",children:"Disponibilize informações técnicas do seu espaço para agilizar a pré-produção dos shows."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-gray-900/50 p-6 rounded-2xl border border-gray-700",children:[e.jsxs("h3",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx(Ee,{className:"w-5 h-5 text-primary"})," Lista de Equipamentos (PA/Backline)"]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("label",{className:`flex-1 flex flex-col items-center justify-center py-8 border-2 border-dashed border-gray-700 rounded-xl cursor-pointer hover:bg-gray-800 transition-all ${t==="lista"?"opacity-50":""}`,children:[e.jsx(ce,{className:`w-8 h-8 mb-2 ${t==="lista"?"animate-bounce":"text-gray-500"}`}),e.jsx("span",{className:"text-xs font-bold text-gray-400",children:f?"Substituir Lista":"Enviar PDF/Imagem"}),e.jsx("input",{type:"file",className:"hidden",accept:".pdf,image/*",onChange:b=>d(b,"lista"),disabled:!!t})]}),f&&e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("a",{href:Z.getPublicUrl("estabelecimento",f),target:"_blank",rel:"noreferrer",className:"w-12 h-12 bg-green-500/10 rounded-full flex items-center justify-center text-green-500 border border-green-500/30 hover:bg-green-500/20 transition-colors",children:e.jsx(le,{className:"w-6 h-6"})}),e.jsx("button",{onClick:()=>h("lista"),className:"w-12 h-12 bg-red-500/10 rounded-full flex items-center justify-center text-red-500 border border-red-500/30 hover:bg-red-500/20 transition-colors",children:e.jsx(ge,{className:"w-5 h-5"})})]})]})]}),e.jsxs("div",{className:"bg-gray-900/50 p-6 rounded-2xl border border-gray-700",children:[e.jsxs("h3",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx(Ee,{className:"w-5 h-5 text-secondary"})," Mapa de Palco / Planta"]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("label",{className:`flex-1 flex flex-col items-center justify-center py-8 border-2 border-dashed border-gray-700 rounded-xl cursor-pointer hover:bg-gray-800 transition-all ${t==="mapa"?"opacity-50":""}`,children:[e.jsx(ce,{className:`w-8 h-8 mb-2 ${t==="mapa"?"animate-bounce":"text-gray-500"}`}),e.jsx("span",{className:"text-xs font-bold text-gray-400",children:m?"Substituir Mapa":"Enviar PDF/Imagem"}),e.jsx("input",{type:"file",className:"hidden",accept:".pdf,image/*",onChange:b=>d(b,"mapa"),disabled:!!t})]}),m&&e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("a",{href:Z.getPublicUrl("estabelecimento",m),target:"_blank",rel:"noreferrer",className:"w-12 h-12 bg-green-500/10 rounded-full flex items-center justify-center text-green-500 border border-green-500/30 hover:bg-green-500/20 transition-colors",children:e.jsx(le,{className:"w-6 h-6"})}),e.jsx("button",{onClick:()=>h("mapa"),className:"w-12 h-12 bg-red-500/10 rounded-full flex items-center justify-center text-red-500 border border-red-500/30 hover:bg-red-500/20 transition-colors",children:e.jsx(ge,{className:"w-5 h-5"})})]})]})]})]}),o&&e.jsx("p",{className:"text-red-400 text-center",children:o}),n&&e.jsx("p",{className:"text-green-400 text-center",children:n})]})},Va=({profile:s,onUpdate:r,initialTab:t})=>{const[a,o]=c.useState("dados");return c.useEffect(()=>{t&&o(t==="portfolio"?"portfolio":t==="specs"?"specs":t==="verificacao"?"verificacao":"dados")},[t]),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap gap-2 border-b border-gray-700 pb-2",children:[e.jsxs("button",{onClick:()=>o("dados"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-bold transition-all ${a==="dados"?"bg-primary text-dark":"text-gray-400 hover:bg-gray-800"}`,children:[e.jsx(de,{className:"w-4 h-4"})," Dados do Local"]}),e.jsxs("button",{onClick:()=>o("portfolio"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-bold transition-all ${a==="portfolio"?"bg-primary text-dark":"text-gray-400 hover:bg-gray-800"}`,children:[e.jsx(Ce,{className:"w-4 h-4"})," Portfólio & Mídia"]}),e.jsxs("button",{onClick:()=>o("specs"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-bold transition-all ${a==="specs"?"bg-primary text-dark":"text-gray-400 hover:bg-gray-800"}`,children:[e.jsx(Ee,{className:"w-4 h-4"})," Especificações Técnicas"]}),e.jsxs("button",{onClick:()=>o("verificacao"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-bold transition-all ${a==="verificacao"?"bg-primary text-dark":"text-gray-400 hover:bg-gray-800"}`,children:[e.jsx(Ze,{className:"w-4 h-4"})," Verificação"]})]}),e.jsxs("div",{className:"animate-fade-in min-h-[500px]",children:[a==="dados"&&e.jsx(qa,{initialProfile:s,onProfileUpdate:r}),a==="portfolio"&&e.jsx(Dt,{profile:s,onUpdate:r}),a==="specs"&&e.jsx(Ua,{profile:s,onUpdate:r}),a==="verificacao"&&e.jsx(Ge,{profile:s,onUpdate:r})]})]})},Wa=({venueProfile:s})=>{const[r,t]=c.useState([]),[a,o]=c.useState(!0),[i,n]=c.useState(""),[l,d]=c.useState(null);c.useEffect(()=>{(async()=>{o(!0);try{const u=await Ye.getMatchesForVenue(s);t(u)}catch(u){n(O(u))}finally{o(!1)}})()},[s]);const h=async m=>{d(m.id);try{const u=await Ye.getJustification(s,m);t(S=>S.map(b=>b.id===m.id?{...b,matchJustification:u}:b))}catch(u){console.error("Matchmaking Insight Error:",u)}finally{d(null)}},f=m=>m.foto_url?Z.getPublicUrl("perfis",m.foto_url):"https://images.unsplash.com/photo-1511379938547-c1f69419868d?q=80&w=2070&auto=format&fit=crop";return e.jsxs("div",{className:"animate-fade-in",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("h2",{className:"text-2xl font-bold font-poppins text-white flex items-center gap-2",children:[e.jsx(ne,{className:"text-primary w-7 h-7"}),"Matchmaking Inteligente"]}),e.jsxs("p",{className:"text-gray-400 text-sm",children:["Artistas que combinam com a vibe do ",s.nome,"."]})]}),a?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(6)].map((m,u)=>e.jsx("div",{className:"bg-gray-850 h-48 rounded-2xl animate-pulse border border-gray-700"},u))}):i?e.jsx("div",{className:"bg-red-500/10 border border-red-500/30 p-6 rounded-xl text-red-400 text-center",children:i}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map(m=>{var u;return e.jsxs("div",{className:"bg-gray-850 rounded-2xl border border-gray-700 overflow-hidden hover:border-primary/50 transition-all group flex flex-col",children:[e.jsxs("div",{className:"p-5 flex-grow",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("img",{src:f(m),className:"w-14 h-14 rounded-full object-cover border-2 border-gray-700 group-hover:border-primary transition-colors",alt:m.nome}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"font-bold text-white truncate",children:m.nome}),e.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-gray-500 font-bold uppercase",children:[e.jsx(ie,{className:"w-3 h-3 text-yellow-500"}),(u=m.artista)==null?void 0:u.genero_musical]})]})]}),m.matchJustification?e.jsx("div",{className:"bg-primary/5 border border-primary/20 p-3 rounded-xl mb-4 animate-fade-in",children:e.jsxs("p",{className:"text-xs italic text-primary-100 leading-relaxed",children:['"',m.matchJustification,'"']})}):e.jsxs("button",{onClick:()=>h(m),disabled:l===m.id,className:"w-full py-2 mb-4 bg-gray-900 border border-gray-700 rounded-xl text-[10px] font-black uppercase tracking-widest text-gray-400 hover:text-white hover:border-primary transition-all flex items-center justify-center gap-2",children:[l===m.id?e.jsx("span",{className:"animate-spin text-lg",children:"⚡"}):e.jsx(ne,{className:"w-3 h-3"}),l===m.id?"Analisando Vibe...":"Por que este artista?"]}),e.jsxs("div",{className:"flex items-center text-[10px] text-gray-500",children:[e.jsx(Me,{className:"w-3 h-3 mr-1"}),m.cidade]})]}),e.jsxs(re,{to:`/artista/${m.id}`,className:"bg-gray-900/50 p-3 border-t border-gray-800 text-center text-xs font-bold text-primary hover:bg-primary hover:text-dark transition-all flex items-center justify-center gap-1",children:["Ver Perfil ",e.jsx(Re,{className:"w-3 h-3"})]})]},m.id)})})]})},dt=[{id:"overview",label:"Visão Geral",icon:e.jsx(ut,{className:"w-5 h-5"})},{id:"matchmaking",label:"Matchmaking",icon:e.jsx(ne,{className:"w-5 h-5"})},{id:"analytics",label:"Analytics",icon:e.jsx(Ne,{className:"w-5 h-5"})},{id:"perfil",label:"Perfil do Local",icon:e.jsx(de,{className:"w-5 h-5"})},{id:"contratos",label:"Contratos",icon:e.jsx(pt,{className:"w-5 h-5"})},{id:"assinatura",label:"Assinatura",icon:e.jsx(Se,{className:"w-5 h-5"})},{id:"avaliacoes",label:"Avaliações",icon:e.jsx(ie,{className:"w-5 h-5"})},{id:"mensagens",label:"Mensagens",icon:e.jsx(ue,{className:"w-5 h-5"})}],Ha=({user:s,initialProfile:r,onProfileUpdate:t,openTab:a})=>{const[o,i]=c.useState("overview"),n=He(),l=ht();c.useEffect(()=>{a&&(["portfolio"].includes(a)?i("perfil"):dt.some(f=>f.id===a)&&i(a),n(l.pathname,{replace:!0}))},[a,n,l.pathname]);const d=()=>{switch(o){case"overview":return e.jsx(Rt,{profile:r,setActiveTab:i});case"matchmaking":return e.jsx(Wa,{venueProfile:r});case"analytics":return e.jsx(Et,{profile:r});case"perfil":return e.jsx(Va,{profile:r,onUpdate:t,initialTab:a==="portfolio"?"portfolio":void 0});case"contratos":return e.jsx(vt,{profile:r});case"assinatura":return e.jsx(Pt,{profile:r});case"avaliacoes":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h3",{className:"text-xl font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx(ie,{className:"w-6 h-6 text-yellow-400"}),"Avaliações do Estabelecimento"]}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Feedback recebido de artistas que tocaram aqui."}),e.jsx(gt,{targetId:r.id})]});case"mensagens":return e.jsx(At,{currentUser:r});default:return null}},h=String(r.nome||s.email||"Usuário");return e.jsx(jt,{title:"Painel do Estabelecimento",subtitle:e.jsxs(e.Fragment,{children:["Bem-vindo(a), ",e.jsx("span",{className:"text-primary font-semibold",children:h}),"!"]}),tabs:dt,activeTab:o,onTabClick:i,profile:r,children:d()})},Is=()=>{const{session:s,profile:r,loading:t,profileMissing:a,refreshProfile:o,error:i}=mt(),n=He(),[l]=Bt(),d=l.get("open");c.useEffect(()=>{t||(s?a&&n("/completar-perfil"):n("/login"))},[s,a,t,n]);const h=async()=>{await o()};return t?e.jsx("div",{className:"flex justify-center items-center h-screen bg-dark",children:e.jsx("div",{className:"text-white text-xl",children:"Carregando painel..."})}):i?e.jsxs("div",{className:"flex flex-col justify-center items-center h-screen bg-dark gap-4 p-4 text-center",children:[e.jsx("h2",{className:"text-red-400 text-xl font-bold",children:"Erro de Conexão"}),e.jsx("p",{className:"text-gray-400 max-w-md",children:i}),e.jsx("button",{onClick:()=>o(),className:"px-6 py-2 bg-primary text-dark font-bold rounded-full hover:bg-opacity-90 transition-all shadow-lg hover:scale-105",children:"Tentar Novamente"})]}):!r||a?e.jsx("div",{className:"flex justify-center items-center h-screen bg-dark",children:e.jsx("div",{className:"text-white text-xl",children:"Carregando perfil..."})}):s!=null&&s.user?e.jsxs("div",{className:"bg-dark text-white font-sans min-h-[calc(100vh-80px)]",children:[e.jsx(ea,{title:"Painel de Controle",description:"Gerencie seu perfil, contratos e notificações no painel do Resona."}),r.tipo==="artista"?e.jsx(Oa,{user:s.user,initialProfile:r,onProfileUpdate:h,openTab:d}):e.jsx(Ha,{user:s.user,initialProfile:r,onProfileUpdate:h,openTab:d})]}):e.jsx("div",{className:"flex justify-center items-center h-screen bg-dark",children:e.jsx("div",{className:"text-white text-xl",children:"Sessão não encontrada. Redirecionando..."})})};export{Is as default};
