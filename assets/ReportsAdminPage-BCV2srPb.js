import{j as e,b as i}from"./index-TxEahy0v.js";import{r as c}from"./vendor-react-Dfcn4nkY.js";import{E as u}from"./vendor-pdf-CuP9pQX9.js";import"./vendor-utils-DmyZJLyO.js";import"./vendor-ui-NgL_OKOJ.js";const y=()=>{const[o,x]=c.useState({artists:0,venues:0,shows:0,contracts:0}),[n,d]=c.useState(!0);c.useEffect(()=>{(async()=>{d(!0);try{const{count:s}=await i.from("usuarios").select("*",{count:"exact",head:!0}).eq("tipo","artista"),{count:r}=await i.from("usuarios").select("*",{count:"exact",head:!0}).eq("tipo","estabelecimento"),{count:l}=await i.from("contratos").select("*",{count:"exact",head:!0}).in("status",["concluido"]),{count:a}=await i.from("contratos").select("*",{count:"exact",head:!0}).in("status",["assinado","concluido"]);x({artists:s||0,venues:r||0,shows:l||0,contracts:a||0})}catch(s){console.error("Error fetching report data:",s)}finally{d(!1)}})()},[]);const m=()=>{const t=new u;t.setFontSize(18),t.text("Relatório Geral - RESONNA",14,20),t.setFontSize(10),t.setTextColor(100),t.text(`Gerado em: ${new Date().toLocaleString("pt-BR")}`,14,28),t.setTextColor(0),t.setFontSize(12);let s=45;t.setFillColor(240,240,240),t.rect(14,s-5,180,10,"F"),t.setFont("helvetica","bold"),t.text("Métrica",16,s),t.text("Valor",150,s),t.setFont("helvetica","normal"),s+=15;const r=(l,a)=>{t.text(l,16,s),t.text(a.toString(),150,s),t.line(14,s+2,194,s+2),s+=10};r("Total de Artistas",o.artists),r("Total de Estabelecimentos",o.venues),r("Shows Realizados",o.shows),r("Contratos Firmados",o.contracts),t.save(`resona_relatorio_${new Date().toISOString().split("T")[0]}.pdf`)};return e.jsxs("div",{className:"text-white",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6 text-primary font-poppins",children:"Relatórios e Métricas Gerais"}),e.jsxs("div",{className:"bg-gray-800 p-4 rounded-lg mb-6 flex flex-col md:flex-row gap-4 items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{htmlFor:"period-filter",children:"Período:"}),e.jsxs("select",{id:"period-filter",className:"bg-gray-900 rounded-md py-2 px-3 focus:outline-none focus:ring-2 focus:ring-secondary",children:[e.jsx("option",{children:"Geral (Todo o período)"}),e.jsx("option",{disabled:!0,children:"Últimos 30 dias (Em breve)"}),e.jsx("option",{disabled:!0,children:"Este ano (Em breve)"})]})]}),e.jsxs("div",{className:"flex-grow flex justify-end gap-2",children:[e.jsx("button",{onClick:m,disabled:n,className:"bg-secondary text-white font-semibold py-2 px-4 rounded-md hover:bg-opacity-80 disabled:opacity-50",children:"Exportar PDF"}),e.jsx("button",{onClick:()=>{const t=["Categoria","Valor"],s=[["Total de Artistas",o.artists],["Total de Estabelecimentos",o.venues],["Shows Realizados",o.shows],["Contratos Firmados",o.contracts]];let r="data:text/csv;charset=utf-8,"+t.join(",")+`
`+s.map(h=>h.join(",")).join(`
`);const l=encodeURI(r),a=document.createElement("a");a.setAttribute("href",l),a.setAttribute("download",`resona_reports_${new Date().toISOString().split("T")[0]}.csv`),document.body.appendChild(a),a.click(),document.body.removeChild(a)},className:"bg-primary text-dark font-bold py-2 px-4 rounded-md hover:bg-opacity-80 transition-all flex items-center gap-2",disabled:n,children:"Exportar CSV"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-gray-800 p-6 rounded-lg text-center",children:[e.jsx("h3",{className:"text-gray-400",children:"Total de Artistas"}),e.jsx("p",{className:"text-4xl font-bold text-white",children:n?"...":o.artists})]}),e.jsxs("div",{className:"bg-gray-800 p-6 rounded-lg text-center",children:[e.jsx("h3",{className:"text-gray-400",children:"Total de Estabelecimentos"}),e.jsx("p",{className:"text-4xl font-bold text-white",children:n?"...":o.venues})]}),e.jsxs("div",{className:"bg-gray-800 p-6 rounded-lg text-center",children:[e.jsx("h3",{className:"text-gray-400",children:"Shows Realizados"}),e.jsx("p",{className:"text-4xl font-bold text-green-400",children:n?"...":o.shows})]}),e.jsxs("div",{className:"bg-gray-800 p-6 rounded-lg text-center",children:[e.jsx("h3",{className:"text-gray-400",children:"Contratos Firmados"}),e.jsx("p",{className:"text-4xl font-bold text-primary",children:n?"...":o.contracts})]})]}),e.jsxs("div",{className:"bg-gray-800 p-6 rounded-lg shadow-lg",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Engajamento Mensal"}),e.jsx("div",{className:"w-full h-80 bg-gray-700 rounded-md flex items-center justify-center",children:e.jsx("p",{className:"text-gray-500",children:"Gráficos detalhados serão implementados em breve."})})]})]})};export{y as default};
