import{a as d,j as e,s as k,e as x}from"./index-Cc-Lnn9x.js";import{r as s}from"./vendor-react-Dfcn4nkY.js";import{C as R}from"./CheckCircleIcon-DMttEdVL.js";import{X as S}from"./XCircleIcon-D5u5_z3n.js";import{E as A}from"./EyeIcon-Bi_pvwfi.js";import{C as u}from"./ConfirmationModal-FOR2G1eE.js";import"./vendor-jspdf-Bh_S0msn.js";import"./vendor-utils-DmyZJLyO.js";import"./vendor-ui-DKtFGipk.js";import"./ExclamationIcon-CXRxAwkS.js";const B=()=>{const[m,f]=s.useState([]),[j,p]=s.useState(!0),[D,E]=s.useState(null),[b,i]=s.useState(!1),[w,l]=s.useState(!1),[a,r]=s.useState(null),[h,v]=s.useState("Documento ilegível"),[g,o]=s.useState(!1);s.useEffect(()=>{c()},[]);const c=async()=>{p(!0);try{const t=await d.listPendingKyc();f(t)}catch(t){console.error(t)}finally{p(!1)}},y=async t=>{try{const n=await k.getSignedUrls("site",[t],300);n.length>0&&window.open(n[0],"_blank")}catch(n){alert("Erro ao gerar link do documento: "+x(n))}},N=async()=>{if(a){o(!0);try{await d.approveKyc(a.id),i(!1),r(null),c()}catch(t){alert(x(t))}finally{o(!1)}}},C=async()=>{if(a){o(!0);try{await d.rejectKyc(a.id,h),l(!1),r(null),c()}catch(t){alert(x(t))}finally{o(!1)}}};return e.jsxs("div",{className:"text-white animate-fade-in pb-12",children:[e.jsxs("div",{className:"flex flex-col mb-12",children:[e.jsxs("h1",{className:"text-heading-hero mb-3 uppercase",children:["VERIFICAÇÕES ",e.jsx("span",{className:"text-primary italic",children:"KYC"})]}),e.jsx("p",{className:"text-section-label text-gray-500",children:"Fila de Verificação de Identidade e Mitigação de Riscos"})]}),e.jsx("div",{className:"glass-card rounded-3xl border-white/5 overflow-hidden shadow-2xl",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{className:"bg-white/5 text-section-label text-gray-400",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-6 pl-10",children:"Identidade da Entidade"}),e.jsx("th",{className:"p-6",children:"Classificação"}),e.jsx("th",{className:"p-6",children:"Data de Submissão"}),e.jsx("th",{className:"p-6 text-right pr-10",children:"Ações"})]})}),e.jsx("tbody",{className:"divide-y divide-white/[0.02] text-sm font-medium",children:j?e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"p-24 text-center text-gray-600 font-black uppercase tracking-widest animate-pulse",children:"Escaneando Dados Biométricos..."})}):m.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:4,className:"p-24 text-center text-gray-600 font-black uppercase tracking-widest leading-premium",children:"Nenhuma solicitação de validação pendente encontrada."})}):m.map(t=>e.jsxs("tr",{className:"hover:bg-white/[0.02] transition-colors group",children:[e.jsx("td",{className:"p-6 pl-10",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-black text-white font-poppins tracking-tight text-lg leading-none uppercase",children:t.nome}),e.jsx("span",{className:"text-[11px] font-mono text-gray-500 mt-1 uppercase tracking-widest",children:t.email})]})}),e.jsx("td",{className:"p-6",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-[9px] font-black uppercase tracking-widest ${t.tipo==="artista"?"bg-purple-500/10 text-purple-400 border border-purple-500/20":"bg-orange-500/10 text-orange-400 border border-orange-500/20"}`,children:t.tipo})}),e.jsx("td",{className:"p-6 text-gray-400 font-mono text-xs",children:new Date(t.criado_em).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric"})}),e.jsxs("td",{className:"p-6 text-right flex justify-end gap-3 pr-10",children:[e.jsx("button",{onClick:()=>t.documento_url&&y(t.documento_url),className:"w-10 h-10 flex items-center justify-center bg-white/5 hover:bg-white/10 border border-white/10 rounded-xl text-white shadow-xl transition-all active:scale-90 group/btn",title:"Ver Documento",children:e.jsx(A,{className:"w-5 h-5 group-hover/btn:text-primary transition-colors"})}),e.jsx("button",{onClick:()=>{r(t),i(!0)},className:"w-10 h-10 flex items-center justify-center bg-green-500/10 hover:bg-green-500 border border-green-500/20 rounded-xl text-green-400 hover:text-dark shadow-xl transition-all active:scale-90",title:"Conceder Acesso",children:e.jsx(R,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>{r(t),l(!0)},className:"w-10 h-10 flex items-center justify-center bg-red-500/10 hover:bg-red-500 border border-red-500/20 rounded-xl text-red-500 hover:text-white shadow-xl transition-all active:scale-90",title:"Revogar Protocolo",children:e.jsx(S,{className:"w-5 h-5"})})]})]},t.id))})]})})}),e.jsx(u,{isOpen:b,onClose:()=>i(!1),onConfirm:N,title:"Aprovar Verificação",message:e.jsxs("p",{children:["Você confirma que o documento enviado por ",e.jsx("strong",{children:a==null?void 0:a.nome})," é válido e legível?"]}),confirmText:"Confirmar",isConfirming:g}),e.jsx(u,{isOpen:w,onClose:()=>l(!1),onConfirm:C,title:"Rejeitar Verificação",message:e.jsxs("div",{children:[e.jsx("p",{children:"Por que este documento está sendo rejeitado?"}),e.jsxs("select",{value:h,onChange:t=>v(t.target.value),className:"w-full mt-3 bg-gray-900 border border-gray-700 rounded p-2 text-sm text-white",children:[e.jsx("option",{children:"Documento ilegível"}),e.jsx("option",{children:"Foto cortada"}),e.jsx("option",{children:"Documento expirado"}),e.jsx("option",{children:"Identidade não corresponde ao nome"}),e.jsx("option",{children:"Outros motivos"})]})]}),confirmText:"Rejeitar",isConfirming:g})]})};export{B as default};
