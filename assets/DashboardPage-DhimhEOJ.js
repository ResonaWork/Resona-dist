import{j as e,d as pt,s as Z,C as Ie,e as q,u as $t,a as Q,f as Ft,g as Te,m as Le,b as we,n as Tt,c as ut,p as Ke,h as Lt,B as Qe,i as Bt,k as Be,l as et}from"./index-Cc-Lnn9x.js";import{R as Ot,L as oe,g as qt,r as c,u as Xe,c as gt,h as Ut}from"./vendor-react-Dfcn4nkY.js";import{U as pe}from"./UserCircleIcon-DFsE5r8q.js";import{F as ft}from"./FileSignatureIcon-CkuZe52x.js";import{M as xe}from"./MessagesIcon-CtD9Vrd5.js";import{H as bt}from"./HomeIcon-Co4EpK3a.js";import{C as Se}from"./CalendarIcon-0MO10zqJ.js";import{T as _e}from"./TrendingUpIcon-DLISoJx4.js";import{C as De}from"./CreditCardIcon-OXjEnC_f.js";import{E as Vt}from"./EyeIcon-Bi_pvwfi.js";import{U as he}from"./UploadIcon-B6cBKZfY.js";import{C as me,R as vt}from"./ReviewList-Dv1pMO-J.js";import{_ as Wt,a as K}from"./vendor-utils-DmyZJLyO.js";import{P as ke}from"./PhotographIcon-BhsB4Orm.js";import{E as Ce}from"./ExclamationIcon-CXRxAwkS.js";import{M as $e}from"./MapPinIcon-CPSUTHrZ.js";import{i as fe,C as Ht,a as Gt}from"./ChevronLeftIcon-BkDyRmha.js";import{F as Pe}from"./FileIcon-2gY8woLq.js";import{T as ve}from"./TrashIcon-Dw3P_7Ho.js";import{M as Oe}from"./MusicNoteIcon-Cbxbf2rT.js";import{S as ce}from"./SparklesIcon-DK3M7bKx.js";import{E as Me}from"./EmptyState-DsZCot8O.js";import{C as ne}from"./CheckCircleIcon-DMttEdVL.js";import{C as ye}from"./ClockIcon-BsQhkGky.js";import{P as yt}from"./PlusIcon-CPWUX53x.js";import{C as Zt}from"./ConfirmationModal-FOR2G1eE.js";import{U as jt}from"./UsersIcon-DGnNkzTA.js";import{S as Je}from"./ShieldIcon-i263Zeox.js";import{X as Xt}from"./XCircleIcon-D5u5_z3n.js";import{L as Ze}from"./LockClosedIcon-BhEtnb0z.js";import{S as le}from"./StarIcon-CdQqkD5t.js";import{S as Jt}from"./SearchIcon-DH3o1suK.js";import{A as Yt}from"./ArrowLeftIcon-C5GOjwQg.js";import{C as wt}from"./ContractsList-CyeR07Fc.js";import{C as ze}from"./ChevronRightIcon-DOOHeMMz.js";import{D as Kt}from"./DownloadIcon-UF4vjtv3.js";import{i as be,c as Nt,g as Qt,a as ea,b as ta}from"./financeUtils-CtoX7Xu7.js";import{T as $,B as de}from"./Typography-iwUwUy6J.js";import{C as ie}from"./Card-CgSqHIek.js";import{T as aa}from"./TrophyIcon-Z6L4xw3A.js";import{S as sa}from"./SEO-BrO4Q3VS.js";import"./vendor-jspdf-Bh_S0msn.js";import"./vendor-ui-DKtFGipk.js";import"./CreateContractModal-CqyQF2Zo.js";const Ct=({title:s,subtitle:r,tabs:t,activeTab:a,onTabClick:i,children:n,profile:o})=>{var f,m;const[l,d]=Ot.useState(!1),x=({id:u,label:S,icon:b})=>e.jsxs("button",{onClick:()=>i(u),className:`snap-start flex items-center gap-2 px-6 py-4 text-[11px] font-black uppercase tracking-widest rounded-2xl transition-all whitespace-nowrap outline-none ${a===u?"bg-secondary text-white shadow-lg shadow-secondary/20":"text-gray-400 hover:bg-white/5 hover:text-white"}`,children:[b,S]});return e.jsxs(e.Fragment,{children:[e.jsx("section",{className:"bg-transparent py-10",children:e.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl md:text-6xl font-black text-white font-poppins tracking-tighter leading-none uppercase",children:s}),e.jsx("p",{className:"mt-3 text-section-label text-gray-500",children:r})]}),e.jsx("div",{className:"flex-shrink-0",children:e.jsxs(oe,{to:`/${o.tipo}/${o.id}`,className:"flex items-center gap-2 bg-white/5 hover:bg-white/10 text-white text-[10px] font-black uppercase tracking-widest py-4 px-8 rounded-full border border-white/10 transition-all justify-center w-full sm:w-auto active:scale-95",children:[e.jsx(Vt,{className:"w-5 h-5"}),"Ver Perfil Público"]})})]})})}),e.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-6 md:py-12 min-w-0",children:[e.jsxs("div",{className:`lg:hidden mb-6 w-full relative ${l?"z-50":"z-20"}`,children:[e.jsxs("button",{onClick:()=>d(!l),className:"w-full flex items-center justify-between bg-gray-800 border border-gray-700 text-white rounded-lg py-3 px-4 shadow-sm hover:border-gray-500 transition-colors",children:[e.jsxs("span",{className:"flex items-center gap-3 font-medium",children:[(f=t.find(u=>u.id===a))==null?void 0:f.icon,(m=t.find(u=>u.id===a))==null?void 0:m.label]}),e.jsx("svg",{className:`h-5 w-5 text-gray-400 transition-transform ${l?"rotate-180":""}`,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})]}),l&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>d(!1)}),e.jsx("div",{className:"absolute top-full left-0 right-0 mt-2 bg-gray-800 border border-gray-700 rounded-lg shadow-xl z-50 max-h-80 overflow-y-auto animate-fade-in",children:t.map(u=>e.jsxs("button",{onClick:()=>{i(u.id),d(!1)},className:`w-full text-left px-4 py-3 flex items-center gap-3 hover:bg-gray-700 transition-colors border-b border-gray-700/50 last:border-0 ${a===u.id?"text-primary bg-gray-700/30 font-bold":"text-gray-300"}`,children:[u.icon,u.label]},u.id))})]})]}),e.jsx("div",{className:"hidden lg:block relative mb-6",children:e.jsx("div",{className:"flex items-center gap-2 border-b border-gray-700 pb-2 overflow-x-auto whitespace-nowrap scrollbar-hide snap-x snap-mandatory px-0",children:t.map(u=>e.jsx(x,{...u},u.id))})}),e.jsx("div",{className:"glass-card p-6 sm:p-10 md:p-12 rounded-3xl border-white/5 overflow-hidden min-w-0",children:n})]}),e.jsx("style",{children:".input-style { display: block; width: 100%; background-color: #1f2937; border: 1px solid #4b5563; border-radius: 0.375rem; padding: 0.75rem; font-size: 1rem; color: white; transition: border-color 0.2s, box-shadow 0.2s; } .input-style:focus { outline: none; border-color: #51D2EE; box-shadow: 0 0 0 2px rgba(81, 210, 238, 0.5); }"})]})};var qe,tt;function ra(){if(tt)return qe;tt=1;var s=!1,r,t,a,i,n,o,l,d,x,f,m,u,S,b,w;function D(){if(!s){s=!0;var A=navigator.userAgent,y=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(A),j=/(Mac OS X)|(Windows)|(Linux)/.exec(A);if(u=/\b(iPhone|iP[ao]d)/.exec(A),S=/\b(iP[ao]d)/.exec(A),f=/Android/i.exec(A),b=/FBAN\/\w+;/i.exec(A),w=/Mobile/i.exec(A),m=!!/Win64/.exec(A),y){r=y[1]?parseFloat(y[1]):y[5]?parseFloat(y[5]):NaN,r&&document&&document.documentMode&&(r=document.documentMode);var R=/(?:Trident\/(\d+.\d+))/.exec(A);o=R?parseFloat(R[1])+4:r,t=y[2]?parseFloat(y[2]):NaN,a=y[3]?parseFloat(y[3]):NaN,i=y[4]?parseFloat(y[4]):NaN,i?(y=/(?:Chrome\/(\d+\.\d+))/.exec(A),n=y&&y[1]?parseFloat(y[1]):NaN):n=NaN}else r=t=a=n=i=NaN;if(j){if(j[1]){var P=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(A);l=P?parseFloat(P[1].replace("_",".")):!0}else l=!1;d=!!j[2],x=!!j[3]}else l=d=x=!1}}var M={ie:function(){return D()||r},ieCompatibilityMode:function(){return D()||o>r},ie64:function(){return M.ie()&&m},firefox:function(){return D()||t},opera:function(){return D()||a},webkit:function(){return D()||i},safari:function(){return M.webkit()},chrome:function(){return D()||n},windows:function(){return D()||d},osx:function(){return D()||l},linux:function(){return D()||x},iphone:function(){return D()||u},mobile:function(){return D()||u||S||f||w},nativeApp:function(){return D()||b},android:function(){return D()||f},ipad:function(){return D()||S}};return qe=M,qe}var Ue,at;function ia(){if(at)return Ue;at=1;var s=!!(typeof window<"u"&&window.document&&window.document.createElement),r={canUseDOM:s,canUseWorkers:typeof Worker<"u",canUseEventListeners:s&&!!(window.addEventListener||window.attachEvent),canUseViewport:s&&!!window.screen,isInWorker:!s};return Ue=r,Ue}var Ve,st;function oa(){if(st)return Ve;st=1;var s=ia(),r;s.canUseDOM&&(r=document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0);/**
 * Checks if an event is supported in the current execution environment.
 *
 * NOTE: This will not work correctly for non-generic events such as `change`,
 * `reset`, `load`, `error`, and `select`.
 *
 * Borrows from Modernizr.
 *
 * @param {string} eventNameSuffix Event name, e.g. "click".
 * @param {?boolean} capture Check if the capture phase is supported.
 * @return {boolean} True if the event is supported.
 * @internal
 * @license Modernizr 3.0.0pre (Custom Build) | MIT
 */function t(a,i){if(!s.canUseDOM||i&&!("addEventListener"in document))return!1;var n="on"+a,o=n in document;if(!o){var l=document.createElement("div");l.setAttribute(n,"return;"),o=typeof l[n]=="function"}return!o&&r&&a==="wheel"&&(o=document.implementation.hasFeature("Events.wheel","3.0")),o}return Ve=t,Ve}var We,rt;function na(){if(rt)return We;rt=1;var s=ra(),r=oa(),t=10,a=40,i=800;function n(o){var l=0,d=0,x=0,f=0;return"detail"in o&&(d=o.detail),"wheelDelta"in o&&(d=-o.wheelDelta/120),"wheelDeltaY"in o&&(d=-o.wheelDeltaY/120),"wheelDeltaX"in o&&(l=-o.wheelDeltaX/120),"axis"in o&&o.axis===o.HORIZONTAL_AXIS&&(l=d,d=0),x=l*t,f=d*t,"deltaY"in o&&(f=o.deltaY),"deltaX"in o&&(x=o.deltaX),(x||f)&&o.deltaMode&&(o.deltaMode==1?(x*=a,f*=a):(x*=i,f*=i)),x&&!l&&(l=x<1?-1:1),f&&!d&&(d=f<1?-1:1),{spinX:l,spinY:d,pixelX:x,pixelY:f}}return n.getEventType=function(){return s.firefox()?"DOMMouseScroll":r("wheel")?"wheel":"mousewheel"},We=n,We}var He,it;function la(){return it||(it=1,He=na()),He}var ca=la();const da=qt(ca);function ma(s,r,t,a,i,n){n===void 0&&(n=0);var o=je(s,r,n),l=o.width,d=o.height,x=Math.min(l,t),f=Math.min(d,a);return x>f*i?{width:f*i,height:f}:{width:x,height:x/i}}function ha(s){return s.width>s.height?s.width/s.naturalWidth:s.height/s.naturalHeight}function Ne(s,r,t,a,i){i===void 0&&(i=0);var n=je(r.width,r.height,i),o=n.width,l=n.height;return{x:ot(s.x,o,t.width,a),y:ot(s.y,l,t.height,a)}}function ot(s,r,t,a){var i=r*a/2-t/2;return Fe(s,-i,i)}function nt(s,r){return Math.sqrt(Math.pow(s.y-r.y,2)+Math.pow(s.x-r.x,2))}function lt(s,r){return Math.atan2(r.y-s.y,r.x-s.x)*180/Math.PI}function xa(s,r,t,a,i,n,o){n===void 0&&(n=0),o===void 0&&(o=!0);var l=o?pa:ua,d=je(r.width,r.height,n),x=je(r.naturalWidth,r.naturalHeight,n),f={x:l(100,((d.width-t.width/i)/2-s.x/i)/d.width*100),y:l(100,((d.height-t.height/i)/2-s.y/i)/d.height*100),width:l(100,t.width/d.width*100/i),height:l(100,t.height/d.height*100/i)},m=Math.round(l(x.width,f.width*x.width/100)),u=Math.round(l(x.height,f.height*x.height/100)),S=x.width>=x.height*a,b=S?{width:Math.round(u*a),height:u}:{width:m,height:Math.round(m/a)},w=K(K({},b),{x:Math.round(l(x.width-b.width,f.x*x.width/100)),y:Math.round(l(x.height-b.height,f.y*x.height/100))});return{croppedAreaPercentages:f,croppedAreaPixels:w}}function pa(s,r){return Math.min(s,Math.max(0,r))}function ua(s,r){return r}function ga(s,r,t,a,i,n){var o=je(r.width,r.height,t),l=Fe(a.width/o.width*(100/s.width),i,n),d={x:l*o.width/2-a.width/2-o.width*l*(s.x/100),y:l*o.height/2-a.height/2-o.height*l*(s.y/100)};return{crop:d,zoom:l}}function fa(s,r,t){var a=ha(r);return t.height>t.width?t.height/(s.height*a):t.width/(s.width*a)}function ba(s,r,t,a,i,n){t===void 0&&(t=0);var o=je(r.naturalWidth,r.naturalHeight,t),l=Fe(fa(s,r,a),i,n),d=a.height>a.width?a.height/s.height:a.width/s.width,x={x:((o.width-s.width)/2-s.x)*d,y:((o.height-s.height)/2-s.y)*d};return{crop:x,zoom:l}}function ct(s,r){return{x:(r.x+s.x)/2,y:(r.y+s.y)/2}}function va(s){return s*Math.PI/180}function je(s,r,t){var a=va(t);return{width:Math.abs(Math.cos(a)*s)+Math.abs(Math.sin(a)*r),height:Math.abs(Math.sin(a)*s)+Math.abs(Math.cos(a)*r)}}function Fe(s,r,t){return Math.min(Math.max(s,r),t)}function Re(){for(var s=[],r=0;r<arguments.length;r++)s[r]=arguments[r];return s.filter(function(t){return typeof t=="string"&&t.length>0}).join(" ").trim()}var ya=`.reactEasyCrop_Container {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  overflow: hidden;
  user-select: none;
  touch-action: none;
  cursor: move;
  display: flex;
  justify-content: center;
  align-items: center;
}

.reactEasyCrop_Image,
.reactEasyCrop_Video {
  will-change: transform; /* this improves performances and prevent painting issues on iOS Chrome */
}

.reactEasyCrop_Contain {
  max-width: 100%;
  max-height: 100%;
  margin: auto;
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
}
.reactEasyCrop_Cover_Horizontal {
  width: 100%;
  height: auto;
}
.reactEasyCrop_Cover_Vertical {
  width: auto;
  height: 100%;
}

.reactEasyCrop_CropArea {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  border: 1px solid rgba(255, 255, 255, 0.5);
  box-sizing: border-box;
  box-shadow: 0 0 0 9999em;
  color: rgba(0, 0, 0, 0.5);
  overflow: hidden;
}

.reactEasyCrop_CropAreaRound {
  border-radius: 50%;
}

.reactEasyCrop_CropAreaGrid::before {
  content: ' ';
  box-sizing: border-box;
  position: absolute;
  border: 1px solid rgba(255, 255, 255, 0.5);
  top: 0;
  bottom: 0;
  left: 33.33%;
  right: 33.33%;
  border-top: 0;
  border-bottom: 0;
}

.reactEasyCrop_CropAreaGrid::after {
  content: ' ';
  box-sizing: border-box;
  position: absolute;
  border: 1px solid rgba(255, 255, 255, 0.5);
  top: 33.33%;
  bottom: 33.33%;
  left: 0;
  right: 0;
  border-left: 0;
  border-right: 0;
}
`,ja=1,wa=3,Na=1,St=(function(s){Wt(r,s);function r(){var t=s!==null&&s.apply(this,arguments)||this;return t.cropperRef=c.createRef(),t.imageRef=c.createRef(),t.videoRef=c.createRef(),t.containerPosition={x:0,y:0},t.containerRef=null,t.styleRef=null,t.containerRect=null,t.mediaSize={width:0,height:0,naturalWidth:0,naturalHeight:0},t.dragStartPosition={x:0,y:0},t.dragStartCrop={x:0,y:0},t.gestureZoomStart=0,t.gestureRotationStart=0,t.isTouching=!1,t.lastPinchDistance=0,t.lastPinchRotation=0,t.rafDragTimeout=null,t.rafPinchTimeout=null,t.wheelTimer=null,t.currentDoc=typeof document<"u"?document:null,t.currentWindow=typeof window<"u"?window:null,t.resizeObserver=null,t.previousCropSize=null,t.isInitialized=!1,t.state={cropSize:null,hasWheelJustStarted:!1,mediaObjectFit:void 0},t.initResizeObserver=function(){if(!(typeof window.ResizeObserver>"u"||!t.containerRef)){var a=!0;t.resizeObserver=new window.ResizeObserver(function(i){if(a){a=!1;return}t.computeSizes()}),t.resizeObserver.observe(t.containerRef)}},t.preventZoomSafari=function(a){return a.preventDefault()},t.cleanEvents=function(){t.currentDoc&&(t.currentDoc.removeEventListener("mousemove",t.onMouseMove),t.currentDoc.removeEventListener("mouseup",t.onDragStopped),t.currentDoc.removeEventListener("touchmove",t.onTouchMove),t.currentDoc.removeEventListener("touchend",t.onDragStopped),t.currentDoc.removeEventListener("gesturechange",t.onGestureChange),t.currentDoc.removeEventListener("gestureend",t.onGestureEnd),t.currentDoc.removeEventListener("scroll",t.onScroll))},t.clearScrollEvent=function(){t.containerRef&&t.containerRef.removeEventListener("wheel",t.onWheel),t.wheelTimer&&clearTimeout(t.wheelTimer)},t.onMediaLoad=function(){var a=t.computeSizes();a&&(t.previousCropSize=a,t.emitCropData(),t.setInitialCrop(a),t.isInitialized=!0),t.props.onMediaLoaded&&t.props.onMediaLoaded(t.mediaSize)},t.setInitialCrop=function(a){if(t.props.initialCroppedAreaPercentages){var i=ga(t.props.initialCroppedAreaPercentages,t.mediaSize,t.props.rotation,a,t.props.minZoom,t.props.maxZoom),n=i.crop,o=i.zoom;t.props.onCropChange(n),t.props.onZoomChange&&t.props.onZoomChange(o)}else if(t.props.initialCroppedAreaPixels){var l=ba(t.props.initialCroppedAreaPixels,t.mediaSize,t.props.rotation,a,t.props.minZoom,t.props.maxZoom),n=l.crop,o=l.zoom;t.props.onCropChange(n),t.props.onZoomChange&&t.props.onZoomChange(o)}},t.computeSizes=function(){var a,i,n,o,l,d,x=t.imageRef.current||t.videoRef.current;if(x&&t.containerRef){t.containerRect=t.containerRef.getBoundingClientRect(),t.saveContainerPosition();var f=t.containerRect.width/t.containerRect.height,m=((a=t.imageRef.current)===null||a===void 0?void 0:a.naturalWidth)||((i=t.videoRef.current)===null||i===void 0?void 0:i.videoWidth)||0,u=((n=t.imageRef.current)===null||n===void 0?void 0:n.naturalHeight)||((o=t.videoRef.current)===null||o===void 0?void 0:o.videoHeight)||0,S=x.offsetWidth<m||x.offsetHeight<u,b=m/u,w=void 0;if(S)switch(t.state.mediaObjectFit){default:case"contain":w=f>b?{width:t.containerRect.height*b,height:t.containerRect.height}:{width:t.containerRect.width,height:t.containerRect.width/b};break;case"horizontal-cover":w={width:t.containerRect.width,height:t.containerRect.width/b};break;case"vertical-cover":w={width:t.containerRect.height*b,height:t.containerRect.height};break}else w={width:x.offsetWidth,height:x.offsetHeight};t.mediaSize=K(K({},w),{naturalWidth:m,naturalHeight:u}),t.props.setMediaSize&&t.props.setMediaSize(t.mediaSize);var D=t.props.cropSize?t.props.cropSize:ma(t.mediaSize.width,t.mediaSize.height,t.containerRect.width,t.containerRect.height,t.props.aspect,t.props.rotation);return(((l=t.state.cropSize)===null||l===void 0?void 0:l.height)!==D.height||((d=t.state.cropSize)===null||d===void 0?void 0:d.width)!==D.width)&&t.props.onCropSizeChange&&t.props.onCropSizeChange(D),t.setState({cropSize:D},t.recomputeCropPosition),t.props.setCropSize&&t.props.setCropSize(D),D}},t.saveContainerPosition=function(){if(t.containerRef){var a=t.containerRef.getBoundingClientRect();t.containerPosition={x:a.left,y:a.top}}},t.onMouseDown=function(a){t.currentDoc&&(a.preventDefault(),t.currentDoc.addEventListener("mousemove",t.onMouseMove),t.currentDoc.addEventListener("mouseup",t.onDragStopped),t.saveContainerPosition(),t.onDragStart(r.getMousePoint(a)))},t.onMouseMove=function(a){return t.onDrag(r.getMousePoint(a))},t.onScroll=function(a){t.currentDoc&&(a.preventDefault(),t.saveContainerPosition())},t.onTouchStart=function(a){t.currentDoc&&(t.isTouching=!0,!(t.props.onTouchRequest&&!t.props.onTouchRequest(a))&&(t.currentDoc.addEventListener("touchmove",t.onTouchMove,{passive:!1}),t.currentDoc.addEventListener("touchend",t.onDragStopped),t.saveContainerPosition(),a.touches.length===2?t.onPinchStart(a):a.touches.length===1&&t.onDragStart(r.getTouchPoint(a.touches[0]))))},t.onTouchMove=function(a){a.preventDefault(),a.touches.length===2?t.onPinchMove(a):a.touches.length===1&&t.onDrag(r.getTouchPoint(a.touches[0]))},t.onGestureStart=function(a){t.currentDoc&&(a.preventDefault(),t.currentDoc.addEventListener("gesturechange",t.onGestureChange),t.currentDoc.addEventListener("gestureend",t.onGestureEnd),t.gestureZoomStart=t.props.zoom,t.gestureRotationStart=t.props.rotation)},t.onGestureChange=function(a){if(a.preventDefault(),!t.isTouching){var i=r.getMousePoint(a),n=t.gestureZoomStart-1+a.scale;if(t.setNewZoom(n,i,{shouldUpdatePosition:!0}),t.props.onRotationChange){var o=t.gestureRotationStart+a.rotation;t.props.onRotationChange(o)}}},t.onGestureEnd=function(a){t.cleanEvents()},t.onDragStart=function(a){var i,n,o=a.x,l=a.y;t.dragStartPosition={x:o,y:l},t.dragStartCrop=K({},t.props.crop),(n=(i=t.props).onInteractionStart)===null||n===void 0||n.call(i)},t.onDrag=function(a){var i=a.x,n=a.y;t.currentWindow&&(t.rafDragTimeout&&t.currentWindow.cancelAnimationFrame(t.rafDragTimeout),t.rafDragTimeout=t.currentWindow.requestAnimationFrame(function(){if(t.state.cropSize&&!(i===void 0||n===void 0)){var o=i-t.dragStartPosition.x,l=n-t.dragStartPosition.y,d={x:t.dragStartCrop.x+o,y:t.dragStartCrop.y+l},x=t.props.restrictPosition?Ne(d,t.mediaSize,t.state.cropSize,t.props.zoom,t.props.rotation):d;t.props.onCropChange(x)}}))},t.onDragStopped=function(){var a,i;t.isTouching=!1,t.cleanEvents(),t.emitCropData(),(i=(a=t.props).onInteractionEnd)===null||i===void 0||i.call(a)},t.onWheel=function(a){if(t.currentWindow&&!(t.props.onWheelRequest&&!t.props.onWheelRequest(a))){a.preventDefault();var i=r.getMousePoint(a),n=da(a).pixelY,o=t.props.zoom-n*t.props.zoomSpeed/200;t.setNewZoom(o,i,{shouldUpdatePosition:!0}),t.state.hasWheelJustStarted||t.setState({hasWheelJustStarted:!0},function(){var l,d;return(d=(l=t.props).onInteractionStart)===null||d===void 0?void 0:d.call(l)}),t.wheelTimer&&clearTimeout(t.wheelTimer),t.wheelTimer=t.currentWindow.setTimeout(function(){return t.setState({hasWheelJustStarted:!1},function(){var l,d;return(d=(l=t.props).onInteractionEnd)===null||d===void 0?void 0:d.call(l)})},250)}},t.getPointOnContainer=function(a,i){var n=a.x,o=a.y;if(!t.containerRect)throw new Error("The Cropper is not mounted");return{x:t.containerRect.width/2-(n-i.x),y:t.containerRect.height/2-(o-i.y)}},t.getPointOnMedia=function(a){var i=a.x,n=a.y,o=t.props,l=o.crop,d=o.zoom;return{x:(i+l.x)/d,y:(n+l.y)/d}},t.setNewZoom=function(a,i,n){var o=n===void 0?{}:n,l=o.shouldUpdatePosition,d=l===void 0?!0:l;if(!(!t.state.cropSize||!t.props.onZoomChange)){var x=Fe(a,t.props.minZoom,t.props.maxZoom);if(d){var f=t.getPointOnContainer(i,t.containerPosition),m=t.getPointOnMedia(f),u={x:m.x*x-f.x,y:m.y*x-f.y},S=t.props.restrictPosition?Ne(u,t.mediaSize,t.state.cropSize,x,t.props.rotation):u;t.props.onCropChange(S)}t.props.onZoomChange(x)}},t.getCropData=function(){if(!t.state.cropSize)return null;var a=t.props.restrictPosition?Ne(t.props.crop,t.mediaSize,t.state.cropSize,t.props.zoom,t.props.rotation):t.props.crop;return xa(a,t.mediaSize,t.state.cropSize,t.getAspect(),t.props.zoom,t.props.rotation,t.props.restrictPosition)},t.emitCropData=function(){var a=t.getCropData();if(a){var i=a.croppedAreaPercentages,n=a.croppedAreaPixels;t.props.onCropComplete&&t.props.onCropComplete(i,n),t.props.onCropAreaChange&&t.props.onCropAreaChange(i,n)}},t.emitCropAreaChange=function(){var a=t.getCropData();if(a){var i=a.croppedAreaPercentages,n=a.croppedAreaPixels;t.props.onCropAreaChange&&t.props.onCropAreaChange(i,n)}},t.recomputeCropPosition=function(){var a,i;if(t.state.cropSize){var n=t.props.crop;if(t.isInitialized&&(!((a=t.previousCropSize)===null||a===void 0)&&a.width)&&(!((i=t.previousCropSize)===null||i===void 0)&&i.height)){var o=Math.abs(t.previousCropSize.width-t.state.cropSize.width)>1e-6||Math.abs(t.previousCropSize.height-t.state.cropSize.height)>1e-6;if(o){var l=t.state.cropSize.width/t.previousCropSize.width,d=t.state.cropSize.height/t.previousCropSize.height;n={x:t.props.crop.x*l,y:t.props.crop.y*d}}}var x=t.props.restrictPosition?Ne(n,t.mediaSize,t.state.cropSize,t.props.zoom,t.props.rotation):n;t.previousCropSize=t.state.cropSize,t.props.onCropChange(x),t.emitCropData()}},t.onKeyDown=function(a){var i,n,o=t.props,l=o.crop,d=o.onCropChange,x=o.keyboardStep,f=o.zoom,m=o.rotation,u=x;if(t.state.cropSize){a.shiftKey&&(u*=.2);var S=K({},l);switch(a.key){case"ArrowUp":S.y-=u,a.preventDefault();break;case"ArrowDown":S.y+=u,a.preventDefault();break;case"ArrowLeft":S.x-=u,a.preventDefault();break;case"ArrowRight":S.x+=u,a.preventDefault();break;default:return}t.props.restrictPosition&&(S=Ne(S,t.mediaSize,t.state.cropSize,f,m)),a.repeat||(n=(i=t.props).onInteractionStart)===null||n===void 0||n.call(i),d(S)}},t.onKeyUp=function(a){var i,n;switch(a.key){case"ArrowUp":case"ArrowDown":case"ArrowLeft":case"ArrowRight":a.preventDefault();break;default:return}t.emitCropData(),(n=(i=t.props).onInteractionEnd)===null||n===void 0||n.call(i)},t}return r.prototype.componentDidMount=function(){!this.currentDoc||!this.currentWindow||(this.containerRef&&(this.containerRef.ownerDocument&&(this.currentDoc=this.containerRef.ownerDocument),this.currentDoc.defaultView&&(this.currentWindow=this.currentDoc.defaultView),this.initResizeObserver(),typeof window.ResizeObserver>"u"&&this.currentWindow.addEventListener("resize",this.computeSizes),this.props.zoomWithScroll&&this.containerRef.addEventListener("wheel",this.onWheel,{passive:!1}),this.containerRef.addEventListener("gesturestart",this.onGestureStart)),this.currentDoc.addEventListener("scroll",this.onScroll),this.props.disableAutomaticStylesInjection||(this.styleRef=this.currentDoc.createElement("style"),this.styleRef.setAttribute("type","text/css"),this.props.nonce&&this.styleRef.setAttribute("nonce",this.props.nonce),this.styleRef.innerHTML=ya,this.currentDoc.head.appendChild(this.styleRef)),this.imageRef.current&&this.imageRef.current.complete&&this.onMediaLoad(),this.props.setImageRef&&this.props.setImageRef(this.imageRef),this.props.setVideoRef&&this.props.setVideoRef(this.videoRef),this.props.setCropperRef&&this.props.setCropperRef(this.cropperRef))},r.prototype.componentWillUnmount=function(){var t,a;!this.currentDoc||!this.currentWindow||(typeof window.ResizeObserver>"u"&&this.currentWindow.removeEventListener("resize",this.computeSizes),(t=this.resizeObserver)===null||t===void 0||t.disconnect(),this.containerRef&&this.containerRef.removeEventListener("gesturestart",this.preventZoomSafari),this.styleRef&&((a=this.styleRef.parentNode)===null||a===void 0||a.removeChild(this.styleRef)),this.cleanEvents(),this.props.zoomWithScroll&&this.clearScrollEvent())},r.prototype.componentDidUpdate=function(t){var a,i,n,o,l,d,x,f,m;t.rotation!==this.props.rotation?(this.computeSizes(),this.recomputeCropPosition()):t.aspect!==this.props.aspect?this.computeSizes():t.objectFit!==this.props.objectFit?this.computeSizes():t.zoom!==this.props.zoom?this.recomputeCropPosition():((a=t.cropSize)===null||a===void 0?void 0:a.height)!==((i=this.props.cropSize)===null||i===void 0?void 0:i.height)||((n=t.cropSize)===null||n===void 0?void 0:n.width)!==((o=this.props.cropSize)===null||o===void 0?void 0:o.width)?this.computeSizes():(((l=t.crop)===null||l===void 0?void 0:l.x)!==((d=this.props.crop)===null||d===void 0?void 0:d.x)||((x=t.crop)===null||x===void 0?void 0:x.y)!==((f=this.props.crop)===null||f===void 0?void 0:f.y))&&this.emitCropAreaChange(),t.zoomWithScroll!==this.props.zoomWithScroll&&this.containerRef&&(this.props.zoomWithScroll?this.containerRef.addEventListener("wheel",this.onWheel,{passive:!1}):this.clearScrollEvent()),t.video!==this.props.video&&((m=this.videoRef.current)===null||m===void 0||m.load());var u=this.getObjectFit();u!==this.state.mediaObjectFit&&this.setState({mediaObjectFit:u},this.computeSizes)},r.prototype.getAspect=function(){var t=this.props,a=t.cropSize,i=t.aspect;return a?a.width/a.height:i},r.prototype.getObjectFit=function(){var t,a,i,n;if(this.props.objectFit==="cover"){var o=this.imageRef.current||this.videoRef.current;if(o&&this.containerRef){this.containerRect=this.containerRef.getBoundingClientRect();var l=this.containerRect.width/this.containerRect.height,d=((t=this.imageRef.current)===null||t===void 0?void 0:t.naturalWidth)||((a=this.videoRef.current)===null||a===void 0?void 0:a.videoWidth)||0,x=((i=this.imageRef.current)===null||i===void 0?void 0:i.naturalHeight)||((n=this.videoRef.current)===null||n===void 0?void 0:n.videoHeight)||0,f=d/x;return f<l?"horizontal-cover":"vertical-cover"}return"horizontal-cover"}return this.props.objectFit},r.prototype.onPinchStart=function(t){var a=r.getTouchPoint(t.touches[0]),i=r.getTouchPoint(t.touches[1]);this.lastPinchDistance=nt(a,i),this.lastPinchRotation=lt(a,i),this.onDragStart(ct(a,i))},r.prototype.onPinchMove=function(t){var a=this;if(!(!this.currentDoc||!this.currentWindow)){var i=r.getTouchPoint(t.touches[0]),n=r.getTouchPoint(t.touches[1]),o=ct(i,n);this.onDrag(o),this.rafPinchTimeout&&this.currentWindow.cancelAnimationFrame(this.rafPinchTimeout),this.rafPinchTimeout=this.currentWindow.requestAnimationFrame(function(){var l=nt(i,n),d=a.props.zoom*(l/a.lastPinchDistance);a.setNewZoom(d,o,{shouldUpdatePosition:!1}),a.lastPinchDistance=l;var x=lt(i,n),f=a.props.rotation+(x-a.lastPinchRotation);a.props.onRotationChange&&a.props.onRotationChange(f),a.lastPinchRotation=x})}},r.prototype.render=function(){var t=this,a,i=this.props,n=i.image,o=i.video,l=i.mediaProps,d=i.cropperProps,x=i.transform,f=i.crop,m=f.x,u=f.y,S=i.rotation,b=i.zoom,w=i.cropShape,D=i.showGrid,M=i.roundCropAreaPixels,A=i.style,y=A.containerStyle,j=A.cropAreaStyle,R=A.mediaStyle,P=i.classes,F=P.containerClassName,_=P.cropAreaClassName,p=P.mediaClassName,g=(a=this.state.mediaObjectFit)!==null&&a!==void 0?a:this.getObjectFit();return c.createElement("div",{onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart,ref:function(C){return t.containerRef=C},"data-testid":"container",style:y,className:Re("reactEasyCrop_Container",F)},n?c.createElement("img",K({alt:"",className:Re("reactEasyCrop_Image",g==="contain"&&"reactEasyCrop_Contain",g==="horizontal-cover"&&"reactEasyCrop_Cover_Horizontal",g==="vertical-cover"&&"reactEasyCrop_Cover_Vertical",p)},l,{src:n,ref:this.imageRef,style:K(K({},R),{transform:x||"translate(".concat(m,"px, ").concat(u,"px) rotate(").concat(S,"deg) scale(").concat(b,")")}),onLoad:this.onMediaLoad})):o&&c.createElement("video",K({autoPlay:!0,playsInline:!0,loop:!0,muted:!0,className:Re("reactEasyCrop_Video",g==="contain"&&"reactEasyCrop_Contain",g==="horizontal-cover"&&"reactEasyCrop_Cover_Horizontal",g==="vertical-cover"&&"reactEasyCrop_Cover_Vertical",p)},l,{ref:this.videoRef,onLoadedMetadata:this.onMediaLoad,style:K(K({},R),{transform:x||"translate(".concat(m,"px, ").concat(u,"px) rotate(").concat(S,"deg) scale(").concat(b,")")}),controls:!1}),(Array.isArray(o)?o:[{src:o}]).map(function(h){return c.createElement("source",K({key:h.src},h))})),this.state.cropSize&&c.createElement("div",K({ref:this.cropperRef,style:K(K({},j),{width:M?Math.round(this.state.cropSize.width):this.state.cropSize.width,height:M?Math.round(this.state.cropSize.height):this.state.cropSize.height}),tabIndex:0,onKeyDown:this.onKeyDown,onKeyUp:this.onKeyUp,"data-testid":"cropper",className:Re("reactEasyCrop_CropArea",w==="round"&&"reactEasyCrop_CropAreaRound",D&&"reactEasyCrop_CropAreaGrid",_)},d)))},r.defaultProps={zoom:1,rotation:0,aspect:4/3,maxZoom:wa,minZoom:ja,cropShape:"rect",objectFit:"contain",showGrid:!0,style:{},classes:{},mediaProps:{},cropperProps:{},zoomSpeed:1,restrictPosition:!0,zoomWithScroll:!0,keyboardStep:Na},r.getMousePoint=function(t){return{x:Number(t.clientX),y:Number(t.clientY)}},r.getTouchPoint=function(t){return{x:Number(t.clientX),y:Number(t.clientY)}},r})(c.Component);const Ca=s=>new Promise((r,t)=>{const a=new Image;a.addEventListener("load",()=>r(a)),a.addEventListener("error",i=>t(i)),a.setAttribute("crossOrigin","anonymous"),a.src=s});function _t(s){return s*Math.PI/180}function Sa(s,r,t){const a=_t(t);return{width:Math.abs(Math.cos(a)*s)+Math.abs(Math.sin(a)*r),height:Math.abs(Math.sin(a)*s)+Math.abs(Math.cos(a)*r)}}async function kt(s,r,t=0,a={horizontal:!1,vertical:!1}){const i=await Ca(s),n=document.createElement("canvas"),o=n.getContext("2d");if(!o)return null;const l=_t(t),{width:d,height:x}=Sa(i.width,i.height,t);n.width=d,n.height=x,o.translate(d/2,x/2),o.rotate(l),o.scale(a.horizontal?-1:1,a.vertical?-1:1),o.translate(-i.width/2,-i.height/2),o.drawImage(i,0,0);const f=o.getImageData(r.x,r.y,r.width,r.height);return n.width=r.width,n.height=r.height,o.putImageData(f,0,0),new Promise((m,u)=>{n.toBlob(S=>{m(S)},"image/jpeg")})}const Dt=({url:s,onUpload:r})=>{const{user:t}=pt(),[a,i]=c.useState(null),[n,o]=c.useState(!1),[l,d]=c.useState(""),[x,f]=c.useState(null),[m,u]=c.useState({x:0,y:0}),[S,b]=c.useState(1),[w,D]=c.useState(null),[M,A]=c.useState(!1),y=c.useRef(null);c.useEffect(()=>{if(s){const p=Z.getPublicUrl("perfis",s);i(`${p}?t=${new Date().getTime()}`)}else i(null)},[s]);const j=async p=>{if(p.target.files&&p.target.files.length>0){const g=p.target.files[0],h=new FileReader;h.addEventListener("load",()=>{var C;f(((C=h.result)==null?void 0:C.toString())||""),A(!0)}),h.readAsDataURL(g)}},R=(p,g)=>{D(g)},P=async()=>{if(!(!x||!w))try{o(!0);const p=await kt(x,w);if(!p)throw new Error("Erro ao cortar a imagem.");const g=new File([p],`avatar_${Date.now()}.jpg`,{type:"image/jpeg"});await _(g),A(!1),f(null),b(1)}catch(p){d(q(p)),o(!1)}},F=()=>{A(!1),f(null),b(1),y.current&&(y.current.value="")},_=async p=>{if(t)try{d("");const g=`${t.id}/avatar`,h=`${g}/v_${Date.now()}.jpg`;try{const C=await Z.list("perfis",g);if(C&&C.length>0){const k=C.map(I=>`${g}/${I.name}`);await Z.remove("perfis",k)}}catch(C){console.warn("Limpando fotos antigas...",C)}await Z.upload("perfis",h,p),r(h,{onSuccess:()=>{},onError:()=>{d("Falha ao salvar no perfil.")}})}catch(g){d(q(g))}finally{o(!1)}};return e.jsxs("div",{children:[e.jsxs("div",{className:"relative group",children:[e.jsx("div",{className:"w-48 h-48 rounded-full overflow-hidden border-4 border-gray-600 group-hover:border-primary transition-colors duration-300 flex items-center justify-center bg-gray-700",children:a?e.jsx("img",{src:a,alt:"Avatar",className:"w-full h-full object-cover"}):e.jsx(pe,{className:"w-24 h-24 text-gray-500"})}),e.jsx("label",{htmlFor:"avatar-input",className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-50 flex flex-col items-center justify-center cursor-pointer rounded-full transition-all duration-300",children:e.jsxs("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:[e.jsx(he,{className:"w-10 h-10 text-white mb-2"}),e.jsx("span",{className:"text-white font-bold text-center",children:n?"Enviando...":"Alterar Foto"})]})}),e.jsx("input",{ref:y,style:{visibility:"hidden",position:"absolute"},type:"file",id:"avatar-input",accept:"image/*",onChange:j,disabled:n})]}),l&&e.jsx("p",{className:"text-sm text-red-400 mt-2 text-center",children:l}),M&&x&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-80 p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg w-full max-w-md overflow-hidden shadow-2xl animate-fade-in",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-bold text-white font-poppins",children:"Ajustar Foto"}),e.jsx("button",{onClick:F,className:"text-gray-400 hover:text-white",children:e.jsx(Ie,{className:"w-6 h-6"})})]}),e.jsx("div",{className:"relative w-full h-80 bg-black",children:e.jsx(St,{image:x,crop:m,zoom:S,aspect:1,onCropChange:u,onCropComplete:R,onZoomChange:b,cropShape:"round",showGrid:!1})}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsx("input",{type:"range",value:S,min:1,max:3,step:.1,onChange:p=>b(Number(p.target.value)),className:"w-full h-2 bg-gray-600 rounded-lg appearance-none cursor-pointer accent-primary"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{onClick:F,className:"flex-1 py-2 px-4 border border-gray-600 rounded-md text-white hover:bg-gray-700",children:"Cancelar"}),e.jsx("button",{onClick:P,disabled:n,className:"flex-1 py-2 px-4 bg-secondary text-white font-bold rounded-md flex items-center justify-center gap-2",children:n?"Salvando...":e.jsxs(e.Fragment,{children:[e.jsx(me,{className:"w-5 h-5"})," Salvar"]})})]})]})]})})]})},Et=({currentPath:s,bucketName:r,userId:t,onUploadComplete:a})=>{const[i,n]=c.useState(null),[o,l]=c.useState(!1),[d,x]=c.useState(""),[f,m]=c.useState(null),[u,S]=c.useState({x:0,y:0}),[b,w]=c.useState(1),[D,M]=c.useState(null),[A,y]=c.useState(!1),j=c.useRef(null);c.useEffect(()=>{if(s){const g=Z.getPublicUrl(r,s);n(`${g}?t=${new Date().getTime()}`)}else n(null)},[s,r]);const R=async g=>{if(!g.target.files||g.target.files.length===0)return;x("");const h=g.target.files[0];if(h.size>5*1024*1024){x("A imagem deve ter no máximo 5MB.");return}const C=new FileReader;C.addEventListener("load",()=>{var k;m(((k=C.result)==null?void 0:k.toString())||null),y(!0)}),C.readAsDataURL(h)},P=(g,h)=>{M(h)},F=()=>{y(!1),m(null),w(1),j.current&&(j.current.value="")},_=async()=>{if(!(!f||!D))try{l(!0);const g=await kt(f,D);if(!g)throw new Error("Erro ao cortar a imagem.");const h=new File([g],"cover.jpg",{type:"image/jpeg"});await p(h),y(!1),m(null),w(1)}catch(g){x(q(g)),l(!1)}},p=async g=>{try{const C=`cover_${Date.now()}.jpg`,k=`${t}/cover/${C}`;if(s)try{await Z.remove(r,[s])}catch(W){console.warn("Erro ao remover capa antiga:",W)}const I=await Z.upload(r,k,g),Y=Z.getPublicUrl(r,I);n(`${Y}?t=${new Date().getTime()}`),await a(I)}catch(h){x("Erro ao salvar imagem: "+q(h))}finally{l(!1),j.current&&(j.current.value="")}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative w-full h-48 md:h-64 rounded-lg overflow-hidden bg-gray-800 border-2 border-dashed border-gray-600 group hover:border-primary transition-all duration-300 mb-8",children:[i?e.jsxs(e.Fragment,{children:[e.jsx("img",{src:i,alt:"Capa do Perfil",className:"w-full h-full object-cover group-hover:opacity-50 transition-opacity duration-300"}),e.jsxs("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity duration-300 flex flex-col items-center justify-center",children:[e.jsx(he,{className:"w-10 h-10 text-white mb-2"}),e.jsx("span",{className:"text-white font-bold text-sm",children:"Alterar Capa"})]})]}):e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center text-gray-500 group-hover:text-primary transition-colors",children:[e.jsx(ke,{className:"w-12 h-12 mb-2"}),e.jsx("span",{className:"font-medium",children:"Adicionar Foto de Capa"}),e.jsx("span",{className:"text-xs mt-1 text-gray-600",children:"Recomendado: 1200x400px"})]}),o&&!A&&e.jsxs("div",{className:"absolute inset-0 bg-black/70 flex flex-col items-center justify-center z-10",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-white mb-2"}),e.jsx("span",{className:"text-white text-xs",children:"Enviando..."})]}),e.jsx("input",{ref:j,type:"file",accept:"image/png, image/jpeg, image/jpg, image/webp",className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer z-20",onChange:R,disabled:o}),d&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-red-500/90 text-white text-xs p-2 text-center z-30",children:d})]}),A&&f&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-90 p-4",children:e.jsxs("div",{className:"bg-gray-800 rounded-lg w-full max-w-3xl overflow-hidden shadow-2xl animate-fade-in flex flex-col max-h-[90vh]",children:[e.jsxs("div",{className:"p-4 border-b border-gray-700 flex justify-between items-center flex-shrink-0",children:[e.jsx("h3",{className:"text-lg font-bold text-white font-poppins",children:"Ajustar Capa"}),e.jsx("button",{onClick:F,className:"text-gray-400 hover:text-white",children:e.jsx(Ie,{className:"w-6 h-6"})})]}),e.jsx("div",{className:"relative w-full flex-grow bg-black min-h-[300px] h-[50vh]",children:e.jsx(St,{image:f,crop:u,zoom:b,aspect:3/1,onCropChange:S,onCropComplete:P,onZoomChange:w,showGrid:!0})}),e.jsxs("div",{className:"p-4 space-y-4 bg-gray-800 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-400",children:[e.jsx("span",{className:"flex-shrink-0",children:"Zoom"}),e.jsx("input",{type:"range",value:b,min:1,max:3,step:.1,"aria-labelledby":"Zoom",onChange:g=>w(Number(g.target.value)),className:"w-full h-2 bg-gray-600 rounded-lg appearance-none cursor-pointer accent-primary"})]}),e.jsxs("div",{className:"flex gap-4 pt-2",children:[e.jsx("button",{onClick:F,className:"flex-1 py-3 px-4 border border-gray-600 rounded-md text-white hover:bg-gray-700 transition-colors font-medium",children:"Cancelar"}),e.jsx("button",{onClick:_,disabled:o,className:"flex-1 py-3 px-4 bg-secondary text-white font-bold rounded-md hover:bg-opacity-90 transition-colors flex items-center justify-center gap-2",children:o?"Salvando...":e.jsxs(e.Fragment,{children:[e.jsx(me,{className:"w-5 h-5"})," Salvar Capa"]})})]})]})]})})]})},Ee=s=>s.replace(/\D/g,""),_a=(s,r)=>{const t=s.trim();if(!t)return{valid:!1,error:"Chave PIX não pode estar vazia"};switch(r){case"cpf":return ka(t);case"cnpj":return Da(t);case"email":const a=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;return{valid:a.test(t),error:a.test(t)?void 0:"E-mail inválido"};case"celular":const i=Ee(t),n=i.length===11&&i.startsWith("0")===!1;return{valid:n,error:n?void 0:"Celular deve ter 11 dígitos (DDD + número)"};case"aleatoria":const o=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;return{valid:o.test(t),error:o.test(t)?void 0:"Formato de chave aleatória inválido"};default:return{valid:!1,error:"Tipo de chave desconhecido"}}},ka=s=>{const r=s.replace(/\D/g,"");if(r.length!==11)return{valid:!1,error:"CPF deve ter 11 dígitos"};if(/^(\d)\1{10}$/.test(r))return{valid:!1,error:"CPF inválido"};let t=0;for(let i=0;i<9;i++)t+=parseInt(r.charAt(i))*(10-i);let a=11-t%11;if(a>=10&&(a=0),a!==parseInt(r.charAt(9)))return{valid:!1,error:"CPF inválido"};t=0;for(let i=0;i<10;i++)t+=parseInt(r.charAt(i))*(11-i);return a=11-t%11,a>=10&&(a=0),a!==parseInt(r.charAt(10))?{valid:!1,error:"CPF inválido"}:{valid:!0}},Da=s=>{const r=s.replace(/\D/g,"");if(r.length!==14)return{valid:!1,error:"CNPJ deve ter 14 dígitos"};if(/^(\d)\1{13}$/.test(r))return{valid:!1,error:"CNPJ inválido"};let t=r.length-2,a=r.substring(0,t);const i=r.substring(t);let n=0,o=t-7;for(let d=t;d>=1;d--)n+=parseInt(a.charAt(t-d))*o--,o<2&&(o=9);let l=n%11<2?0:11-n%11;if(l!==parseInt(i.charAt(0)))return{valid:!1,error:"CNPJ inválido"};t=t+1,a=r.substring(0,t),n=0,o=t-7;for(let d=t;d>=1;d--)n+=parseInt(a.charAt(t-d))*o--,o<2&&(o=9);return l=n%11<2?0:11-n%11,l!==parseInt(i.charAt(1))?{valid:!1,error:"CNPJ inválido"}:{valid:!0}},Ea=s=>{var t,a,i,n,o,l;const r=[];if((!s.nome||s.nome.trim().length<3)&&r.push("Nome artístico deve ter pelo menos 3 caracteres"),s.telefone){const d=Ee(s.telefone);d.length!==10&&d.length!==11&&r.push("Telefone deve ter 10 ou 11 dígitos")}if(s.descricao&&s.descricao.length>0&&s.descricao.length<20&&r.push("Descrição deve ter pelo menos 20 caracteres ou ficar vazia"),(t=s.dados_bancarios)!=null&&t.chave_pix&&((a=s.dados_bancarios)!=null&&a.tipo_chave)){const d=_a(s.dados_bancarios.chave_pix,s.dados_bancarios.tipo_chave);d.valid||r.push(d.error||"Chave PIX inválida")}return(i=s.dados_bancarios)!=null&&i.chave_pix&&!((n=s.dados_bancarios)!=null&&n.tipo_chave)&&r.push("Selecione o tipo da chave PIX"),!((o=s.dados_bancarios)!=null&&o.chave_pix)&&((l=s.dados_bancarios)!=null&&l.tipo_chave)&&r.push("Informe a chave PIX"),{valid:r.length===0,errors:r}},Aa=s=>{const r=[];if((!s.nome||s.nome.trim().length<3)&&r.push("Nome do estabelecimento deve ter pelo menos 3 caracteres"),s.telefone){const t=Ee(s.telefone);t.length!==10&&t.length!==11&&r.push("Telefone deve ter 10 ou 11 dígitos")}if(s.capacidade!==null&&s.capacidade!==void 0){const t=Number(s.capacidade);(isNaN(t)||t<=0)&&r.push("Capacidade deve ser um número positivo")}return s.descricao&&s.descricao.length>0&&s.descricao.length<20&&r.push("Descrição deve ter pelo menos 20 caracteres ou ficar vazia"),{valid:r.length===0,errors:r}},Ra=s=>{if(!s)return null;const r={};return Object.keys(s).forEach(t=>{const a=s[t];a&&typeof a=="string"&&a.trim()!==""&&(r[t]=a.trim())}),Object.keys(r).length>0?r:null},At=s=>{if(!s)return null;const r={};return Object.keys(s).forEach(t=>{const a=s[t];a&&typeof a=="string"&&a.trim()!==""&&(r[t]=a.trim())}),Object.keys(r).length>0?r:null},dt=[{key:"monday",label:"Segunda-feira"},{key:"tuesday",label:"Terça-feira"},{key:"wednesday",label:"Quarta-feira"},{key:"thursday",label:"Quinta-feira"},{key:"friday",label:"Sexta-feira"},{key:"saturday",label:"Sábado"},{key:"sunday",label:"Domingo"}],Pa=({initialProfile:s,onProfileUpdate:r})=>{const{genres:t}=$t(),[a,i]=c.useState("idle"),[n,o]=c.useState(""),[l,d]=c.useState(""),[x,f]=c.useState(!1),[m,u]=c.useState(null),S=fe(s),[b,w]=c.useState({nome:"",telefone:"",cidade:"",foto_url:"",foto_capa:"",genero_musical:"",descricao:"",midias_sociais:{instagram:"",youtube:"",site:""},dados_bancarios:{banco:"",agencia:"",conta:"",chave_pix:"",tipo_chave:""},disponibilidade:{},rider_tecnico_url:null,mapa_palco_url:null});c.useEffect(()=>{var _,p,g,h,C,k,I,Y,W,E,z,H,U,ee,N,O,J,X,L,re,te,ae;if(s){const B={};dt.forEach(T=>{B[T.key]={active:!1,start:"18:00",end:"23:00"}});const V=((_=s.artista)==null?void 0:_.disponibilidade)||{},v={...B,...V};w({nome:s.nome||"",telefone:s.telefone||"",cidade:s.cidade||"",foto_url:s.foto_url||"",foto_capa:((p=s.artista)==null?void 0:p.foto_capa)||"",genero_musical:((g=s.artista)==null?void 0:g.genero_musical)||"",descricao:((h=s.artista)==null?void 0:h.descricao)||"",midias_sociais:{instagram:((k=(C=s.artista)==null?void 0:C.midias_sociais)==null?void 0:k.instagram)||"",youtube:((Y=(I=s.artista)==null?void 0:I.midias_sociais)==null?void 0:Y.youtube)||"",site:((E=(W=s.artista)==null?void 0:W.midias_sociais)==null?void 0:E.site)||""},dados_bancarios:{banco:((H=(z=s.artista)==null?void 0:z.dados_bancarios)==null?void 0:H.banco)||"",agencia:((ee=(U=s.artista)==null?void 0:U.dados_bancarios)==null?void 0:ee.agencia)||"",conta:((O=(N=s.artista)==null?void 0:N.dados_bancarios)==null?void 0:O.conta)||"",chave_pix:((X=(J=s.artista)==null?void 0:J.dados_bancarios)==null?void 0:X.chave_pix)||"",tipo_chave:((re=(L=s.artista)==null?void 0:L.dados_bancarios)==null?void 0:re.tipo_chave)||""},disponibilidade:v,rider_tecnico_url:((te=s.artista)==null?void 0:te.rider_tecnico_url)||null,mapa_palco_url:((ae=s.artista)==null?void 0:ae.mapa_palco_url)||null})}},[s]);const D=async(_,p)=>{if(!_.target.files||_.target.files.length===0)return;const g=_.target.files[0];u(p);try{const h=`${s.auth_id}/docs/${p}_${Date.now()}.${g.name.split(".").pop()}`,C=await Z.upload("artista",h,g);await Q.updateArtist(s.id,null,{[p==="rider"?"rider_tecnico_url":"mapa_palco_url"]:C}),w(k=>({...k,[p==="rider"?"rider_tecnico_url":"mapa_palco_url"]:C})),r()}catch(h){o(q(h))}finally{u(null)}},M=_=>{const{id:p,value:g}=_.target;w(h=>({...h,[p]:g})),a!=="idle"&&i("idle")},A=_=>{const{name:p,value:g}=_.target;w(h=>({...h,midias_sociais:{...h.midias_sociais,[p]:g}})),a!=="idle"&&i("idle")},y=_=>{const{name:p,value:g}=_.target;w(h=>({...h,dados_bancarios:{...h.dados_bancarios,[p]:g}})),a!=="idle"&&i("idle")},j=(_,p,g)=>{w(h=>({...h,disponibilidade:{...h.disponibilidade,[_]:{...h.disponibilidade[_],[p]:g}}})),a!=="idle"&&i("idle")},R=(_,p)=>{Q.updateBasicInfo(s.id,{foto_url:_}).then(()=>{d("Foto de perfil atualizada!"),r(),p.onSuccess()}).catch(g=>{d("Falha ao salvar a foto."),p.onError()})},P=async _=>{try{await Q.updateArtist(s.id,null,{foto_capa:_}),w(p=>({...p,foto_capa:_})),r()}catch(p){o("Erro ao salvar foto de capa: "+q(p)),i("error")}},F=async _=>{_.preventDefault(),i("saving"),o("");const p=Ea(b);if(!p.valid){i("error"),o(p.errors.join("; "));return}const g=b.telefone?Ee(b.telefone):"",h=Ra(b.dados_bancarios);let C=h;if(h!=null&&h.chave_pix&&(h!=null&&h.tipo_chave)){const I=h.tipo_chave==="cpf"||h.tipo_chave==="cnpj"?h.chave_pix.replace(/\D/g,""):h.chave_pix.trim();C={...h,chave_pix:I}}const k=At(b.midias_sociais);try{await Q.updateArtist(s.id,{nome:b.nome.trim(),telefone:g,cidade:b.cidade.trim()},{genero_musical:b.genero_musical,descricao:b.descricao.trim(),midias_sociais:k||{},dados_bancarios:C||{},disponibilidade:b.disponibilidade}),i("success"),r().catch(I=>{console.warn("Erro ao atualizar contexto:",I)}),setTimeout(()=>i("idle"),3e3)}catch(I){i("error"),o(q(I))}};return e.jsx("div",{className:"space-y-12",children:e.jsxs("form",{onSubmit:F,children:[e.jsx("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6",children:e.jsx("h2",{className:"text-2xl font-bold font-poppins text-white",children:"Editar Perfil"})}),!S.complete&&e.jsxs("div",{className:"mb-8 bg-gray-900 border-l-4 border-yellow-500 p-4 rounded-r-lg shadow-md transition-all",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ce,{className:"w-5 h-5 text-yellow-500 flex-shrink-0"}),e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-gray-300",children:["Seu perfil está incompleto. Preencha os ",e.jsxs("strong",{children:[S.missing.length," itens restantes"]}),"."]})})]}),e.jsx("button",{type:"button",onClick:()=>f(!x),className:"text-xs font-semibold text-primary hover:underline",children:x?"Ocultar":"Ver Pendências"})]}),x&&e.jsx("div",{className:"mt-3 pl-8 animate-fade-in",children:e.jsx("ul",{className:"list-disc text-xs text-gray-400 space-y-1",children:S.missing.map((_,p)=>e.jsx("li",{children:String(_)},p))})})]}),e.jsx(Et,{currentPath:b.foto_capa,bucketName:"artista",userId:s.auth_id,onUploadComplete:P}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 items-start mb-8",children:[e.jsxs("div",{className:"lg:col-span-1 flex flex-col items-center",children:[e.jsx(Dt,{url:b.foto_url,onUpload:R}),l&&e.jsx("p",{className:"text-sm text-green-400 mt-2 text-center",children:l})]}),e.jsxs("div",{className:"lg:col-span-2 grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"nome",className:"block text-sm font-medium text-gray-300",children:"Nome Artístico / Banda"}),e.jsx("input",{type:"text",id:"nome",value:b.nome,onChange:M,className:"mt-1 input-style"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"telefone",className:"block text-sm font-medium text-gray-300",children:"Telefone (Somente números)"}),e.jsx("input",{type:"tel",id:"telefone",value:b.telefone,onChange:M,className:"mt-1 input-style",placeholder:"(00) 00000-0000"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"cidade",className:"block text-sm font-medium text-gray-300",children:"Cidade"}),e.jsx("input",{type:"text",id:"cidade",value:b.cidade,onChange:M,className:"mt-1 input-style"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"genero_musical",className:"block text-sm font-medium text-gray-300",children:"Gênero Principal"}),e.jsxs("select",{id:"genero_musical",value:b.genero_musical,onChange:M,className:"mt-1 input-style",children:[e.jsx("option",{value:"",children:"Selecione"}),t.map(_=>e.jsx("option",{value:_.nome,children:_.nome},_.id))]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{htmlFor:"descricao",className:"block text-sm font-medium text-gray-300",children:"Sobre (Bio)"}),e.jsx("textarea",{id:"descricao",rows:4,value:b.descricao,onChange:M,className:"mt-1 input-style",placeholder:"Conte sua história..."})]}),e.jsxs("div",{className:"md:col-span-2 space-y-4",children:[e.jsx("h3",{className:"text-lg font-bold text-white flex items-center gap-2",children:"Redes Sociais"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"instagram",className:"block text-sm font-medium text-gray-300",children:"Instagram"}),e.jsx("input",{type:"text",name:"instagram",id:"instagram",value:b.midias_sociais.instagram,onChange:A,className:"mt-1 input-style",placeholder:"@usuario"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"youtube",className:"block text-sm font-medium text-gray-300",children:"YouTube"}),e.jsx("input",{type:"text",name:"youtube",id:"youtube",value:b.midias_sociais.youtube,onChange:A,className:"mt-1 input-style",placeholder:"Canal URL"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"site",className:"block text-sm font-medium text-gray-300",children:"Site / Linktree"}),e.jsx("input",{type:"text",name:"site",id:"site",value:b.midias_sociais.site,onChange:A,className:"mt-1 input-style",placeholder:"https://..."})]})]})]}),e.jsxs("div",{className:"md:col-span-2 bg-gray-900/50 p-6 rounded-2xl border border-gray-700",children:[e.jsxs("h3",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx(De,{className:"w-5 h-5 text-green-400"})," Dados para Recebimento (PIX)"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Banco"}),e.jsx("input",{type:"text",name:"banco",value:b.dados_bancarios.banco,onChange:y,className:"input-style",placeholder:"Ex: Nubank"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Agência"}),e.jsx("input",{type:"text",name:"agencia",value:b.dados_bancarios.agencia,onChange:y,className:"input-style",placeholder:"0001"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Conta"}),e.jsx("input",{type:"text",name:"conta",value:b.dados_bancarios.conta,onChange:y,className:"input-style",placeholder:"12345-6"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Chave PIX"}),e.jsx("input",{type:"text",name:"chave_pix",value:b.dados_bancarios.chave_pix,onChange:y,className:"input-style",placeholder:"CPF, E-mail, Celular ou Aleatória"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Tipo de Chave"}),e.jsxs("select",{name:"tipo_chave",value:b.dados_bancarios.tipo_chave,onChange:y,className:"input-style",children:[e.jsx("option",{value:"",children:"Selecione"}),e.jsx("option",{value:"cpf",children:"CPF"}),e.jsx("option",{value:"cnpj",children:"CNPJ"}),e.jsx("option",{value:"email",children:"E-mail"}),e.jsx("option",{value:"celular",children:"Celular"}),e.jsx("option",{value:"aleatoria",children:"Chave Aleatória"})]})]})]}),e.jsx("p",{className:"mt-4 text-[10px] text-gray-500 italic",children:"* Estes dados são confidenciais e utilizados exclusivamente para o repasse de seus cachês via plataforma."})]}),e.jsxs("div",{className:"md:col-span-2 bg-gray-900/50 p-6 rounded-2xl border border-gray-700",children:[e.jsxs("h3",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx(Se,{className:"w-5 h-5 text-blue-400"})," Disponibilidade Semanal"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:dt.map(_=>{const p=b.disponibilidade[_.key]||{active:!1,start:"18:00",end:"23:00"};return e.jsxs("div",{className:`p-3 rounded-xl border transition-all ${p.active?"bg-gray-800 border-primary/50":"bg-gray-900/30 border-gray-800 opacity-75 hover:opacity-100"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:`text-sm font-bold ${p.active?"text-white":"text-gray-500"}`,children:_.label}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",className:"sr-only peer",checked:p.active,onChange:g=>j(_.key,"active",g.target.checked)}),e.jsx("div",{className:"w-9 h-5 bg-gray-700 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-primary"})]})]}),p.active&&e.jsxs("div",{className:"flex items-center gap-2 animate-fade-in",children:[e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"time",value:p.start,onChange:g=>j(_.key,"start",g.target.value),className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-2 py-1 text-xs text-center text-white focus:border-primary focus:outline-none"})}),e.jsx("span",{className:"text-gray-500 text-xs",children:"até"}),e.jsx("div",{className:"flex-1",children:e.jsx("input",{type:"time",value:p.end,onChange:g=>j(_.key,"end",g.target.value),className:"w-full bg-gray-900 border border-gray-700 rounded-lg px-2 py-1 text-xs text-center text-white focus:border-primary focus:outline-none"})})]})]},_.key)})})]}),e.jsxs("div",{className:"bg-gray-900/50 p-6 rounded-2xl border border-gray-700",children:[e.jsxs("h3",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx(Pe,{className:"w-5 h-5 text-primary"})," Rider Técnico (PDF/Imagem)"]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("label",{className:"flex-1 flex flex-col items-center justify-center py-4 border-2 border-dashed border-gray-700 rounded-xl cursor-pointer hover:bg-gray-800 transition-all",children:[e.jsx(he,{className:`w-6 h-6 mb-2 ${m==="rider"?"animate-bounce":"text-gray-500"}`}),e.jsx("span",{className:"text-xs font-bold text-gray-400",children:b.rider_tecnico_url?"Alterar Rider":"Enviar Rider"}),e.jsx("input",{type:"file",className:"hidden",accept:".pdf,image/*",onChange:_=>D(_,"rider")})]}),b.rider_tecnico_url&&e.jsx("div",{className:"w-12 h-12 bg-green-500/10 rounded-full flex items-center justify-center text-green-500 border border-green-500/30",children:e.jsx(me,{className:"w-6 h-6"})})]})]}),e.jsxs("div",{className:"bg-gray-900/50 p-6 rounded-2xl border border-gray-700",children:[e.jsxs("h3",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx($e,{className:"w-5 h-5 text-secondary"})," Mapa de Palco"]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("label",{className:"flex-1 flex flex-col items-center justify-center py-4 border-2 border-dashed border-gray-700 rounded-xl cursor-pointer hover:bg-gray-800 transition-all",children:[e.jsx(he,{className:`w-6 h-6 mb-2 ${m==="mapa"?"animate-bounce":"text-gray-500"}`}),e.jsx("span",{className:"text-xs font-bold text-gray-400",children:b.mapa_palco_url?"Alterar Mapa":"Enviar Mapa"}),e.jsx("input",{type:"file",className:"hidden",accept:".pdf,image/*",onChange:_=>D(_,"mapa")})]}),b.mapa_palco_url&&e.jsx("div",{className:"w-12 h-12 bg-green-500/10 rounded-full flex items-center justify-center text-green-500 border border-green-500/30",children:e.jsx(me,{className:"w-6 h-6"})})]})]})]}),e.jsx("div",{className:"flex justify-end mt-10",children:e.jsxs("button",{type:"submit",disabled:a==="saving",className:"bg-primary text-dark font-black py-4 px-12 rounded-full hover:bg-white transition-all shadow-xl shadow-primary/20 flex items-center gap-2",children:[a==="saving"?"Salvando...":"Salvar Perfil",a==="success"&&e.jsx(me,{className:"w-5 h-5"})]})}),n&&e.jsx("p",{className:"text-red-400 text-right mt-2 text-sm",children:n})]})})},Ge=({className:s})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:s,fill:"currentColor",viewBox:"0 0 24 24",strokeWidth:0,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.75 9.812l-12-6.75A1.125 1.125 0 008.25 4.125v13.5A1.125 1.125 0 009.75 18.75l12-6.75a1.125 1.125 0 000-1.938z"})}),Ma=({isOpen:s,onClose:r,analysis:t})=>{if(!s||!t)return null;const a=t.resultado;return e.jsx("div",{className:"fixed inset-0 bg-black/90 z-50 flex justify-center items-center p-4 backdrop-blur-sm animate-fade-in",children:e.jsxs("div",{className:"bg-gray-900 text-white rounded-2xl shadow-2xl w-full max-w-2xl relative p-0 overflow-hidden border border-gray-800 flex flex-col max-h-[90vh]",children:[e.jsxs("div",{className:"bg-gradient-to-r from-indigo-900 to-gray-900 p-6 border-b border-gray-800 flex justify-between items-center relative overflow-hidden",children:[e.jsxs("div",{className:"relative z-10",children:[e.jsxs("h2",{className:"text-xl font-bold font-poppins flex items-center gap-2",children:[e.jsx(ce,{className:"text-indigo-400 w-6 h-6 animate-pulse"}),"AI Soundcheck: Raio-X Sonoro"]}),e.jsx("p",{className:"text-xs text-indigo-300 mt-1 uppercase font-black tracking-widest",children:"Analisado por Gemini Flash Audio"})]}),e.jsx("button",{onClick:r,className:"text-gray-400 hover:text-white relative z-10",children:e.jsx(Ie,{})}),e.jsx("div",{className:"absolute right-0 top-0 w-32 h-32 bg-indigo-500/10 blur-3xl rounded-full"})]}),e.jsxs("div",{className:"overflow-y-auto p-8 space-y-8",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-gray-850 p-4 rounded-xl border border-gray-800",children:[e.jsx("p",{className:"text-[10px] text-gray-500 uppercase font-black mb-1",children:"Gênero Detectado"}),e.jsx("p",{className:"text-lg font-bold text-white",children:a.genero_sugerido})]}),e.jsxs("div",{className:"bg-gray-850 p-4 rounded-xl border border-gray-800",children:[e.jsx("p",{className:"text-[10px] text-gray-500 uppercase font-black mb-1",children:"Qualidade Técnica"}),e.jsx("p",{className:`text-lg font-bold ${a.qualidade_tecnica==="Excelente"?"text-green-400":"text-yellow-400"}`,children:a.qualidade_tecnica})]}),e.jsxs("div",{className:"bg-gray-850 p-4 rounded-xl border border-gray-800",children:[e.jsx("p",{className:"text-[10px] text-gray-500 uppercase font-black mb-1",children:"Nível de Energia"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-lg font-bold text-white",children:[a.energia,"%"]}),e.jsx("div",{className:"flex-grow h-1.5 bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-primary",style:{width:`${a.energia}%`}})})]})]})]}),e.jsxs("div",{className:"bg-gray-850 p-6 rounded-2xl border border-gray-800",children:[e.jsx("h4",{className:"text-xs font-black text-gray-400 uppercase tracking-widest mb-3",children:"Análise de Timbre"}),e.jsxs("p",{className:"text-gray-200 leading-relaxed italic",children:['"',a.timbre_vocal,'"']})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-black text-gray-400 uppercase tracking-widest mb-4",children:"Sugestões do Produtor IA"}),e.jsx("div",{className:"space-y-3",children:a.sugestoes.map((i,n)=>e.jsxs("div",{className:"flex items-start gap-3 bg-gray-900/50 p-4 rounded-xl border border-gray-800/50 hover:border-indigo-500/30 transition-colors",children:[e.jsx(ne,{className:"w-5 h-5 text-indigo-400 shrink-0 mt-0.5"}),e.jsx("p",{className:"text-sm text-gray-300 leading-relaxed",children:i})]},n))})]})]}),e.jsxs("div",{className:"bg-gray-900 border-t border-gray-800 p-4 flex justify-between items-center text-[10px] text-gray-600 font-bold uppercase tracking-tighter",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ye,{className:"w-3 h-3"})," Analisado em ",new Date(t.criado_em).toLocaleString()]}),e.jsx("p",{children:"RESONA Audio Intelligence v1.2"})]})]})})},Rt=({profile:s,onUpdate:r})=>{var te,ae;const[t,a]=c.useState("photos"),[i,n]=c.useState([]),[o,l]=c.useState([]),[d,x]=c.useState([]),[f,m]=c.useState([]),[u,S]=c.useState([]),[b,w]=c.useState([]),[D,M]=c.useState(!1),[A,y]=c.useState(null),[j,R]=c.useState(null),[P,F]=c.useState(!1),[_,p]=c.useState(!0),[g,h]=c.useState(""),[C,k]=c.useState(""),[I,Y]=c.useState(null),W=s.tipo==="artista",E=W?"artista":"estabelecimento",z=s.plano==="free",H={photos:5,videos:1,audios:1},U=t==="photos"?i:t==="videos"?d:u,ee=t==="photos"?o:t==="videos"?f:b,N=H[t],O=z&&U.length>=N,J=c.useCallback(()=>{var B,V,v,T,G;return W?{photos:((B=s.artista)==null?void 0:B.galeria_fotos)||[],videos:((V=s.artista)==null?void 0:V.galeria_videos)||[],audios:((v=s.artista)==null?void 0:v.galeria_audios)||[]}:{photos:((T=s.estabelecimento)==null?void 0:T.galeria_fotos)||[],videos:((G=s.estabelecimento)==null?void 0:G.galeria_videos)||[],audios:[]}},[W,s]);c.useEffect(()=>{(async()=>{p(!0),h("");const V=Date.now(),v=J();try{const[T,G,se]=await Promise.all([v.photos.length>0?Z.getSignedUrls(E,v.photos,3600).catch(()=>[]):Promise.resolve([]),v.videos.length>0?Z.getSignedUrls(E,v.videos,3600).catch(()=>[]):Promise.resolve([]),W&&v.audios.length>0?Z.getSignedUrls(E,v.audios,3600).catch(()=>[]):Promise.resolve([])]);n(v.photos),l(T.map(ue=>`${ue}&t=${V}`)),x(v.videos),m(G),W&&(S(v.audios),w(se))}catch(T){console.error("Erro no carregamento da galeria:",T),h("Ocorreu um problema ao carregar alguns arquivos.")}finally{p(!1)}})()},[s.id,(te=s.artista)==null?void 0:te.galeria_fotos,(ae=s.estabelecimento)==null?void 0:ae.galeria_fotos,E,W,J]),c.useEffect(()=>{if(C||g){const B=setTimeout(()=>{k(""),h("")},5e3);return()=>clearTimeout(B)}},[C,g]);const X=async B=>{if(!B.target.files||B.target.files.length===0)return;if(O){h(`Limite do plano Free atingido para ${t==="photos"?"fotos":"mídia"}.`);return}F(!0),h("");const V=Array.from(B.target.files);if(z&&U.length+V.length>N){h(`Limite excedido. O máximo é de ${N} itens.`),F(!1);return}let v="portfolio",T=t==="photos"?"galeria_fotos":t==="videos"?"galeria_videos":"galeria_audios";t==="videos"?v="portfolio/videos":t==="audios"&&(v="portfolio/audios");try{const G=[];for(const se of V){k(`Enviando: ${se.name}...`);const ue=se.name.split(".").pop(),Ae=`${s.auth_id}/${v}/p_${Date.now()}_${Math.random().toString(36).substring(7)}.${ue}`;try{const ge=await Z.upload(E,Ae,se);G.push(ge)}catch(ge){console.error(`Falha ao subir arquivo ${se.name}:`,ge)}}if(G.length>0){const se=[...U,...G];W?await Q.updateArtist(s.id,null,{[T]:se}):await Q.updateVenue(s.id,null,{[T]:se}),k(`${G.length} arquivo(s) enviados!`),r()}else throw new Error("Nenhum arquivo pôde ser enviado. Verifique sua conexão.")}catch(G){h(q(G))}finally{F(!1),B.target.value=""}},L=async B=>{Y(B);let V=t==="photos"?"galeria_fotos":t==="videos"?"galeria_videos":"galeria_audios";try{await Z.remove(E,[B]);const v=U.filter(T=>T!==B);W?await Q.updateArtist(s.id,null,{[V]:v}):await Q.updateVenue(s.id,null,{[V]:v}),k("Item removido."),r()}catch(v){h(`Erro ao remover: ${q(v)}`)}finally{Y(null)}},re=async(B,V)=>{R(B);try{const v=await Ft.analyzeAudio(s.id,B,V);y(v),M(!0)}catch(v){alert("Erro na análise: "+q(v))}finally{R(null)}};return e.jsxs("div",{className:"animate-fade-in",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4",children:[e.jsx("h2",{className:"text-2xl font-bold font-poppins text-white",children:"Gerenciar Portfólio"}),z&&e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-gray-900 border border-gray-700 px-4 py-2 rounded-full shadow-inner",children:[e.jsx("span",{className:"text-[10px] font-black text-gray-500 uppercase tracking-widest",children:"Cota:"}),e.jsxs("span",{className:`text-sm font-black font-mono ${O?"text-red-400":"text-primary"}`,children:[U.length,"/",N]})]}),e.jsxs(oe,{to:"/planos",className:"flex items-center gap-2 bg-primary/10 hover:bg-primary text-primary hover:text-dark px-4 py-2 rounded-full text-xs font-bold transition-all border border-primary/30",children:[e.jsx(ce,{className:"w-3 h-3"})," Upgrade Pro"]})]})]}),e.jsxs("div",{className:"flex space-x-2 mb-6 bg-gray-800 p-1 rounded-lg w-fit overflow-x-auto scrollbar-hide",children:[e.jsxs("button",{onClick:()=>a("photos"),className:`py-2 px-6 font-bold text-sm rounded-md transition-all flex items-center gap-2 ${t==="photos"?"bg-gray-700 text-white shadow-sm":"text-gray-400 hover:text-white hover:bg-gray-700/50"}`,children:[e.jsx(ke,{className:"w-4 h-4"})," Fotos"]}),e.jsxs("button",{onClick:()=>a("videos"),className:`py-2 px-6 font-bold text-sm rounded-md transition-all flex items-center gap-2 ${t==="videos"?"bg-gray-700 text-white shadow-sm":"text-gray-400 hover:text-white hover:bg-gray-700/50"}`,children:[e.jsx(Ge,{className:"w-4 h-4"})," Vídeos"]}),W&&e.jsxs("button",{onClick:()=>a("audios"),className:`py-2 px-6 font-bold text-sm rounded-md transition-all flex items-center gap-2 ${t==="audios"?"bg-gray-700 text-white shadow-sm":"text-gray-400 hover:text-white hover:bg-gray-700/50"}`,children:[e.jsx(Oe,{className:"w-4 h-4"})," Áudios"]})]}),e.jsx("div",{className:"bg-gray-800 rounded-xl p-6 min-h-[350px] border border-gray-700 shadow-lg relative",children:_?e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-gray-800/50 backdrop-blur-sm rounded-xl z-20",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mb-4"}),e.jsx("p",{className:"text-gray-400 font-medium",children:"Sincronizando arquivos..."})]}):e.jsxs(e.Fragment,{children:[C&&e.jsx("div",{className:"mb-4 p-3 rounded-md text-center text-sm bg-green-500/20 text-green-300 border border-green-500/30 animate-fade-in",children:C}),g&&e.jsx("div",{className:"mb-4 p-3 rounded-md text-center text-sm bg-red-500/20 text-red-400 border border-red-500/30 animate-shake",children:g}),e.jsxs("div",{className:`grid gap-6 mb-6 ${t==="audios"?"grid-cols-1":"grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5"}`,children:[!O&&e.jsxs("label",{className:`relative group rounded-2xl overflow-hidden ${t==="audios"?"h-24":"aspect-square"} bg-gray-900 border-2 border-dashed border-gray-600 hover:border-primary transition-all cursor-pointer flex flex-col items-center justify-center ${P?"opacity-50":""} shadow-inner`,children:[e.jsx("div",{className:"p-3 bg-gray-800 rounded-full group-hover:bg-primary/20 mb-2 transition-colors border border-gray-700 group-hover:border-primary/50",children:e.jsx(he,{className:"w-6 h-6 text-gray-500 group-hover:text-primary"})}),e.jsx("span",{className:"text-[10px] uppercase font-black text-gray-500 group-hover:text-white tracking-widest transition-colors",children:P?"Aguarde":"Adicionar"}),e.jsx("input",{type:"file",multiple:t==="photos",className:"hidden",onChange:X,disabled:P,accept:t==="photos"?"image/*":t==="videos"?"video/*":"audio/*"})]}),ee.map((B,V)=>{const v=U[V],T=I===v,G=j===v;return e.jsxs("div",{className:`relative group rounded-2xl overflow-hidden ${t==="audios"?"h-24 bg-gray-900 p-4 border border-gray-700 flex items-center gap-4":"aspect-square bg-black border border-gray-700"} shadow-md hover:shadow-2xl hover:border-gray-500 transition-all`,children:[t==="photos"?e.jsx("img",{src:B,alt:"Portfolio",className:`w-full h-full object-cover ${T?"opacity-50":""}`}):t==="videos"?e.jsxs("div",{className:"w-full h-full flex items-center justify-center bg-gray-950",children:[e.jsx(Ge,{className:"w-8 h-8 text-white opacity-50"}),e.jsx("video",{src:B,className:`absolute inset-0 w-full h-full object-cover ${T?"opacity-50":""}`})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center border border-primary/20 shrink-0",children:e.jsx(Oe,{className:"w-5 h-5 text-primary"})}),e.jsx("audio",{src:B,controls:!0,className:"w-full h-8 custom-audio-player"}),e.jsxs("button",{onClick:()=>re(v,B),disabled:G,className:"shrink-0 bg-indigo-600 hover:bg-indigo-500 text-white p-2 rounded-lg transition-colors flex items-center gap-2 group/ai",children:[G?e.jsx("span",{className:"animate-spin text-xs",children:"⚡"}):e.jsx(ce,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline text-[10px] font-black uppercase",children:"Soundcheck"})]})]}),e.jsx("div",{className:`absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center ${t==="audios"?"hidden":""}`,children:e.jsx("button",{onClick:()=>L(v),className:`p-2.5 bg-red-600 hover:bg-red-700 text-white rounded-xl transition-all transform hover:scale-110 shadow-lg ${T?"pointer-events-none":""}`,children:T?e.jsx("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}):e.jsx(ve,{className:"w-5 h-5"})})}),t==="audios"&&e.jsx("button",{onClick:()=>L(v),className:"p-2 text-gray-500 hover:text-red-500 transition-colors",children:e.jsx(ve,{className:"w-5 h-5"})})]},v||V)})]}),U.length===0&&!P&&e.jsx("div",{className:"py-20",children:e.jsx(Me,{icon:t==="photos"?ke:t==="videos"?Ge:Oe,title:`Galeria de ${t==="photos"?"fotos":t==="videos"?"vídeos":"áudios"} vazia`,description:"Destaque seus melhores momentos para atrair novas oportunidades."})})]})}),e.jsx(Ma,{isOpen:D,onClose:()=>M(!1),analysis:A}),e.jsx("style",{children:`
                .custom-audio-player::-webkit-media-controls-enclosure { background-color: transparent; }
                .custom-audio-player::-webkit-media-controls-panel { filter: invert(1); }
            `})]})},za=({profile:s,onUpdate:r})=>{var _;const[t,a]=c.useState([]),[i,n]=c.useState(!0),[o,l]=c.useState(""),[d,x]=c.useState(""),[f,m]=c.useState(""),[u,S]=c.useState(""),[b,w]=c.useState(!1),[D,M]=c.useState(!1),[A,y]=c.useState(null),j=(_=s.artista)==null?void 0:_.id;c.useEffect(()=>{(async()=>{if(!j){n(!1);return}n(!0);try{const g=await Te.list(j);a(g)}catch(g){l("Falha ao carregar os membros da banda: "+q(g))}finally{n(!1)}})()},[j]),c.useEffect(()=>{if(d||o){const p=setTimeout(()=>{x(""),l("")},5e3);return()=>clearTimeout(p)}},[d,o]);const R=async p=>{if(p.preventDefault(),!(!f||!u||!j)){w(!0),x("Adicionando membro...");try{const g=await Te.add(j,f,u);a(h=>[...h,g]),m(""),S(""),x("Membro adicionado com sucesso!"),r()}catch(g){l("Erro ao adicionar membro: "+q(g))}finally{w(!1)}}},P=p=>{y(p),M(!0)},F=async()=>{if(A){w(!0);try{await Te.remove(A.id),a(p=>p.filter(g=>g.id!==A.id)),x("Membro removido com sucesso."),r()}catch(p){l("Erro ao remover membro: "+q(p))}finally{w(!1),M(!1),y(null)}}};return e.jsxs("div",{className:"animate-fade-in",children:[e.jsx("h2",{className:"text-2xl font-bold font-poppins text-white mb-6",children:"Integrantes da Banda"}),e.jsxs("div",{className:"bg-gray-800 rounded-xl border border-gray-700 p-6 mb-8 shadow-lg",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-400 uppercase mb-4",children:"Adicionar Novo Integrante"}),e.jsxs("form",{onSubmit:R,className:"grid grid-cols-1 md:grid-cols-12 gap-4 items-end",children:[e.jsxs("div",{className:"md:col-span-5",children:[e.jsx("label",{htmlFor:"memberName",className:"block text-xs font-medium text-gray-500 mb-1",children:"Nome"}),e.jsx("input",{type:"text",id:"memberName",value:f,onChange:p=>m(p.target.value),required:!0,className:"w-full bg-gray-900 border border-gray-600 rounded-lg p-3 text-white focus:outline-none focus:ring-2 focus:ring-secondary focus:border-transparent transition-all",placeholder:"Ex: João Silva"})]}),e.jsxs("div",{className:"md:col-span-5",children:[e.jsx("label",{htmlFor:"memberInstrument",className:"block text-xs font-medium text-gray-500 mb-1",children:"Função / Instrumento"}),e.jsx("input",{type:"text",id:"memberInstrument",value:u,onChange:p=>S(p.target.value),required:!0,className:"w-full bg-gray-900 border border-gray-600 rounded-lg p-3 text-white focus:outline-none focus:ring-2 focus:ring-secondary focus:border-transparent transition-all",placeholder:"Ex: Guitarra Solo"})]}),e.jsx("div",{className:"md:col-span-2",children:e.jsxs("button",{type:"submit",disabled:b,className:"w-full flex justify-center items-center gap-2 bg-secondary text-white font-bold py-3 px-4 rounded-lg hover:bg-opacity-90 disabled:opacity-50 transition-all shadow-lg shadow-secondary/20 h-[50px]",children:[e.jsx(yt,{className:"w-5 h-5"}),e.jsx("span",{className:"hidden md:inline",children:"Add"}),e.jsx("span",{className:"md:hidden",children:"Adicionar"})]})})]})]}),d&&e.jsx("div",{className:"p-3 mb-6 rounded-lg bg-green-500/10 border border-green-500/20 text-green-400 text-center text-sm",children:d}),o&&e.jsx("div",{className:"p-3 mb-6 rounded-lg bg-red-500/10 border border-red-500/20 text-red-400 text-center text-sm",children:o}),i?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-2"}),"Carregando membros..."]}):e.jsx("div",{className:"space-y-3",children:t.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.map(p=>e.jsxs("div",{className:"bg-gray-800 p-4 rounded-xl border border-gray-700 flex justify-between items-center group hover:border-primary/50 transition-colors shadow-sm hover:shadow-md",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-700 flex items-center justify-center text-gray-400 font-bold text-lg border border-gray-600 group-hover:border-primary/50 group-hover:text-primary transition-colors",children:p.nome.charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-white text-lg",children:p.nome}),e.jsx("p",{className:"text-sm text-gray-400",children:p.instrumento})]})]}),e.jsx("button",{onClick:()=>P(p),className:"text-gray-500 hover:text-red-500 p-2 rounded-full hover:bg-red-500/10 transition-colors",title:"Remover integrante",children:e.jsx(ve,{className:"w-5 h-5"})})]},p.id))}):e.jsx(Me,{icon:jt,title:"Banda Solo?",description:"Você ainda não adicionou nenhum integrante. Adicione músicos, técnicos ou roadies para completar seu perfil."})}),e.jsx(Zt,{isOpen:D,onClose:()=>M(!1),onConfirm:F,title:"Confirmar Remoção",message:e.jsxs("p",{children:["Tem certeza que deseja remover o integrante ",e.jsx("strong",{className:"text-white",children:A==null?void 0:A.nome}),"?"]}),confirmText:"Sim, Remover",isConfirming:b})]})},Ye=({profile:s,onUpdate:r})=>{const[t,a]=c.useState(!1),[i,n]=c.useState(""),[o,l]=c.useState(!1),d=s.status_verificacao;s.tipo;const x=async f=>{if(!f.target.files||f.target.files.length===0)return;const m=f.target.files[0];if(m.size>5*1024*1024){n("O arquivo deve ter no máximo 5MB.");return}a(!0),n(""),l(!1);try{const u=m.name.split(".").pop(),S=`${s.auth_id}/kyc/documento_${Date.now()}.${u}`,b=await Z.upload("site",S,m);await Q.submitKyc(s.id,b),l(!0),r()}catch(u){n(q(u))}finally{a(!1)}};return e.jsxs("div",{className:"bg-gray-850 p-6 rounded-2xl border border-gray-700 shadow-inner",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("div",{className:`p-3 rounded-full ${d==="verificado"?"bg-green-500/20 text-green-400":d==="pendente"?"bg-yellow-500/20 text-yellow-400":"bg-primary/20 text-primary"}`,children:e.jsx(Je,{className:"w-8 h-8"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white font-poppins",children:"Verificação de Identidade"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Aumente sua credibilidade e segurança na rede."})]})]}),e.jsxs("div",{className:"space-y-6",children:[d==="verificado"?e.jsxs("div",{className:"bg-green-500/10 border border-green-500/30 p-4 rounded-xl flex items-start gap-3",children:[e.jsx(ne,{className:"w-5 h-5 text-green-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-green-300 font-bold",children:"Perfil Verificado"}),e.jsx("p",{className:"text-xs text-green-300/70 mt-1",children:"Sua identidade foi confirmada. O selo azul agora aparece ao lado do seu nome em buscas e no perfil público."})]})]}):d==="pendente"?e.jsxs("div",{className:"bg-yellow-500/10 border border-yellow-500/30 p-4 rounded-xl flex items-start gap-3",children:[e.jsx(ye,{className:"w-5 h-5 text-yellow-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-yellow-300 font-bold",children:"Análise em Andamento"}),e.jsx("p",{className:"text-xs text-yellow-300/70 mt-1",children:"Já recebemos seu documento. Nossa equipe revisará os dados em até 48 horas úteis."})]})]}):e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-xl border border-gray-800",children:[e.jsx("h4",{className:"text-sm font-bold text-gray-300 mb-2",children:"Por que verificar?"}),e.jsxs("ul",{className:"text-xs text-gray-500 space-y-2",children:[e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(ne,{className:"w-3 h-3 text-primary"})," Selo de confiança no perfil público"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(ne,{className:"w-3 h-3 text-primary"})," Maior prioridade em recomendações de contratantes"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(ne,{className:"w-3 h-3 text-primary"})," Desbloqueio de saques acima de R$ 5.000,00"]})]})]}),d==="rejeitado"&&e.jsxs("div",{className:"bg-red-500/10 border border-red-500/30 p-4 rounded-xl flex items-start gap-3",children:[e.jsx(Xt,{className:"w-5 h-5 text-red-400 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-red-300 font-bold",children:"Verificação Reprovada"}),e.jsx("p",{className:"text-xs text-red-300/70 mt-1",children:"Houve um problema com o documento anterior. Por favor, envie uma nova foto nítida do seu RG, CNH ou Cartão CNPJ."})]})]}),e.jsx("div",{className:"relative",children:e.jsxs("label",{className:`w-full flex flex-col items-center justify-center py-8 border-2 border-dashed border-gray-700 rounded-2xl cursor-pointer hover:bg-primary/5 hover:border-primary transition-all ${t?"opacity-50 pointer-events-none":""}`,children:[e.jsx(he,{className:"w-10 h-10 text-gray-500 mb-2"}),e.jsx("span",{className:"text-sm font-bold text-gray-300",children:t?"Enviando documento...":"Enviar Foto do Documento"}),e.jsx("span",{className:"text-[10px] text-gray-500 mt-1",children:"Formatos: JPG, PNG ou PDF (Máx 5MB)"}),e.jsx("input",{type:"file",className:"hidden",accept:"image/*,.pdf",onChange:x})]})})]}),i&&e.jsx("p",{className:"text-xs text-red-400 text-center",children:i}),o&&e.jsx("p",{className:"text-xs text-green-400 text-center",children:"Documento enviado com sucesso!"})]})]})},Ia=({profile:s,onUpdate:r,initialTab:t})=>{const[a,i]=c.useState("dados");return c.useEffect(()=>{t&&["dados","portfolio","banda","verificacao"].includes(t)&&i(t)},[t]),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap gap-2 border-b border-gray-700 pb-2",children:[e.jsxs("button",{onClick:()=>i("dados"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-bold transition-all ${a==="dados"?"bg-primary text-dark":"text-gray-400 hover:bg-gray-800"}`,children:[e.jsx(pe,{className:"w-4 h-4"})," Dados Básicos"]}),e.jsxs("button",{onClick:()=>i("portfolio"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-bold transition-all ${a==="portfolio"?"bg-primary text-dark":"text-gray-400 hover:bg-gray-800"}`,children:[e.jsx(ke,{className:"w-4 h-4"})," Portfólio"]}),e.jsxs("button",{onClick:()=>i("banda"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-bold transition-all ${a==="banda"?"bg-primary text-dark":"text-gray-400 hover:bg-gray-800"}`,children:[e.jsx(jt,{className:"w-4 h-4"})," Banda"]}),e.jsxs("button",{onClick:()=>i("verificacao"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-bold transition-all ${a==="verificacao"?"bg-primary text-dark":"text-gray-400 hover:bg-gray-800"}`,children:[e.jsx(Je,{className:"w-4 h-4"})," Verificação"]})]}),e.jsxs("div",{className:"animate-fade-in min-h-[500px]",children:[a==="dados"&&e.jsx(Pa,{initialProfile:s,onProfileUpdate:r}),a==="portfolio"&&e.jsx(Rt,{profile:s,onUpdate:r}),a==="banda"&&e.jsx(za,{profile:s,onUpdate:r}),a==="verificacao"&&e.jsx(Ye,{profile:s,onUpdate:r})]})]})},mt={viewsLast30Days:[12,18,15,25,32,28,45,38,42,58,65,60,72,85,90,88,110,105,95,120,135,128],geoDistribution:[{city:"São Paulo, SP",count:450,percentage:45},{city:"Campinas, SP",count:120,percentage:12},{city:"Curitiba, PR",count:90,percentage:9},{city:"Rio de Janeiro, RJ",count:85,percentage:8},{city:"Santos, SP",count:55,percentage:5}]},$a=({data:s,color:r})=>{const t=Math.max(...s),a=s.map((i,n)=>`${n/(s.length-1)*100},${100-i/t*100}`).join(" ");return e.jsx("svg",{viewBox:"0 0 100 100",className:"w-full h-24 overflow-visible",preserveAspectRatio:"none",children:e.jsx("polyline",{points:a,fill:"none",stroke:r,strokeWidth:"3",vectorEffect:"non-scaling-stroke",strokeLinecap:"round",strokeLinejoin:"round"})})},Pt=({profile:s})=>{const r=s.plano==="free";return s.tipo,e.jsxs("div",{className:"relative animate-fade-in",children:[e.jsx("div",{className:"flex justify-between items-center mb-8",children:e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold font-poppins text-white flex items-center gap-2",children:[e.jsx(_e,{className:"text-primary w-7 h-7"}),"Market Intelligence"]}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Dados detalhados sobre o alcance do seu perfil."})]})}),r&&e.jsxs("div",{className:"absolute inset-0 z-20 bg-gray-900/60 backdrop-blur-md rounded-2xl flex flex-col items-center justify-center text-center p-8 border border-primary/20",children:[e.jsx("div",{className:"w-20 h-20 bg-primary/10 rounded-full flex items-center justify-center mb-6 border border-primary/20 animate-bounce-slow",children:e.jsx(Ze,{className:"w-10 h-10 text-primary"})}),e.jsx("h3",{className:"text-2xl font-black text-white mb-2",children:"Desbloqueie sua Inteligência"}),e.jsx("p",{className:"text-gray-300 max-w-md mb-8",children:"Assinantes PRO e Business têm acesso a gráficos de conversão, origem dos visitantes e tendências de mercado."}),e.jsxs(oe,{to:"/planos",className:"bg-primary text-dark font-black py-4 px-12 rounded-full hover:bg-white transition-all shadow-xl shadow-primary/20 flex items-center gap-2",children:[e.jsx(ce,{className:"w-5 h-5"}),"Fazer Upgrade Agora"]})]}),e.jsxs("div",{className:`grid grid-cols-1 lg:grid-cols-3 gap-6 ${r?"opacity-40 grayscale pointer-events-none":""}`,children:[e.jsxs("div",{className:"lg:col-span-2 bg-gray-850 p-6 rounded-2xl border border-gray-700 shadow-inner",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-500 text-[10px] font-black uppercase tracking-widest mb-1",children:"Visualizações de Perfil"}),e.jsx("h4",{className:"text-3xl font-black text-white font-mono",children:"1.284"})]}),e.jsx("span",{className:"bg-green-500/10 text-green-400 text-xs font-bold px-2 py-1 rounded",children:"+14% vs anterior"})]}),e.jsx("div",{className:"h-32 w-full",children:e.jsx($a,{data:mt.viewsLast30Days,color:"#51D2EE"})}),e.jsxs("div",{className:"flex justify-between mt-4 text-[10px] text-gray-600 font-bold uppercase tracking-tighter",children:[e.jsx("span",{children:"30 dias atrás"}),e.jsx("span",{children:"Hoje"})]})]}),e.jsxs("div",{className:"bg-gray-850 p-6 rounded-2xl border border-gray-700 shadow-inner",children:[e.jsx("p",{className:"text-gray-500 text-[10px] font-black uppercase tracking-widest mb-6",children:"Funil de Conversão"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[e.jsx("span",{className:"text-gray-400 font-bold",children:"Alcance"}),e.jsx("span",{className:"text-white",children:"100%"})]}),e.jsx("div",{className:"h-2 bg-gray-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-500 w-full"})})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[e.jsx("span",{className:"text-gray-400 font-bold",children:"Interesse (Cliques)"}),e.jsx("span",{className:"text-white",children:"32%"})]}),e.jsx("div",{className:"h-2 bg-gray-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-purple-500 w-[32%]"})})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[e.jsx("span",{className:"text-gray-400 font-bold",children:"Propostas"}),e.jsx("span",{className:"text-primary font-black",children:"8.4%"})]}),e.jsx("div",{className:"h-2 bg-gray-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-primary w-[8.4%]"})})]})]}),e.jsx("div",{className:"mt-8 pt-6 border-t border-gray-800",children:e.jsxs("p",{className:"text-[10px] text-gray-500 leading-relaxed",children:["💡 ",e.jsx("strong",{children:"Dica RESONA:"})," Perfil com vídeos de alta qualidade convertem até 45% mais visitantes em propostas."]})})]}),e.jsxs("div",{className:"bg-gray-850 p-6 rounded-2xl border border-gray-700 shadow-inner lg:col-span-1",children:[e.jsx("p",{className:"text-gray-500 text-[10px] font-black uppercase tracking-widest mb-4",children:"Visitantes por Localidade"}),e.jsx("div",{className:"space-y-4",children:mt.geoDistribution.map((t,a)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx($e,{className:"w-3 h-3 text-gray-600"}),e.jsx("span",{className:"text-xs text-gray-300 truncate w-32",children:t.city})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-20 h-1.5 bg-gray-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gray-600",style:{width:`${t.percentage}%`}})}),e.jsxs("span",{className:"text-[10px] font-mono text-gray-500 w-8",children:[t.percentage,"%"]})]})]},a))})]}),e.jsxs("div",{className:"lg:col-span-2 bg-gray-850 p-6 rounded-2xl border border-gray-700 shadow-inner overflow-hidden relative",children:[e.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-5",children:e.jsx(_e,{className:"w-32 h-32 text-primary"})}),e.jsx("p",{className:"text-gray-500 text-[10px] font-black uppercase tracking-widest mb-6",children:"Performance Financeira (Estimado Anual)"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"p-4 bg-gray-900/50 rounded-xl border border-gray-800",children:[e.jsx("p",{className:"text-gray-500 text-[9px] font-bold uppercase mb-1",children:"Total Faturado"}),e.jsx("p",{className:"text-xl font-black text-white font-mono",children:"R$ 42.5k"})]}),e.jsxs("div",{className:"p-4 bg-gray-900/50 rounded-xl border border-gray-800",children:[e.jsx("p",{className:"text-gray-500 text-[9px] font-bold uppercase mb-1",children:"Ticket Médio"}),e.jsx("p",{className:"text-xl font-black text-primary font-mono",children:"R$ 850"})]}),e.jsxs("div",{className:"p-4 bg-gray-900/50 rounded-xl border border-gray-800",children:[e.jsx("p",{className:"text-gray-500 text-[9px] font-bold uppercase mb-1",children:"Crescimento YoY"}),e.jsx("p",{className:"text-xl font-black text-green-400 font-mono",children:"+28%"})]})]})]})]})]})},Fa=({profile:s,initialTab:r})=>{const[t,a]=c.useState("analytics");return c.useEffect(()=>{r&&["analytics","avaliacoes"].includes(r)&&a(r)},[r]),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap gap-2 border-b border-gray-700 pb-2",children:[e.jsxs("button",{onClick:()=>a("analytics"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-bold transition-all ${t==="analytics"?"bg-primary text-dark":"text-gray-400 hover:bg-gray-800"}`,children:[e.jsx(_e,{className:"w-4 h-4"})," Analytics"]}),e.jsxs("button",{onClick:()=>a("avaliacoes"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-bold transition-all ${t==="avaliacoes"?"bg-primary text-dark":"text-gray-400 hover:bg-gray-800"}`,children:[e.jsx(le,{className:"w-4 h-4"})," Avaliações"]})]}),e.jsxs("div",{className:"animate-fade-in",children:[t==="analytics"&&e.jsx(Pt,{profile:s}),t==="avaliacoes"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h3",{className:"text-xl font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx(le,{className:"w-6 h-6 text-yellow-400"}),"Minha Reputação"]}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Veja o que os estabelecimentos estão dizendo sobre seus shows."}),e.jsx(vt,{targetId:s.id})]})]})]})},Ta=({className:s="w-6 h-6"})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:s,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})}),La=()=>e.jsxs("div",{className:"flex items-center p-4 animate-pulse",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-700"}),e.jsxs("div",{className:"ml-4 flex-grow",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"h-4 bg-gray-700 rounded w-1/2"}),e.jsx("div",{className:"h-3 bg-gray-700 rounded w-1/4"})]}),e.jsx("div",{className:"h-3 bg-gray-700 rounded w-3/4 mt-2"})]})]}),Mt=({currentUser:s})=>{const[r,t]=c.useState([]),[a,i]=c.useState(null),[n,o]=c.useState([]),[l,d]=c.useState(""),[x,f]=c.useState(!0),[m,u]=c.useState(!1),[S,b]=c.useState(!1),[w,D]=c.useState(""),M=c.useRef(null),A=()=>{var h;(h=M.current)==null||h.scrollIntoView({behavior:"smooth"})};c.useEffect(()=>{n.length>0&&A()},[n]);const y=c.useCallback(async()=>{f(!0);try{const C=(await Le.getConversations(s.id)).map(k=>({id:k.id,nome_participante:k.nome_participante,foto_participante:k.foto_participante,ultima_mensagem:k.ultima_mensagem||"Nenhuma mensagem ainda.",timestamp_ultima_mensagem:k.timestamp_ultima_mensagem?new Date(k.timestamp_ultima_mensagem).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"}):"",other_participant_id:k.other_participant_id}));t(C)}catch(h){console.error("Error fetching conversations via API:",h.message)}finally{f(!1)}},[s.id]);c.useEffect(()=>{y()},[y]),c.useEffect(()=>{if(!(s!=null&&s.id))return;const h=we.channel(`notificacoes:${s.id}`);return h.on("postgres_changes",{event:"INSERT",schema:"public",table:"notificacoes",filter:`usuario_id=eq.${s.id}`},C=>{C.new.tipo==="mensagem"&&y()}).subscribe(),()=>{we.removeChannel(h)}},[s,y]),c.useEffect(()=>{if(!a)return;(async()=>{u(!0);try{const k=await Le.getMessages(a.id);o(k)}catch(k){console.error("Error fetching messages:",k)}finally{u(!1),setTimeout(A,100)}})();const C=we.channel(`conversa-${a.id}`);return C.on("postgres_changes",{event:"INSERT",schema:"public",table:"mensagens",filter:`conversa_id=eq.${a.id}`},k=>{o(I=>[...I,k.new])}).subscribe(),()=>{we.removeChannel(C)}},[a]);const j=async h=>{if(h.preventDefault(),!(!l.trim()||!a)){b(!0);try{await Le.sendMessage(a.id,s.id,l),d(""),y(),await Tt.create({usuario_id:a.other_participant_id,tipo:"mensagem",titulo:`Nova mensagem de ${s.nome}`,descricao:l.substring(0,50)+(l.length>50?"...":""),url_destino:"/painel?open=mensagens"})}catch(C){console.error("Error sending message or notification:",C)}finally{b(!1),setTimeout(A,100)}}},R=h=>{if(!h)return null;const{data:C}=we.storage.from("perfis").getPublicUrl(h);return C.publicUrl},P=r.filter(h=>h.nome_participante.toLowerCase().includes(w.toLowerCase())),F=()=>{i(null)},_=h=>{const C={};return h.forEach(k=>{const I=new Date(k.criado_em).toISOString().split("T")[0];C[I]||(C[I]=[]),C[I].push(k)}),C},p=h=>{const C=new Date(h+"T00:00:00"),k=new Date,I=new Date(k);return I.setDate(I.getDate()-1),C.toDateString()===k.toDateString()?"Hoje":C.toDateString()===I.toDateString()?"Ontem":C.toLocaleDateString("pt-BR",{weekday:"long",day:"numeric",month:"long"})},g=_(n);return e.jsxs("div",{className:"flex flex-col h-full animate-fade-in",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[e.jsx("div",{className:"p-3 bg-primary/10 rounded-2xl border border-primary/20",children:e.jsx(xe,{className:"w-8 h-8 text-primary"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-black font-poppins text-white uppercase tracking-tighter leading-none",children:"Mensagens"}),e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase tracking-[0.3em] mt-1",children:"Inbox e Negociações"})]})]}),e.jsxs("div",{className:"flex flex-grow h-[calc(100vh-280px)] min-h-[600px] glass-card rounded-[2rem] overflow-hidden border-white/5 relative",children:[e.jsx("div",{className:"absolute top-0 left-0 w-64 h-64 bg-primary/5 rounded-full blur-[100px] pointer-events-none"}),e.jsxs("div",{className:`w-full md:w-1/3 lg:w-96 border-r border-white/5 flex flex-col bg-white/[0.02] relative z-10 ${a?"hidden md:flex":"flex"}`,children:[e.jsx("div",{className:"p-6 border-b border-white/5 shrink-0 bg-white/[0.03]",children:e.jsxs("div",{className:"relative group",children:[e.jsx("input",{type:"text",placeholder:"Buscar conversas...",className:"w-full bg-white/5 border border-white/5 rounded-2xl py-4 pl-12 pr-4 focus:outline-none focus:ring-2 focus:ring-primary/30 text-white text-sm transition-all placeholder:text-gray-600 font-medium",value:w,onChange:h=>D(h.target.value)}),e.jsx(Jt,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-600 group-focus-within:text-primary transition-colors"})]})}),e.jsx("div",{className:"flex-grow overflow-y-auto custom-scrollbar",children:x?e.jsx("div",{children:Array.from({length:5}).map((h,C)=>e.jsx(La,{},C))}):P.length>0?P.map(h=>{const C=R(h.foto_participante),k=(a==null?void 0:a.id)===h.id;return e.jsxs("div",{onClick:()=>i(h),className:`relative flex items-center p-6 cursor-pointer transition-all border-b border-white/[0.02] last:border-0 hover:bg-white/[0.05] group/convo ${k?"bg-white/[0.08] before:absolute before:left-0 before:top-4 before:bottom-4 before:w-1.5 before:bg-primary before:rounded-r-full before:shadow-[0_0_10px_rgba(81,210,238,0.5)]":""}`,children:[e.jsxs("div",{className:"relative flex-shrink-0",children:[C?e.jsx("img",{src:C,alt:h.nome_participante,className:"w-14 h-14 rounded-2xl object-cover ring-2 ring-white/5 transition-transform group-hover/convo:scale-105"}):e.jsx("div",{className:"w-14 h-14 rounded-2xl bg-white/5 flex items-center justify-center border border-white/5",children:e.jsx(pe,{className:"w-8 h-8 text-gray-600"})}),e.jsx("div",{className:"absolute -bottom-1 -right-1 w-4 h-4 bg-green-500 rounded-full border-4 border-gray-900 shadow-lg"})]}),e.jsxs("div",{className:"ml-5 flex-grow overflow-hidden",children:[e.jsxs("div",{className:"flex justify-between items-baseline mb-1",children:[e.jsx("h3",{className:`font-black truncate text-[13px] font-poppins tracking-tight ${k?"text-white":"text-gray-300 group-hover/convo:text-white"}`,children:h.nome_participante}),e.jsx("span",{className:"text-[10px] text-gray-600 font-black flex-shrink-0 ml-2 uppercase tracking-tighter",children:h.timestamp_ultima_mensagem})]}),e.jsx("p",{className:`text-[11px] truncate leading-none font-medium ${k?"text-primary":"text-gray-500"}`,children:h.ultima_mensagem})]})]},h.id)}):e.jsx("div",{className:"h-full p-4 flex items-center justify-center",children:e.jsx(Me,{icon:xe,title:"Nenhuma conversa",description:"Inicie um bate-papo com outros usuários através do perfil deles."})})})]}),e.jsx("div",{className:"flex flex-col h-full relative",children:a?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-5 border-b border-white/5 flex items-center bg-white/[0.03] backdrop-blur-xl shadow-xl shrink-0 z-10",children:[e.jsx("button",{onClick:F,className:"md:hidden mr-4 text-gray-400 hover:text-white p-2 bg-white/5 rounded-xl",children:e.jsx(Yt,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex items-center gap-4",children:[R(a.foto_participante)?e.jsx("img",{src:R(a.foto_participante),alt:a.nome_participante,className:"w-12 h-12 rounded-2xl object-cover shadow-2xl border border-white/10"}):e.jsx("div",{className:"w-12 h-12 rounded-2xl bg-white/5 flex items-center justify-center border border-white/5",children:e.jsx(pe,{className:"w-8 h-8 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"font-black text-white font-poppins tracking-tighter leading-none text-lg",children:a.nome_participante}),e.jsxs("span",{className:"text-[10px] text-primary flex items-center gap-2 font-black uppercase tracking-widest mt-1",children:[e.jsx("span",{className:"w-2 h-2 bg-primary rounded-full animate-pulse shadow-[0_0_8px_rgba(81,210,238,0.5)]"})," Online"]})]})]})]}),e.jsxs("div",{className:"flex-grow p-4 md:p-6 overflow-y-auto space-y-6 relative z-10 custom-scrollbar",children:[m?e.jsx("div",{className:"flex justify-center items-center h-full",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):Object.keys(g).length===0?e.jsx("div",{className:"flex h-full items-center justify-center text-gray-500 text-sm italic",children:"Nenhuma mensagem. Diga olá!"}):Object.keys(g).sort().map(h=>e.jsxs("div",{children:[e.jsx("div",{className:"flex justify-center sticky top-4 z-20 mb-8",children:e.jsx("span",{className:"bg-white/5 backdrop-blur-xl text-gray-500 text-[10px] uppercase font-black px-5 py-2 rounded-full border border-white/5 tracking-[0.3em] shadow-2xl",children:p(h)})}),e.jsx("div",{className:"space-y-6",children:g[h].map(C=>{const k=C.remetente_id===s.id;return e.jsx("div",{className:`flex ${k?"justify-end":"justify-start"} animate-fade-in`,children:e.jsxs("div",{className:`max-w-[85%] md:max-w-[65%] p-5 shadow-2xl relative group/msg transition-all duration-300 ${k?"bg-gradient-to-br from-primary to-secondary text-dark rounded-[2rem] rounded-tr-none":"bg-white/5 text-white rounded-[2rem] rounded-tl-none border border-white/5 hover:border-white/20"}`,children:[e.jsx("p",{className:`text-sm leading-relaxed whitespace-pre-wrap font-medium ${k?"font-black":""}`,children:C.texto}),e.jsx("div",{className:`flex items-center justify-end gap-2 mt-3 ${k?"text-black/50":"text-gray-600"}`,children:e.jsx("span",{className:"text-[9px] font-black uppercase tracking-tighter",children:new Date(C.criado_em).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})})})]})},C.id)})})]},h)),e.jsx("div",{ref:M})]}),s.tipo==="artista"&&!fe(s).complete&&e.jsx("div",{className:"px-4 pb-2 pt-2 bg-gray-900 z-20",children:e.jsx("div",{className:"bg-yellow-500/10 border border-yellow-500/50 rounded-lg p-3 backdrop-blur-sm",children:e.jsxs("p",{className:"text-yellow-200 text-xs text-center flex items-center justify-center gap-2",children:[e.jsx("span",{className:"w-2 h-2 bg-yellow-500 rounded-full animate-pulse"}),"Seu perfil de artista está incompleto. Complete-o para enviar mensagens."]})})}),e.jsx("div",{className:"p-6 bg-white/[0.02] border-t border-white/5 shrink-0 relative z-20",children:e.jsxs("form",{onSubmit:j,className:"flex items-end gap-4 relative",children:[e.jsx("div",{className:`flex-grow bg-white/5 rounded-[2rem] border border-white/10 transition-all flex items-center shadow-inner group/input ${s.tipo==="artista"&&!fe(s).complete?"opacity-50 cursor-not-allowed":"focus-within:border-primary/50 focus-within:bg-white/[0.08]"}`,children:e.jsx("textarea",{value:l,onChange:h=>d(h.target.value),onKeyDown:h=>{h.key==="Enter"&&!h.shiftKey&&(h.preventDefault(),j(h))},placeholder:s.tipo==="artista"&&!fe(s).complete?"Complete seu perfil para enviar mensagens.":"Digite sua mensagem...",className:"w-full bg-transparent border-none py-5 px-6 text-white placeholder-gray-600 focus:ring-0 max-h-32 min-h-[60px] resize-none custom-scrollbar disabled:cursor-not-allowed font-medium",rows:1,disabled:S||s.tipo==="artista"&&!fe(s).complete})}),e.jsx("button",{type:"submit",disabled:S||!l.trim()||s.tipo==="artista"&&!fe(s).complete,className:"h-[60px] w-[60px] bg-white text-dark rounded-2xl hover:bg-primary transition-all disabled:opacity-50 disabled:hover:bg-white flex items-center justify-center flex-shrink-0 shadow-xl active:scale-90",children:S?e.jsx("div",{className:"w-6 h-6 border-3 border-dark/30 border-t-dark rounded-full animate-spin"}):e.jsx(Ta,{className:"w-6 h-6"})})]})})]}):e.jsx("div",{className:"flex flex-col items-center justify-center h-full p-8 text-center relative z-10",children:e.jsx(Me,{icon:xe,title:"Suas Mensagens",description:"Selecione uma conversa ao lado para ver o histórico ou responda a novas propostas."})})})]})]})},Ba=({isOpen:s,onClose:r,profile:t})=>{var W,E,z,H,U,ee;const[a,i]=c.useState([]),[n,o]=c.useState([]),[l,d]=c.useState(!0),[x,f]=c.useState(""),[m,u]=c.useState("contracts"),[S,b]=c.useState(!1),[w,D]=c.useState("confirm"),[M,A]=c.useState(""),y=50,j=t.tipo==="artista",R=!!((E=(W=t.artista)==null?void 0:W.dados_bancarios)!=null&&E.chave_pix),P=async()=>{var N,O;d(!0);try{const J=j?(N=t.artista)==null?void 0:N.id:(O=t.estabelecimento)==null?void 0:O.id;if(!J)throw new Error("ID do perfil não encontrado.");const[X,L]=await Promise.all([ut.getFinancialHistory(J,t.tipo),j?Ke.getPayoutHistory(t.id):Promise.resolve([])]);i(X),o(L)}catch(J){f(q(J))}finally{d(!1)}};if(c.useEffect(()=>{s&&P()},[s,t,j]),!s)return null;const F=N=>{const O=Nt(N.valor,N.taxa_servico);return j?O.cache:O.total},_=a.filter(N=>be(N.data_evento,N.status)).reduce((N,O)=>N+F(O),0),p=n.filter(N=>N.status!=="rejeitado").reduce((N,O)=>N+O.valor,0),g=Math.max(0,_-p),h=a.filter(N=>N.status==="concluido"&&!be(N.data_evento,N.status)).reduce((N,O)=>N+F(O),0),C=a.filter(N=>N.status==="assinado"||N.status==="enviado"&&N.valor).reduce((N,O)=>N+F(O),0),k=j&&g>=y&&R&&!S,I=async()=>{if(w!=="processing"){A(""),D("processing");try{await Ke.requestPayout(t.id,g,t.artista.dados_bancarios.chave_pix,t.artista.dados_bancarios.tipo_chave),D("done"),await P()}catch(N){A(q(N)),D("confirm")}}},Y=()=>{if(a.length===0)return;const N=["Data Evento",j?"Contratante":"Artista","Status","Previsão Liberação","Valor (R$)","Data Pagamento"],O=a.map(L=>{var V,v,T,G,se,ue,Ae,ge;if(L.status==="cancelado"&&!L.data_pagamento)return null;const re=j?Array.isArray(L.estabelecimentos)?(v=(V=L.estabelecimentos[0])==null?void 0:V.usuarios)==null?void 0:v.nome:(G=(T=L.estabelecimentos)==null?void 0:T.usuarios)==null?void 0:G.nome:Array.isArray(L.artistas)?(ue=(se=L.artistas[0])==null?void 0:se.usuarios)==null?void 0:ue.nome:(ge=(Ae=L.artistas)==null?void 0:Ae.usuarios)==null?void 0:ge.nome,te=be(L.data_evento,L.status),ae=Qt(L.data_evento);let B=L.status==="concluido"?te?"Liberado":"Em Custódia":L.status==="cancelado"?"Cancelado":"Pendente";return[new Date(L.data_evento).toLocaleDateString("pt-BR"),`"${re||"N/A"}"`,B,L.status==="concluido"?ae.toLocaleDateString("pt-BR"):"-",F(L).toFixed(2),L.data_pagamento?new Date(L.data_pagamento).toLocaleDateString("pt-BR"):"-"].join(",")}).filter(Boolean),J="data:text/csv;charset=utf-8,"+[N.join(","),...O].join(`
`),X=document.createElement("a");X.setAttribute("href",encodeURI(J)),X.setAttribute("download",`resona_extrato_${new Date().toISOString().split("T")[0]}.csv`),document.body.appendChild(X),X.click(),document.body.removeChild(X)};return e.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-80 z-50 flex justify-center items-center p-4 backdrop-blur-sm",children:[e.jsxs("div",{className:"bg-gray-800 text-white rounded-xl shadow-2xl w-full max-w-3xl relative p-6 animate-fade-in border border-gray-700 max-h-[95vh] flex flex-col",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold font-poppins",children:"Carteira Digital"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Gerencie seus ganhos e saques"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:Y,disabled:a.length===0,className:"text-primary hover:text-white transition-colors p-2 rounded-md hover:bg-gray-700 disabled:opacity-50",title:"Exportar CSV",children:e.jsx(Kt,{className:"w-6 h-6"})}),e.jsx("button",{onClick:r,className:"text-gray-500 hover:text-white p-2 rounded-md hover:bg-gray-700",children:e.jsx(Ie,{})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 mb-8",children:[e.jsxs("div",{className:"bg-gray-900/50 p-5 rounded-2xl border-2 border-green-500/20 shadow-inner relative overflow-hidden group",children:[e.jsxs("div",{className:"relative z-10",children:[e.jsx("p",{className:"text-gray-500 text-[10px] font-black uppercase tracking-widest mb-1",children:"Saldo Disponível"}),e.jsxs("p",{className:"text-3xl font-black text-green-400 font-mono",children:["R$ ",g.toLocaleString("pt-BR",{minimumFractionDigits:2})]}),j&&e.jsxs("button",{onClick:()=>{D("confirm"),b(!0)},disabled:!k,className:`mt-4 w-full py-2 rounded-lg text-xs font-bold transition-all shadow-lg flex items-center justify-center gap-2 ${k?"bg-green-500 text-dark hover:bg-white hover:scale-105":"bg-gray-800 text-gray-500 cursor-not-allowed border border-gray-700"}`,children:[g<y?`Mínimo R$ ${y.toFixed(2)}`:R?"Solicitar Saque":"Cadastre seu PIX",k&&e.jsx(Oa,{className:"w-3 h-3"})]})]}),e.jsx(ne,{className:"absolute -right-2 -bottom-2 w-16 h-16 text-green-500/10"})]}),e.jsxs("div",{className:"bg-gray-900/50 p-5 rounded-2xl border border-blue-500/20 shadow-inner relative overflow-hidden",children:[e.jsx("p",{className:"text-gray-500 text-[10px] font-black uppercase tracking-widest mb-1",children:"Em Custódia"}),e.jsxs("p",{className:"text-2xl font-black text-blue-300 font-mono",children:["R$ ",h.toLocaleString("pt-BR",{minimumFractionDigits:2})]}),e.jsxs("p",{className:"text-[10px] text-gray-500 mt-2 flex items-center gap-1",children:[e.jsx(Ze,{className:"w-3 h-3"})," Protegido pelo RESONA"]}),e.jsx(Ze,{className:"absolute -right-2 -bottom-2 w-16 h-16 text-blue-500/10"})]}),e.jsxs("div",{className:"bg-gray-900/50 p-5 rounded-2xl border border-yellow-500/20 shadow-inner relative overflow-hidden",children:[e.jsx("p",{className:"text-gray-500 text-[10px] font-black uppercase tracking-widest mb-1",children:"Pendente"}),e.jsxs("p",{className:"text-2xl font-black text-yellow-400 font-mono",children:["R$ ",C.toLocaleString("pt-BR",{minimumFractionDigits:2})]}),e.jsxs("p",{className:"text-[10px] text-gray-500 mt-2 flex items-center gap-1",children:[e.jsx(ye,{className:"w-3 h-3"})," Aguardando pagamento"]}),e.jsx(ye,{className:"absolute -right-2 -bottom-2 w-16 h-16 text-yellow-500/10"})]})]}),e.jsxs("div",{className:"flex border-b border-gray-700 mb-6",children:[e.jsx("button",{onClick:()=>u("contracts"),className:`px-6 py-3 text-sm font-bold transition-all border-b-2 ${m==="contracts"?"border-primary text-primary":"border-transparent text-gray-500 hover:text-gray-300"}`,children:"Transações"}),j&&e.jsx("button",{onClick:()=>u("payouts"),className:`px-6 py-3 text-sm font-bold transition-all border-b-2 ${m==="payouts"?"border-primary text-primary":"border-transparent text-gray-500 hover:text-gray-300"}`,children:"Histórico de Saques"})]}),e.jsx("div",{className:"overflow-y-auto flex-grow custom-scrollbar",children:l?e.jsx("div",{className:"text-center py-12 text-gray-500 animate-pulse",children:"Sincronizando carteira..."}):m==="contracts"?a.length===0?e.jsx("div",{className:"py-20 text-center text-gray-600 italic",children:"Sem movimentações financeiras."}):e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{className:"text-gray-500 text-[10px] uppercase font-black sticky top-0 bg-gray-800 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"pb-4",children:"Evento"}),e.jsx("th",{className:"pb-4",children:j?"Origem":"Destino"}),e.jsx("th",{className:"pb-4",children:"Status"}),e.jsx("th",{className:"pb-4 text-right",children:"Valor"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-700 text-sm",children:a.map(N=>{var X,L,re,te,ae,B,V,v;if(N.status==="cancelado"&&!N.data_pagamento)return null;const O=j?Array.isArray(N.estabelecimentos)?(L=(X=N.estabelecimentos[0])==null?void 0:X.usuarios)==null?void 0:L.nome:(te=(re=N.estabelecimentos)==null?void 0:re.usuarios)==null?void 0:te.nome:Array.isArray(N.artistas)?(B=(ae=N.artistas[0])==null?void 0:ae.usuarios)==null?void 0:B.nome:(v=(V=N.artistas)==null?void 0:V.usuarios)==null?void 0:v.nome,J=be(N.data_evento,N.status);return e.jsxs("tr",{className:"hover:bg-gray-700/30 transition-colors",children:[e.jsxs("td",{className:"py-4",children:[e.jsx("div",{className:"font-bold",children:new Date(N.data_evento).toLocaleDateString("pt-BR")}),e.jsxs("div",{className:"text-[10px] text-gray-500",children:["ID: ",N.id.substring(0,8)]})]}),e.jsx("td",{className:"py-4 text-gray-300",children:O}),e.jsx("td",{className:"py-4",children:N.status==="cancelado"?e.jsx("span",{className:"text-red-400 text-xs font-bold px-2 py-1 rounded bg-red-400/10",children:"Estorno"}):N.status==="concluido"?J?e.jsx("span",{className:"text-green-400 text-xs font-bold px-2 py-1 rounded bg-green-400/10",children:"Liberado"}):e.jsx("span",{className:"text-blue-300 text-xs font-bold px-2 py-1 rounded bg-blue-300/10",children:"Em Custódia"}):e.jsx("span",{className:"text-yellow-500 text-xs font-bold px-2 py-1 rounded bg-yellow-500/10",children:"Pendente"})}),e.jsxs("td",{className:`py-4 text-right font-mono font-bold ${j?"text-green-400":"text-white"}`,children:[j?"+":"-"," R$ ",F(N).toLocaleString("pt-BR",{minimumFractionDigits:2})]})]},N.id)})})]}):n.length===0?e.jsx("div",{className:"py-20 text-center text-gray-600 italic",children:"Você ainda não solicitou nenhum saque."}):e.jsx("div",{className:"space-y-3",children:n.map(N=>e.jsxs("div",{className:"bg-gray-900/50 p-4 rounded-xl border border-gray-700 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${N.status==="pago"?"bg-green-500":N.status==="pendente"?"bg-yellow-500":"bg-blue-500"}`}),e.jsxs("p",{className:"text-sm font-bold text-white capitalize",children:["Saque ",N.status]})]}),e.jsxs("p",{className:"text-[10px] text-gray-500",children:["Solicitado em ",new Date(N.criado_em).toLocaleString("pt-BR")]}),e.jsxs("p",{className:"text-[10px] text-gray-400 mt-1",children:["PIX (",N.tipo_chave,"): ",N.chave_pix]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-lg font-black text-white font-mono",children:["R$ ",N.valor.toLocaleString("pt-BR",{minimumFractionDigits:2})]}),N.data_pagamento&&e.jsxs("p",{className:"text-[9px] text-green-400 font-bold uppercase tracking-widest mt-1",children:["Pago em ",new Date(N.data_pagamento).toLocaleDateString()]})]})]},N.id))})}),e.jsx("div",{className:"mt-6 pt-6 border-t border-gray-700 text-[10px] text-gray-500 text-center",children:"* Pagamentos em custódia são liberados 24h após o evento. Saques podem levar até 48h úteis para processamento."})]}),S&&e.jsx("div",{className:"fixed inset-0 bg-black/95 z-[60] flex justify-center items-center p-4 backdrop-blur-md",children:e.jsx("div",{className:"bg-gray-900 text-white rounded-2xl p-8 max-w-md w-full border border-gray-800 shadow-[0_0_50px_rgba(34,197,94,0.1)] text-center animate-fade-in",children:w==="confirm"?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-20 h-20 bg-green-500/10 rounded-full flex items-center justify-center mx-auto mb-6 border border-green-500/20",children:e.jsx(De,{className:"w-10 h-10 text-green-400"})}),e.jsx("h3",{className:"text-2xl font-black mb-2",children:"Confirmar Saque"}),e.jsx("p",{className:"text-gray-400 text-sm mb-6",children:"Confirme os dados para transferência via PIX."}),e.jsxs("div",{className:"bg-gray-850 p-6 rounded-2xl border border-gray-800 mb-8 text-left",children:[e.jsxs("div",{className:"flex justify-between mb-4",children:[e.jsx("span",{className:"text-gray-500 text-xs font-bold uppercase",children:"Valor Total"}),e.jsxs("span",{className:"text-green-400 font-black font-mono",children:["R$ ",g.toLocaleString("pt-BR",{minimumFractionDigits:2})]})]}),e.jsxs("div",{className:"pt-4 border-t border-gray-800",children:[e.jsx("span",{className:"text-gray-500 text-[10px] font-black uppercase block mb-1",children:"Destino PIX"}),e.jsx("p",{className:"text-sm font-bold text-white truncate",children:(H=(z=t.artista)==null?void 0:z.dados_bancarios)==null?void 0:H.chave_pix}),e.jsxs("p",{className:"text-[10px] text-gray-500 uppercase mt-1",children:["Tipo: ",(ee=(U=t.artista)==null?void 0:U.dados_bancarios)==null?void 0:ee.tipo_chave]})]})]}),M&&e.jsx("p",{className:"mb-4 text-xs text-red-400 bg-red-400/10 p-2 rounded",children:M}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("button",{onClick:()=>b(!1),className:"py-4 bg-gray-800 hover:bg-gray-700 text-white font-bold rounded-xl transition-all",children:"Cancelar"}),e.jsx("button",{onClick:I,className:"py-4 bg-green-500 hover:bg-white text-dark font-black rounded-xl transition-all shadow-lg shadow-green-900/20",children:"Confirmar"})]})]}):w==="processing"?e.jsxs("div",{className:"py-10",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-green-500 mx-auto mb-6"}),e.jsx("h3",{className:"text-xl font-bold",children:"Processando seu pedido..."}),e.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"Comunicando com o sistema financeiro."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-20 h-20 bg-green-500/10 rounded-full flex items-center justify-center mx-auto mb-6 border border-green-500/20",children:e.jsx(ne,{className:"w-10 h-10 text-green-400"})}),e.jsx("h3",{className:"text-2xl font-black mb-2",children:"Pedido Enviado!"}),e.jsx("p",{className:"text-gray-400 text-sm mb-8 leading-relaxed",children:"Sua solicitação de saque foi registrada com sucesso. O prazo para depósito é de até **48 horas úteis**."}),e.jsx("button",{onClick:()=>{b(!1),D("confirm")},className:"w-full py-4 bg-white text-dark font-black rounded-xl hover:bg-primary transition-all",children:"Entendido"})]})})})]})},Oa=({className:s})=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:s,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 5l7 7-7 7"})}),zt=({profile:s,setActiveTab:r})=>{const[t,a]=c.useState({pastShows:0,upcomingShows:0,realizedValue:0,escrowValue:0,disputeValue:0,averageRating:s.nota_media||0,reviewCount:0}),[i,n]=c.useState(null),[o,l]=c.useState([]),{notifications:d}=Lt(),[x,f]=c.useState(!0),[m,u]=c.useState(null),[S,b]=c.useState(!1),w=s.tipo==="artista",D=s.plano==="pro"||s.plano==="business",M=async()=>{var E,z;f(!0),u(null);try{const H=w?(E=s.artista)==null?void 0:E.id:(z=s.estabelecimento)==null?void 0:z.id;if(!H)return;const ee=await ut.listByProfile(H,s.tipo)||[],N=new Date().toISOString().split("T")[0],O=new Date(`${N}T00:00:00.000Z`).getTime(),J=ee.filter(v=>v.status==="concluido"&&ea(v.data_evento)),X=ee.filter(v=>{const T=v.status==="assinado"||v.status==="concluido",G=new Date(v.data_evento).getTime();return T&&G>=O}),L=v=>{const T=Nt(v.valor,v.taxa_servico);return w?T.cache:T.total},re=ee.filter(v=>be(v.data_evento,v.status)),te=ee.filter(v=>v.status==="concluido"&&!be(v.data_evento,v.status)),ae=ee.filter(v=>ta(v));a({pastShows:J.length,upcomingShows:X.length,realizedValue:re.reduce((v,T)=>v+L(T),0),escrowValue:te.reduce((v,T)=>v+L(T),0),disputeValue:ae.reduce((v,T)=>v+L(T),0),averageRating:s.nota_media||0,reviewCount:0}),await Bt.checkAndUnlock(s.id,"shows",J.length);const B=X.sort((v,T)=>new Date(v.data_evento).getTime()-new Date(T.data_evento).getTime());n(B[0]||null);const V=ee.filter(v=>!!(v.status==="enviado"&&(w&&!v.assinatura_artista||!w&&!v.assinatura_estabelecimento)||v.status==="assinado"&&!w&&!v.data_pagamento));l(V)}catch(H){const U=q(H);console.error("Dashboard overview error:",U),u(U)}finally{f(!1)}};c.useEffect(()=>{M()},[s]);const y=(()=>{if(!s.plano_expiracao)return null;const E=new Date(s.plano_expiracao),z=new Date,H=E.getTime()-z.getTime();return Math.max(0,Math.ceil(H/(1e3*60*60*24)))})(),j=E=>{if(!E)return"Desconhecido";const z=Array.isArray(E)?E[0]:E;if(!z)return"Desconhecido";const H=Array.isArray(z.usuarios)?z.usuarios[0]:z.usuarios,U=(H==null?void 0:H.nome)||z.nome;return typeof U=="string"&&U!=="[object Object]"?U:"Usuário"},R=E=>{if(!E)return"Brasil";const z=Array.isArray(E)?E[0]:E;if(!z)return"Brasil";const H=Array.isArray(z.usuarios)?z.usuarios[0]:z.usuarios,U=(H==null?void 0:H.cidade)||z.cidade;return typeof U=="string"&&U!=="[object Object]"?U:"Brasil"},P=(E,z="-")=>typeof E=="string"&&E!=="[object Object]"?E.charAt(0).toUpperCase()+E.slice(1):typeof E=="number"?String(E):z;if(x)return e.jsx("div",{className:"text-white text-center p-12 animate-pulse",children:"Consolidando visão geral..."});if(m)return e.jsxs(ie,{className:"border-error/20 bg-error/10 p-8 text-center",children:[e.jsx(Ce,{className:"mx-auto mb-4 h-12 w-12 text-error"}),e.jsx($,{variant:"h3",className:"mb-2 text-white",children:"Ops! Houve um problema"}),e.jsx($,{variant:"body",className:"mb-6",children:m}),e.jsx(de,{onClick:M,variant:"primary",children:"Tentar Novamente"})]});const F=t.realizedValue+t.escrowValue+t.disputeValue,_=100,p=Math.round(t.averageRating*50),g=t.pastShows*_+p,h=Math.floor(g/500)+1,C=h*500,k=(h-1)*500,I=C-k,Y=I>0?(g-k)/I*100:0,W=Y>80;return e.jsxs("div",{className:"space-y-8 animate-fade-in w-full",children:[D&&y!==null&&y<=3&&e.jsxs("div",{className:"flex animate-pulse flex-col items-center justify-between gap-4 rounded-xl border border-red-500 bg-gradient-to-r from-red-600 to-red-800 p-4 shadow-lg md:flex-row",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"rounded-full bg-white/20 p-2",children:e.jsx(Ce,{className:"h-6 w-6 text-white"})}),e.jsxs("div",{children:[e.jsx($,{variant:"label",className:"text-white",children:"Sua Assinatura está expirando!"}),e.jsxs($,{variant:"body",className:"text-xs text-red-100",children:["Resta(m) apenas **",y," dia(s)**. Renove agora para manter seus benefícios e selo verificado."]})]})]}),e.jsx(de,{as:oe,to:"/planos",variant:"white",size:"sm",children:"Renovar Agora"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs(ie,{glass:!0,padding:"none",className:"relative flex items-center gap-8 overflow-hidden p-8 lg:col-span-2",children:[e.jsxs("div",{className:"relative z-10 flex-grow",children:[e.jsxs("div",{className:"mb-3 flex items-center gap-3",children:[e.jsxs("span",{className:"rounded-full bg-primary px-3 py-1 text-[10px] font-bold font-heading uppercase tracking-widest text-dark shadow-lg shadow-primary/20",children:["LEVEL ",h]}),e.jsx($,{variant:"label",className:"text-gray-400",children:"Prestígio na Plataforma"})]}),e.jsxs($,{variant:"h2",className:"mb-6 text-white",children:["RESONA ",P(s.plano)]}),e.jsxs("div",{className:"max-w-sm",children:[e.jsxs("div",{className:"mb-2 flex justify-between text-[10px] font-bold font-heading uppercase tracking-widest text-gray-500",children:[e.jsxs("span",{className:`flex items-center gap-2 ${W?"animate-pulse text-primary":""}`,children:[e.jsx(ce,{className:"h-4 w-4"})," Progresso de Nível"]}),e.jsxs("span",{className:"font-mono",children:[g," / ",C," XP"]})]}),e.jsx("div",{className:"relative h-2.5 w-full overflow-hidden rounded-full border border-white/5 bg-black/40 p-[1px]",children:e.jsx("div",{className:`h-full rounded-full bg-gradient-to-r from-primary via-blue-400 to-secondary transition-all duration-1000 ${W?"animate-pulse shadow-[0_0_20px_rgba(81,210,238,0.8)]":"shadow-[0_0_15px_rgba(81,210,238,0.3)]"}`,style:{width:`${Y}%`}})}),W&&e.jsx($,{variant:"label",className:"mt-2 animate-bounce-slow text-right text-[9px] text-primary",children:"Quase lá! Realize mais um show."})]}),e.jsxs("div",{className:"mt-8 flex gap-4",children:[e.jsx(de,{as:oe,to:"/planos",variant:"primary",size:"lg",children:"Planos"}),e.jsx(de,{onClick:()=>b(!0),variant:"ghost",className:"border border-white/10",children:"Extrato"})]})]}),e.jsx("div",{className:"hidden relative md:block",children:e.jsx("div",{className:`flex h-32 w-32 items-center justify-center rounded-full border-2 transition-all duration-700 bg-white/5 backdrop-blur-md ${W?"border-primary shadow-[0_0_40px_rgba(81,210,238,0.4)] scale-110":"border-white/10 shadow-[0_0_20px_rgba(81,210,238,0.1)]"}`,children:e.jsx("span",{className:"text-5xl font-black text-primary drop-shadow-[0_0_10px_rgba(81,210,238,0.5)]",children:h})})}),e.jsx("div",{className:"pointer-events-none absolute -right-10 -top-10 h-60 w-60 rounded-full bg-primary/5 blur-[100px] transition-colors duration-1000 group-hover:bg-primary/10"})]}),e.jsxs(ie,{glass:!0,className:"flex flex-col justify-center text-center group",children:[e.jsx("div",{className:"pointer-events-none absolute left-1/2 top-0 h-40 w-40 -translate-x-1/2 rounded-full bg-yellow-500/5 blur-[60px]"}),e.jsx($,{variant:"label",className:"relative z-10 mb-4 text-gray-500",children:"Reputação Média"}),e.jsxs("div",{className:"relative z-10 mb-2 flex items-center justify-center gap-3",children:[e.jsx(le,{className:"h-10 w-10 text-yellow-500 drop-shadow-[0_0_15px_rgba(234,179,8,0.4)]"}),e.jsx("span",{className:"font-heading text-5xl font-bold tracking-tight text-white",children:t.averageRating.toFixed(1)})]}),e.jsx("div",{className:"relative z-10 mb-6 flex justify-center text-yellow-500/20",children:[...Array(5)].map((E,z)=>e.jsx(le,{className:`h-5 w-5 transition-all duration-500 ${z<Math.round(t.averageRating)?"text-yellow-500 drop-shadow-[0_0_5px_rgba(234,179,8,0.3)]":""}`},z))}),e.jsx($,{variant:"label",className:"relative z-10 self-center rounded-full border border-white/5 bg-white/5 px-4 py-2 text-gray-500",children:"Ponto forte: Profissionalismo"})]})]}),e.jsxs("div",{className:"grid w-full grid-cols-1 gap-6 md:grid-cols-4",children:[e.jsx(ie,{hoverable:!0,onClick:()=>r("contratos"),className:"cursor-pointer group",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx($,{variant:"label",className:"mb-3 text-primary",children:"Agenda"}),e.jsx($,{variant:"h3",className:"font-mono tracking-tighter text-white",children:t.upcomingShows}),e.jsx($,{variant:"label",className:"mt-2 text-gray-500",children:"Confirmados"})]}),e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-xl border border-primary/20 bg-primary/10 transition-all duration-500 group-hover:bg-primary",children:e.jsx(Se,{className:"h-6 w-6 text-primary transition-colors group-hover:text-dark"})})]})}),e.jsx(ie,{hoverable:!0,onClick:()=>b(!0),className:"cursor-pointer group",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx($,{variant:"label",className:"mb-3 text-green-400",children:w?"Ganhos":"Custos"}),e.jsxs("div",{className:"flex items-baseline gap-1",children:[e.jsx("span",{className:"text-lg font-sans text-gray-500",children:"R$"}),e.jsx($,{variant:"h3",className:"font-mono tracking-tighter text-white",children:F.toLocaleString("pt-BR",{notation:"compact"})})]}),e.jsx($,{variant:"label",className:"mt-2 text-gray-500",children:"Extrato Total"})]}),e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-xl border border-green-500/20 bg-green-500/10 transition-all duration-500 group-hover:bg-green-500",children:e.jsx(De,{className:"h-6 w-6 text-green-400 transition-colors group-hover:text-dark"})})]})}),e.jsx(ie,{className:"opacity-80 group",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx($,{variant:"label",className:"mb-3 text-gray-400",children:"Histórico"}),e.jsx($,{variant:"h3",className:"font-mono tracking-tighter text-white",children:t.pastShows}),e.jsx($,{variant:"label",className:"mt-2 text-gray-500",children:"Concluídos"})]}),e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-xl border border-white/10 bg-white/5",children:e.jsx(ne,{className:"h-6 w-6 text-gray-500"})})]})}),e.jsx(ie,{hoverable:!0,onClick:()=>r("avaliacoes"),className:"cursor-pointer group",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx($,{variant:"label",className:"mb-3 text-yellow-500",children:"XP Total"}),e.jsx($,{variant:"h3",className:"font-mono tracking-tighter text-white",children:g}),e.jsx($,{variant:"label",className:"mt-2 text-gray-500",children:"Carreira"})]}),e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-xl border border-yellow-500/20 bg-yellow-500/10 transition-all duration-500 group-hover:bg-yellow-500",children:e.jsx(le,{className:"h-6 w-6 text-yellow-500 transition-colors group-hover:text-dark"})})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 flex flex-col gap-8",children:[e.jsx(Ye,{profile:s,onUpdate:M}),i?e.jsxs(ie,{hoverable:!0,className:"group/event relative flex flex-col items-center gap-8 overflow-hidden p-8 md:flex-row",children:[e.jsx("div",{className:"pointer-events-none absolute right-0 top-0 h-32 w-32 rounded-full bg-primary/10 blur-[60px] transition-colors group-hover/event:bg-primary/20"}),e.jsxs("div",{className:"relative z-10 flex h-28 w-28 shrink-0 flex-col items-center justify-center rounded-[2rem] border border-primary/20 bg-primary/10 shadow-xl transition-transform duration-500 group-hover/event:scale-105",children:[e.jsx($,{variant:"label",className:"text-primary",children:new Date(i.data_evento).toLocaleString("pt-BR",{month:"short",timeZone:"UTC"})}),e.jsx($,{variant:"h2",className:"text-white",children:new Date(i.data_evento).getUTCDate()})]}),e.jsxs("div",{className:"relative z-10 flex-1 min-w-0 text-center md:text-left",children:[e.jsxs("div",{className:"mb-2 flex items-center justify-center gap-2 md:justify-start",children:[e.jsx("span",{className:"h-2 w-2 animate-pulse rounded-full bg-primary"}),e.jsx($,{variant:"label",className:"text-gray-500",children:"Show Confirmado"})]}),e.jsx($,{variant:"h3",className:"truncate text-white",children:j(w?i.estabelecimentos:i.artistas)}),e.jsxs($,{variant:"body",className:"mt-2 flex items-center justify-center gap-2 font-bold uppercase tracking-wide text-sm md:justify-start",children:[e.jsx($e,{className:"h-4 w-4 text-primary"})," ",w?R(i.estabelecimentos):"Local agendado"]})]}),e.jsx(de,{as:oe,to:`/contratos/${i.id}`,variant:"white",className:"relative z-10 shadow-xl",children:"Ver Detalhes"})]}):e.jsxs(ie,{className:"relative flex flex-col items-center overflow-hidden p-12 text-center",children:[e.jsx("div",{className:"pointer-events-none absolute inset-0 bg-gradient-to-b from-white/5 to-transparent"}),e.jsx("div",{className:"mb-6 flex h-20 w-20 items-center justify-center rounded-full border border-white/10 bg-white/5",children:e.jsx(Se,{className:"h-10 w-10 text-gray-500"})}),e.jsx($,{variant:"h3",className:"text-white",children:"Nenhum palco à vista?"}),e.jsx($,{variant:"body",className:"mt-3 max-w-sm",children:"Sua agenda de eventos confirmados está livre. Que tal buscar novas oportunidades agora?"}),e.jsxs(de,{as:oe,to:w?"/estabelecimentos":"/artistas",variant:"ghost",className:"mt-8 border border-primary/20 bg-primary/10 text-primary hover:bg-primary hover:text-dark",children:["Descobrir ",w?"Locais":"Artistas"," ",e.jsx(ze,{className:"ml-1 h-4 w-4"})]})]}),e.jsxs(ie,{padding:"none",className:"overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-white/5 bg-white/5 px-8 py-6",children:[e.jsxs($,{variant:"label",className:"flex items-center gap-3 text-white",children:[e.jsx("div",{className:"rounded-lg border border-yellow-500/20 bg-yellow-500/10 p-2",children:e.jsx(Qe,{className:"h-5 w-5 text-yellow-500"})}),"Pendências Críticas"]}),o.length>0&&e.jsx("span",{className:"animate-pulse rounded-full bg-red-500 px-3 py-1 text-[10px] font-black text-white",children:"AÇÃO NECESSÁRIA"})]}),e.jsx("div",{className:"divide-y divide-white/5",children:o.length>0?o.map(E=>e.jsxs("div",{className:"group/item flex items-center justify-between gap-6 p-6 transition-colors hover:bg-white/5",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx($,{variant:"h4",className:"truncate text-white transition-colors group-hover/item:text-primary",children:j(w?E.estabelecimentos:E.artistas)}),e.jsxs("div",{className:"mt-1 flex items-center gap-2",children:[e.jsx(Ce,{className:"h-3.5 w-3.5 text-yellow-500"}),e.jsx($,{variant:"label",className:"text-yellow-500",children:E.status==="enviado"?"Aguardando Assinatura":"Aguardando Pagamento"})]})]}),e.jsx(de,{as:oe,to:`/contratos/${E.id}`,variant:"secondary",size:"sm",className:"bg-yellow-500 text-dark hover:bg-white",children:"Resolver Agora"})]},E.id)):e.jsxs("div",{className:"flex flex-col items-center p-16 text-center text-gray-600",children:[e.jsx(ne,{className:"mb-4 h-12 w-12 opacity-20"}),e.jsx($,{variant:"label",className:"text-gray-500",children:"Tudo em dia!"}),e.jsx($,{variant:"body",className:"mt-1 text-xs",children:"Nenhuma pendência contratual encontrada."})]})})]})]}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs(ie,{padding:"none",className:"flex h-full flex-col overflow-hidden",children:[e.jsxs("div",{className:"flex items-center gap-3 border-b border-white/5 bg-white/5 px-8 py-6",children:[e.jsx("div",{className:"rounded-lg border border-primary/20 bg-primary/10 p-2",children:e.jsx(xe,{className:"h-5 w-5 text-primary"})}),e.jsx($,{variant:"label",className:"text-white",children:"Log de Atividade"})]}),e.jsx("div",{className:"custom-scrollbar flex-grow overflow-y-auto p-6 space-y-6",children:d.length>0?d.slice(0,10).map(E=>e.jsxs("div",{className:"group/notif border-b border-white/5 pb-6 last:border-0 hover:bg-white/5 p-4 rounded-2xl transition-all duration-300 flex gap-4",children:[e.jsx("div",{className:"mt-1 shrink-0",children:e.jsx("div",{className:`p-2 rounded-lg ${E.tipo==="mensagem"?"bg-green-500/10 text-green-400":"bg-primary/10 text-primary"}`,children:E.tipo==="mensagem"?e.jsx(xe,{className:"h-4 w-4"}):e.jsx(Qe,{className:"h-4 w-4"})})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx($,{variant:"h4",className:"text-sm text-white transition-colors group-hover/notif:text-primary",children:P(E.titulo,"Notificação")}),e.jsx($,{variant:"body",className:"mt-1.5 line-clamp-2 text-[11px]",children:P(E.descricao,"Sem detalhes adicionais.")}),e.jsx($,{variant:"label",className:"mt-2 text-[9px] text-gray-600",children:"Agora mesmo"})]})]},E.id)):e.jsxs("div",{className:"flex flex-col items-center justify-center py-24 text-gray-700",children:[e.jsx(ye,{className:"mb-4 h-16 w-16 opacity-10"}),e.jsx($,{variant:"label",className:"text-gray-500",children:"Silêncio no Palco"}),e.jsx($,{variant:"body",className:"mt-1 px-10 text-center text-xs italic opacity-60",children:"Nenhuma atividade recente para exibir."})]})}),e.jsx("div",{className:"bg-black/20 p-6 border-t border-white/5",children:e.jsx(de,{variant:"ghost",className:"w-full text-[10px] text-gray-500 hover:text-white",children:"Limpar Histórico"})})]})})]}),e.jsx(Ba,{isOpen:S,onClose:()=>b(!1),profile:s})]})},It=({profile:s})=>{const[r,t]=c.useState([]),[a,i]=c.useState(!0),[n,o]=c.useState(null),l=s.plano!=="free";c.useEffect(()=>{(async()=>{i(!0);try{const u=await Q.getSubscriptionHistory(s.id);t(u)}catch(u){o(q(u))}finally{i(!1)}})()},[s.id]);const x=(()=>{if(!s.plano_expiracao)return null;const m=new Date(s.plano_expiracao),u=new Date,S=m.getTime()-u.getTime();return Math.max(0,Math.ceil(S/(1e3*60*60*24)))})(),f=x!==null?Math.max(0,Math.min(100,x/30*100)):0;return e.jsxs("div",{className:"space-y-8 animate-fade-in",children:[e.jsx("h2",{className:"text-2xl font-bold font-poppins text-white",children:"Gerenciar Assinatura"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-1 bg-gray-900 rounded-2xl border border-gray-700 overflow-hidden shadow-xl",children:[e.jsxs("div",{className:"p-6 bg-gradient-to-br from-gray-800 to-gray-900 border-b border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:s.plano==="pro"?e.jsx(ce,{className:"text-primary w-6 h-6"}):s.plano==="business"?e.jsx(aa,{className:"text-yellow-500 w-6 h-6"}):e.jsx(le,{className:"text-gray-500 w-6 h-6"})}),e.jsx("span",{className:"text-gray-400 text-xs font-black uppercase tracking-widest",children:"Plano Ativo"})]}),e.jsxs("h3",{className:"text-3xl font-black text-white uppercase font-poppins",children:["RESONA ",s.plano]})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[l&&x!==null?e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-2",children:[e.jsx("span",{className:"text-gray-400",children:"Tempo Restante"}),e.jsxs("span",{className:"text-white font-bold",children:[x," dias"]})]}),e.jsx("div",{className:"h-2 bg-gray-800 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full transition-all duration-1000 ${x<=5?"bg-red-500":"bg-primary"}`,style:{width:`${f}%`}})}),e.jsxs("p",{className:"text-[10px] text-gray-500 mt-2 uppercase font-bold tracking-tighter",children:["Expira em: ",new Date(s.plano_expiracao).toLocaleDateString("pt-BR")]})]}):e.jsx("div",{className:"bg-gray-800/50 p-4 rounded-xl border border-gray-700",children:e.jsx("p",{className:"text-sm text-gray-400 leading-relaxed italic",children:"Você está no plano gratuito. Faça o upgrade para desbloquear busca prioritária e selo de verificação."})}),e.jsx("div",{className:"pt-4 border-t border-gray-800",children:e.jsx(oe,{to:"/planos",className:"w-full bg-primary text-dark font-black py-3 rounded-xl flex items-center justify-center gap-2 hover:bg-white transition-all shadow-lg shadow-primary/10",children:l?"Renovar / Mudar Plano":"Ver Planos Premium"})})]})]}),e.jsxs("div",{className:"lg:col-span-2 bg-gray-800 rounded-2xl border border-gray-700 shadow-xl overflow-hidden flex flex-col",children:[e.jsx("div",{className:"p-4 border-b border-gray-700 bg-gray-900/30 flex justify-between items-center",children:e.jsxs("h3",{className:"font-bold text-white flex items-center gap-2",children:[e.jsx(ye,{className:"w-5 h-5 text-primary"})," Histórico de Cobrança"]})}),e.jsx("div",{className:"flex-grow overflow-y-auto custom-scrollbar min-h-[300px]",children:a?e.jsx("div",{className:"p-12 text-center text-gray-500 animate-pulse",children:"Carregando histórico..."}):r.length===0?e.jsx("div",{className:"p-12 text-center text-gray-500",children:"Nenhum pagamento registrado."}):e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{className:"bg-gray-900/50 text-[10px] text-gray-500 uppercase font-black sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-4",children:"Data"}),e.jsx("th",{className:"p-4",children:"Plano"}),e.jsx("th",{className:"p-4",children:"Valor"}),e.jsx("th",{className:"p-4",children:"Método"}),e.jsx("th",{className:"p-4 text-center",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-700 text-sm",children:r.map(m=>{var u;return e.jsxs("tr",{className:"hover:bg-gray-700/30 transition-colors",children:[e.jsx("td",{className:"p-4 text-gray-400 font-mono text-xs",children:new Date(m.data_mudanca).toLocaleDateString("pt-BR")}),e.jsx("td",{className:"p-4 font-bold text-white uppercase",children:m.plano_novo}),e.jsxs("td",{className:"p-4 text-gray-300",children:["R$ ",(u=m.valor_pago)==null?void 0:u.toLocaleString("pt-BR",{minimumFractionDigits:2})]}),e.jsx("td",{className:"p-4 text-gray-500 text-xs",children:m.metodo_pagamento==="stripe_simulated"?"Cartão (Stripe)":m.metodo_pagamento==="system_expiry"?"Sistema (Downgrade)":m.metodo_pagamento}),e.jsx("td",{className:"p-4 text-center",children:e.jsx("div",{className:"flex justify-center",children:e.jsx(ne,{className:"w-5 h-5 text-green-500/50"})})})]},m.id)})})]})}),e.jsx("div",{className:"p-4 bg-gray-900/30 border-t border-gray-700 text-center",children:e.jsx("p",{className:"text-[10px] text-gray-600 uppercase font-bold tracking-widest",children:"Cobranças processadas pelo Stripe • Todos os dados são protegidos"})})]})]})]})},qa=["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],Ua=({profile:s})=>{var _;const[r,t]=c.useState(new Date),[a,i]=c.useState([]),[n,o]=c.useState(!0),[l,d]=c.useState(""),[x,f]=c.useState(!1),[m,u]=c.useState({date:"",title:"",type:"bloqueio_manual"}),[S,b]=c.useState(!1),w=(_=s.artista)==null?void 0:_.id,D=async()=>{if(w){o(!0);try{const p=await Be.getConsolidatedAgenda(w,s.id,"","");i(p)}catch(p){d(q(p))}finally{o(!1)}}};c.useEffect(()=>{D()},[w]);const M=(p,g)=>new Date(p,g+1,0).getDate(),A=(p,g)=>new Date(p,g,1).getDay(),y=()=>e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-6 mb-10 glass-card p-8 rounded-[2rem] border-white/5",children:[e.jsxs("div",{className:"flex items-center gap-5",children:[e.jsx("div",{className:"p-3 bg-primary/10 rounded-2xl border border-primary/20 shadow-lg shadow-primary/10",children:e.jsx(Se,{className:"text-primary w-8 h-8"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-black text-white font-poppins tracking-tighter leading-none",children:qa[r.getMonth()]}),e.jsx("p",{className:"text-xs font-black text-gray-500 uppercase tracking-[0.3em] mt-1",children:r.getFullYear()})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>t(new Date(r.getFullYear(),r.getMonth()-1,1)),className:"p-3 hover:bg-white/10 rounded-xl text-gray-400 transition-colors border border-transparent hover:border-white/10",children:e.jsx(Ht,{})}),e.jsx("button",{onClick:()=>t(new Date),className:"px-6 py-2.5 text-[10px] font-black uppercase tracking-widest bg-white/5 text-white rounded-full border border-white/10 hover:bg-white hover:text-dark transition-all",children:"Hoje"}),e.jsx("button",{onClick:()=>t(new Date(r.getFullYear(),r.getMonth()+1,1)),className:"p-3 hover:bg-white/10 rounded-xl text-gray-400 transition-colors border border-transparent hover:border-white/10",children:e.jsx(ze,{})})]})]}),j=p=>{u({...m,date:p}),f(!0)},R=async p=>{if(p.preventDefault(),!(!w||!m.date||!m.title)){b(!0);try{await Be.createBlock({artista_id:w,data_inicio:m.date,titulo:m.title,tipo:m.type}),f(!1),u({date:"",title:"",type:"bloqueio_manual"}),D()}catch(g){alert(q(g))}finally{b(!1)}}},P=async p=>{if(window.confirm("Excluir este compromisso?"))try{await Be.deleteBlock(p),D()}catch(g){alert(q(g))}},F=()=>{const p=r.getFullYear(),g=r.getMonth(),h=[],C=M(p,g),k=A(p,g);for(let I=0;I<k;I++)h.push(e.jsx("div",{className:"h-32 bg-white/[0.02] border border-white/[0.02] rounded-2xl"},`empty-${I}`));for(let I=1;I<=C;I++){const Y=`${p}-${String(g+1).padStart(2,"0")}-${String(I).padStart(2,"0")}`,W=a.filter(z=>z.date===Y),E=new Date().toISOString().split("T")[0]===Y;h.push(e.jsxs("div",{onClick:()=>j(Y),className:`h-36 p-3 border rounded-2xl transition-all duration-300 hover:scale-[1.02] hover:z-10 cursor-pointer flex flex-col group overflow-hidden relative shadow-lg ${E?"border-primary/50 bg-primary/5 shadow-[0_0_20px_rgba(81,210,238,0.1)] ring-1 ring-primary/20":"border-white/5 bg-white/[0.03] hover:border-white/20 hover:bg-white/[0.05]"}`,children:[e.jsxs("div",{className:"flex justify-between items-start mb-2 relative z-10",children:[e.jsx("span",{className:`text-xs font-black w-6 h-6 flex items-center justify-center rounded-lg transition-colors ${E?"bg-primary text-dark shadow-lg shadow-primary/20":"text-gray-500 group-hover:text-gray-300"}`,children:I}),e.jsx("div",{className:"p-1.5 bg-white/5 rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(yt,{className:"w-2.5 h-2.5 text-primary"})})]}),e.jsx("div",{className:"flex-grow space-y-1.5 overflow-y-auto scrollbar-hide relative z-10",children:W.map(z=>e.jsxs("div",{onClick:H=>{H.stopPropagation(),z.type==="manual_block"&&P(z.id)},className:`text-[9px] px-2 py-1.5 rounded-lg font-black uppercase tracking-tight truncate border flex items-center justify-between transition-all hover:brightness-125 ${z.type==="contract_confirmed"?"bg-green-500/10 text-green-400 border-green-500/20 shadow-[0_0_10px_rgba(34,197,94,0.1)]":z.type==="contract_pending"?"bg-yellow-500/10 text-yellow-400 border-yellow-500/20 shadow-[0_0_10px_rgba(234,179,8,0.1)]":"bg-white/5 text-gray-400 border-white/10"}`,children:[e.jsx("span",{className:"truncate",children:z.title}),z.type==="manual_block"&&e.jsx(ve,{className:"w-2.5 h-2.5 opacity-40 hover:opacity-100 transition-opacity ml-1"})]},z.id))}),E&&e.jsx("div",{className:"absolute top-0 right-0 w-12 h-12 bg-primary/10 rounded-full blur-2xl pointer-events-none"})]},I))}return h};return e.jsxs("div",{className:"animate-fade-in w-full",children:[y(),e.jsxs("div",{className:"grid grid-cols-7 gap-2 mb-2 text-center text-[10px] font-black text-gray-500 uppercase tracking-widest",children:[e.jsx("div",{children:"Dom"}),e.jsx("div",{children:"Seg"}),e.jsx("div",{children:"Ter"}),e.jsx("div",{children:"Qua"}),e.jsx("div",{children:"Qui"}),e.jsx("div",{children:"Sex"}),e.jsx("div",{children:"Sáb"})]}),e.jsx("div",{className:"grid grid-cols-7 gap-2",children:F()}),e.jsxs("div",{className:"mt-12 flex flex-wrap gap-8 p-8 glass-card rounded-[2rem] border-white/5 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 w-32 h-32 bg-primary/5 rounded-full blur-[60px] pointer-events-none"}),e.jsxs("div",{className:"flex items-center gap-3 text-[10px] font-black uppercase tracking-widest text-gray-500",children:[e.jsx("div",{className:"w-4 h-4 rounded-full bg-green-500/20 border border-green-500/40 shadow-[0_0_10px_rgba(34,197,94,0.2)]"})," Show Confirmado"]}),e.jsxs("div",{className:"flex items-center gap-3 text-[10px] font-black uppercase tracking-widest text-gray-500",children:[e.jsx("div",{className:"w-4 h-4 rounded-full bg-yellow-500/20 border border-yellow-500/40 shadow-[0_0_10px_rgba(234,179,8,0.2)]"})," Show Pendente"]}),e.jsxs("div",{className:"flex items-center gap-3 text-[10px] font-black uppercase tracking-widest text-gray-500",children:[e.jsx("div",{className:"w-4 h-4 rounded-full bg-white/10 border border-white/20"})," Bloqueio Manual"]})]}),x&&e.jsx("div",{className:"fixed inset-0 bg-black/80 z-50 flex justify-center items-center p-4 backdrop-blur-xl animate-fade-in",children:e.jsxs("div",{className:"glass-card text-white rounded-[2rem] p-10 max-w-md w-full border-white/10 shadow-2xl relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-primary/10 rounded-full blur-[60px] pointer-events-none"}),e.jsxs("div",{className:"flex justify-between items-center mb-8 relative z-10",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-black font-poppins tracking-tighter uppercase leading-none",children:"Bloquear Data"}),e.jsx("p",{className:"text-[10px] font-black text-gray-500 uppercase tracking-[0.3em] mt-1",children:"Gerenciamento de Disponibilidade"})]}),e.jsx("button",{onClick:()=>f(!1),className:"p-2 hover:bg-white/10 rounded-full transition-colors",children:e.jsx(ze,{className:"rotate-90"})})]}),e.jsxs("form",{onSubmit:R,className:"space-y-6 relative z-10",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-black text-gray-500 uppercase tracking-widest mb-2",children:"Data Selecionada"}),e.jsx("input",{type:"date",value:m.date,disabled:!0,className:"w-full bg-white/5 border border-white/10 rounded-2xl p-4 text-gray-400 font-mono"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-black text-gray-500 uppercase tracking-widest mb-2",children:"Título do Compromisso"}),e.jsx("input",{type:"text",value:m.title,onChange:p=>u({...m,title:p.target.value}),required:!0,className:"w-full bg-white/5 border border-white/10 rounded-2xl p-4 text-white focus:ring-2 focus:ring-primary/50 outline-none transition-all placeholder:text-gray-600 font-medium",placeholder:"Ex: Ensaio Geral, Viagem..."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] font-black text-gray-500 uppercase tracking-widest mb-2",children:"Categoria"}),e.jsxs("select",{value:m.type,onChange:p=>u({...m,type:p.target.value}),className:"w-full bg-white/5 border border-white/10 rounded-2xl p-4 text-white outline-none focus:ring-2 focus:ring-primary/50 appearance-none font-medium",children:[e.jsx("option",{value:"bloqueio_manual",className:"bg-gray-900",children:"Bloqueio Privado"}),e.jsx("option",{value:"ensaio",className:"bg-gray-900",children:"Ensaio"}),e.jsx("option",{value:"viagem",className:"bg-gray-900",children:"Viagem"}),e.jsx("option",{value:"show_externo",className:"bg-gray-900",children:"Show Fora da Plataforma"})]})]}),e.jsxs("div",{className:"flex gap-4 pt-6",children:[e.jsx("button",{type:"button",onClick:()=>f(!1),className:"flex-1 py-4 bg-white/5 hover:bg-white/10 rounded-2xl font-black uppercase tracking-widest text-[10px] transition-all border border-white/5",children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:S,className:"flex-1 py-4 bg-primary text-dark font-black rounded-2xl hover:bg-white transition-all shadow-xl shadow-primary/20 uppercase tracking-widest text-[10px] active:scale-95",children:S?"Gravando...":"Confirmar"})]})]})]})})]})},ht=[{id:"overview",label:"Visão Geral",icon:e.jsx(bt,{className:"w-5 h-5"})},{id:"agenda",label:"Agenda",icon:e.jsx(Se,{className:"w-5 h-5"})},{id:"contratos",label:"Contratos",icon:e.jsx(ft,{className:"w-5 h-5"})},{id:"mensagens",label:"Mensagens",icon:e.jsx(xe,{className:"w-5 h-5"})},{id:"perfil",label:"Meu Perfil",icon:e.jsx(pe,{className:"w-5 h-5"})},{id:"performance",label:"Performance",icon:e.jsx(_e,{className:"w-5 h-5"})},{id:"assinatura",label:"Assinatura",icon:e.jsx(De,{className:"w-5 h-5"})}],Va=({user:s,initialProfile:r,onProfileUpdate:t,openTab:a})=>{const[i,n]=c.useState("overview"),o=Xe(),l=gt();c.useEffect(()=>{a&&(["portfolio","banda"].includes(a)?n("perfil"):["analytics","avaliacoes"].includes(a)?n("performance"):ht.some(f=>f.id===a)&&n(a),o(l.pathname,{replace:!0}))},[a,o,l.pathname]);const d=()=>{switch(i){case"overview":return e.jsx(zt,{profile:r,setActiveTab:n});case"agenda":return e.jsx(Ua,{profile:r});case"contratos":return e.jsx(wt,{profile:r});case"mensagens":return e.jsx(Mt,{currentUser:r});case"perfil":return e.jsx(Ia,{profile:r,onUpdate:t,initialTab:a||void 0});case"performance":return e.jsx(Fa,{profile:r,initialTab:a||void 0});case"assinatura":return e.jsx(It,{profile:r});default:return null}},x=String(r.nome||s.email||"Usuário");return e.jsx(Ct,{title:"Painel do Artista",subtitle:e.jsxs(e.Fragment,{children:["Bem-vindo(a) de volta, ",e.jsx("span",{className:"text-primary font-semibold",children:x}),"!"]}),tabs:ht,activeTab:i,onTabClick:n,profile:r,children:d()})},Wa=({initialProfile:s,onProfileUpdate:r})=>{const[t,a]=c.useState("idle"),[i,n]=c.useState(""),[o,l]=c.useState(""),[d,x]=c.useState(!1),f=Gt(s),[m,u]=c.useState({nome:"",telefone:"",cidade:"",foto_url:"",foto_capa:"",capacidade:null,descricao:"",endereco:"",midias_sociais:{instagram:"",site:""}});c.useEffect(()=>{if(o){const y=setTimeout(()=>l(""),4e3);return()=>clearTimeout(y)}},[o]),c.useEffect(()=>{var y,j,R,P,F,_,p,g;s&&u({nome:s.nome||"",telefone:s.telefone||"",cidade:s.cidade||"",foto_url:s.foto_url||"",foto_capa:((y=s.estabelecimento)==null?void 0:y.foto_capa)||"",capacidade:((j=s.estabelecimento)==null?void 0:j.capacidade)??null,descricao:((R=s.estabelecimento)==null?void 0:R.descricao)||"",endereco:((P=s.estabelecimento)==null?void 0:P.endereco)||"",midias_sociais:{instagram:((_=(F=s.estabelecimento)==null?void 0:F.midias_sociais)==null?void 0:_.instagram)||"",site:((g=(p=s.estabelecimento)==null?void 0:p.midias_sociais)==null?void 0:g.site)||""}})},[s]);const S=y=>{const{id:j,value:R}=y.target;u(P=>{if(j==="capacidade"){const F=parseInt(R,10);return{...P,capacidade:isNaN(F)?null:F}}return{...P,[j]:R}}),t!=="idle"&&a("idle")},b=y=>{const{name:j,value:R}=y.target;u(P=>({...P,midias_sociais:{...P.midias_sociais,[j]:R}})),t!=="idle"&&a("idle")},w=(y,j)=>{l(""),Q.updateBasicInfo(s.id,{foto_url:y}).then(()=>{l("Foto de perfil atualizada!"),r(),j.onSuccess()}).catch(R=>{console.error("Error updating avatar URL in DB",R),l("Falha ao salvar a foto."),j.onError()})},D=async y=>{n("");try{await Q.updateVenue(s.id,null,{foto_capa:y}),u(j=>({...j,foto_capa:y})),r()}catch(j){const R=q(j);console.error("Error updating cover photo:",R),n("Erro ao salvar foto de capa: "+R),a("error")}},M=async y=>{y.preventDefault(),a("saving"),n("");const j=Aa(m);if(!j.valid){a("error"),n(j.errors.join("; "));return}const R=m.telefone?Ee(m.telefone):"",P=At(m.midias_sociais);try{await Q.updateVenue(s.id,{nome:m.nome.trim(),telefone:R,cidade:m.cidade.trim()},{capacidade:m.capacidade,descricao:m.descricao.trim(),endereco:m.endereco.trim(),midias_sociais:P||{}}),a("success"),r().catch(F=>{console.warn("Erro ao atualizar contexto:",F)}),setTimeout(()=>a("idle"),3e3)}catch(F){a("error");const _=q(F);n(_),console.error(_)}},A=t==="saving"||t==="success";return e.jsxs("form",{onSubmit:M,children:[e.jsx("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6",children:e.jsx("h2",{className:"text-2xl font-bold font-poppins text-white",children:"Editar Perfil"})}),!f.complete&&e.jsxs("div",{className:"mb-8 bg-gray-900 border-l-4 border-yellow-500 p-4 rounded-r-lg shadow-md transition-all",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ce,{className:"w-5 h-5 text-yellow-500 flex-shrink-0"}),e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-gray-300",children:["Seu perfil está incompleto. Preencha os ",e.jsxs("strong",{children:[f.missing.length," itens restantes"]})," para melhorar sua reputação."]})})]}),e.jsx("button",{type:"button",onClick:()=>x(!d),className:"text-xs font-semibold text-primary hover:underline whitespace-nowrap ml-4",children:d?"Ocultar":"Ver Pendências"})]}),d&&e.jsx("div",{className:"mt-3 pl-8 animate-fade-in",children:e.jsx("ul",{className:"list-disc text-xs text-gray-400 space-y-1",children:f.missing.map((y,j)=>e.jsx("li",{children:y},j))})})]}),e.jsx(Et,{currentPath:m.foto_capa,bucketName:"estabelecimento",userId:s.auth_id,onUploadComplete:D}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 items-start mb-8",children:[e.jsxs("div",{className:"lg:col-span-1 flex flex-col items-center",children:[e.jsx(Dt,{url:m.foto_url,onUpload:w}),e.jsx("p",{className:"text-sm text-gray-400 mt-4 text-center",children:"Clique na imagem para carregar uma nova foto de perfil."}),o&&e.jsx("p",{className:"text-sm text-green-400 mt-2 text-center",children:o})]}),e.jsxs("div",{className:"lg:col-span-2 grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"nome",className:"block text-sm font-medium text-gray-300",children:"Nome do Estabelecimento"}),e.jsx("input",{type:"text",id:"nome",value:m.nome,onChange:S,className:"mt-1 input-style"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-300",children:"Email"}),e.jsx("input",{type:"email",id:"email",value:s.email,disabled:!0,className:"mt-1 input-style bg-gray-700 cursor-not-allowed"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"telefone",className:"block text-sm font-medium text-gray-300",children:"Telefone"}),e.jsx("input",{type:"tel",id:"telefone",value:m.telefone,onChange:S,className:"mt-1 input-style"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"cidade",className:"block text-sm font-medium text-gray-300",children:"Cidade"}),e.jsx("input",{type:"text",id:"cidade",value:m.cidade,onChange:S,className:"mt-1 input-style"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx("div",{className:"md:col-span-2",children:e.jsx("hr",{className:"border-gray-700"})}),e.jsx("div",{className:"md:col-span-2",children:e.jsx("h3",{className:"text-xl font-semibold text-white mt-4",children:"Detalhes do Estabelecimento"})}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"capacidade",className:"block text-sm font-medium text-gray-300",children:"Capacidade (pessoas)"}),e.jsx("input",{type:"number",id:"capacidade",value:m.capacidade??"",onChange:S,className:"mt-1 input-style",placeholder:"Ex: 150"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"endereco",className:"block text-sm font-medium text-gray-300",children:"Endereço Completo"}),e.jsx("input",{type:"text",id:"endereco",value:m.endereco,onChange:S,className:"mt-1 input-style",placeholder:"Rua, Número, Bairro"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{htmlFor:"descricao",className:"block text-sm font-medium text-gray-300",children:"Descrição do Local"}),e.jsx("textarea",{id:"descricao",rows:4,value:m.descricao,onChange:S,className:"mt-1 input-style",placeholder:"Descreva seu espaço, o tipo de público, estrutura, etc."})]}),e.jsx("div",{className:"md:col-span-2",children:e.jsx("h3",{className:"text-lg font-semibold text-white mb-4 mt-4",children:"Mídias Sociais"})}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"instagram",className:"block text-sm font-medium text-gray-300",children:"Usuário do Instagram"}),e.jsx("input",{type:"text",name:"instagram",id:"instagram",value:m.midias_sociais.instagram,onChange:b,className:"mt-1 input-style",placeholder:"seu_usuario_no_instagram"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"site",className:"block text-sm font-medium text-gray-300",children:"Site Oficial"}),e.jsx("input",{type:"url",name:"site",id:"site",value:m.midias_sociais.site,onChange:b,className:"mt-1 input-style",placeholder:"https://seu-site.com"})]}),e.jsxs("div",{className:"md:col-span-2 flex justify-end items-center gap-4",children:[t==="error"&&e.jsx("p",{className:"text-sm text-red-400 mr-auto flex-grow",children:i}),e.jsxs("button",{type:"submit",disabled:A,className:`font-bold py-2 px-6 rounded-full transition-all duration-300 transform hover:scale-105 flex items-center justify-center gap-2
                            ${t==="idle"&&"bg-gradient-to-r from-primary to-secondary text-white hover:shadow-lg hover:shadow-secondary/40"}
                            ${t==="saving"&&"bg-gray-600 text-white cursor-not-allowed"}
                            ${t==="success"&&"bg-green-600 text-white cursor-not-allowed"}
                            ${t==="error"&&"bg-red-600 text-white"}
                        `,children:[t==="saving"&&"Salvando...",t==="success"&&e.jsxs(e.Fragment,{children:[e.jsx(me,{className:"w-5 h-5"})," Salvo!"]}),t==="error"&&"Tentar Novamente",t==="idle"&&"Salvar Perfil Completo"]})]})]})]})},Ha=({profile:s,onUpdate:r})=>{var u,S;const[t,a]=c.useState(null),[i,n]=c.useState(""),[o,l]=c.useState(""),d=async(b,w)=>{if(!b.target.files||b.target.files.length===0)return;const D=b.target.files[0];a(w),n(""),l("");try{const M=D.name.split(".").pop(),A=`${s.auth_id}/docs/venue_${w}_${Date.now()}.${M}`,y=await Z.upload("estabelecimento",A,D);await Q.updateVenue(s.id,null,{[w==="lista"?"lista_equipamentos_url":"mapa_palco_url"]:y}),l("Arquivo enviado com sucesso!"),r()}catch(M){n(q(M))}finally{a(null)}},x=async b=>{if(window.confirm("Remover este arquivo?"))try{await Q.updateVenue(s.id,null,{[b==="lista"?"lista_equipamentos_url":"mapa_palco_url"]:null}),r()}catch(w){alert(q(w))}},f=(u=s.estabelecimento)==null?void 0:u.lista_equipamentos_url,m=(S=s.estabelecimento)==null?void 0:S.mapa_palco_url;return e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsx("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6",children:e.jsx("h2",{className:"text-2xl font-bold font-poppins text-white",children:"Especificações Técnicas"})}),e.jsx("p",{className:"text-gray-400 text-sm mb-6",children:"Disponibilize informações técnicas do seu espaço para agilizar a pré-produção dos shows."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-gray-900/50 p-6 rounded-2xl border border-gray-700",children:[e.jsxs("h3",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx(Pe,{className:"w-5 h-5 text-primary"})," Lista de Equipamentos (PA/Backline)"]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("label",{className:`flex-1 flex flex-col items-center justify-center py-8 border-2 border-dashed border-gray-700 rounded-xl cursor-pointer hover:bg-gray-800 transition-all ${t==="lista"?"opacity-50":""}`,children:[e.jsx(he,{className:`w-8 h-8 mb-2 ${t==="lista"?"animate-bounce":"text-gray-500"}`}),e.jsx("span",{className:"text-xs font-bold text-gray-400",children:f?"Substituir Lista":"Enviar PDF/Imagem"}),e.jsx("input",{type:"file",className:"hidden",accept:".pdf,image/*",onChange:b=>d(b,"lista"),disabled:!!t})]}),f&&e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("a",{href:Z.getPublicUrl("estabelecimento",f),target:"_blank",rel:"noreferrer",className:"w-12 h-12 bg-green-500/10 rounded-full flex items-center justify-center text-green-500 border border-green-500/30 hover:bg-green-500/20 transition-colors",children:e.jsx(me,{className:"w-6 h-6"})}),e.jsx("button",{onClick:()=>x("lista"),className:"w-12 h-12 bg-red-500/10 rounded-full flex items-center justify-center text-red-500 border border-red-500/30 hover:bg-red-500/20 transition-colors",children:e.jsx(ve,{className:"w-5 h-5"})})]})]})]}),e.jsxs("div",{className:"bg-gray-900/50 p-6 rounded-2xl border border-gray-700",children:[e.jsxs("h3",{className:"text-lg font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx(Pe,{className:"w-5 h-5 text-secondary"})," Mapa de Palco / Planta"]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("label",{className:`flex-1 flex flex-col items-center justify-center py-8 border-2 border-dashed border-gray-700 rounded-xl cursor-pointer hover:bg-gray-800 transition-all ${t==="mapa"?"opacity-50":""}`,children:[e.jsx(he,{className:`w-8 h-8 mb-2 ${t==="mapa"?"animate-bounce":"text-gray-500"}`}),e.jsx("span",{className:"text-xs font-bold text-gray-400",children:m?"Substituir Mapa":"Enviar PDF/Imagem"}),e.jsx("input",{type:"file",className:"hidden",accept:".pdf,image/*",onChange:b=>d(b,"mapa"),disabled:!!t})]}),m&&e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("a",{href:Z.getPublicUrl("estabelecimento",m),target:"_blank",rel:"noreferrer",className:"w-12 h-12 bg-green-500/10 rounded-full flex items-center justify-center text-green-500 border border-green-500/30 hover:bg-green-500/20 transition-colors",children:e.jsx(me,{className:"w-6 h-6"})}),e.jsx("button",{onClick:()=>x("mapa"),className:"w-12 h-12 bg-red-500/10 rounded-full flex items-center justify-center text-red-500 border border-red-500/30 hover:bg-red-500/20 transition-colors",children:e.jsx(ve,{className:"w-5 h-5"})})]})]})]})]}),i&&e.jsx("p",{className:"text-red-400 text-center",children:i}),o&&e.jsx("p",{className:"text-green-400 text-center",children:o})]})},Ga=({profile:s,onUpdate:r,initialTab:t})=>{const[a,i]=c.useState("dados");return c.useEffect(()=>{t&&i(t==="portfolio"?"portfolio":t==="specs"?"specs":t==="verificacao"?"verificacao":"dados")},[t]),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-wrap gap-2 border-b border-gray-700 pb-2",children:[e.jsxs("button",{onClick:()=>i("dados"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-bold transition-all ${a==="dados"?"bg-primary text-dark":"text-gray-400 hover:bg-gray-800"}`,children:[e.jsx(pe,{className:"w-4 h-4"})," Dados do Local"]}),e.jsxs("button",{onClick:()=>i("portfolio"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-bold transition-all ${a==="portfolio"?"bg-primary text-dark":"text-gray-400 hover:bg-gray-800"}`,children:[e.jsx(ke,{className:"w-4 h-4"})," Portfólio & Mídia"]}),e.jsxs("button",{onClick:()=>i("specs"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-bold transition-all ${a==="specs"?"bg-primary text-dark":"text-gray-400 hover:bg-gray-800"}`,children:[e.jsx(Pe,{className:"w-4 h-4"})," Especificações Técnicas"]}),e.jsxs("button",{onClick:()=>i("verificacao"),className:`flex items-center gap-2 px-4 py-2 rounded-lg text-sm font-bold transition-all ${a==="verificacao"?"bg-primary text-dark":"text-gray-400 hover:bg-gray-800"}`,children:[e.jsx(Je,{className:"w-4 h-4"})," Verificação"]})]}),e.jsxs("div",{className:"animate-fade-in min-h-[500px]",children:[a==="dados"&&e.jsx(Wa,{initialProfile:s,onProfileUpdate:r}),a==="portfolio"&&e.jsx(Rt,{profile:s,onUpdate:r}),a==="specs"&&e.jsx(Ha,{profile:s,onUpdate:r}),a==="verificacao"&&e.jsx(Ye,{profile:s,onUpdate:r})]})]})},Za=({venueProfile:s})=>{const[r,t]=c.useState([]),[a,i]=c.useState(!0),[n,o]=c.useState(""),[l,d]=c.useState(null);c.useEffect(()=>{(async()=>{i(!0);try{const u=await et.getMatchesForVenue(s);t(u)}catch(u){o(q(u))}finally{i(!1)}})()},[s]);const x=async m=>{d(m.id);try{const u=await et.getJustification(s,m);t(S=>S.map(b=>b.id===m.id?{...b,matchJustification:u}:b))}catch(u){console.error("Matchmaking Insight Error:",u)}finally{d(null)}},f=m=>m.foto_url?Z.getPublicUrl("perfis",m.foto_url):"https://images.unsplash.com/photo-1511379938547-c1f69419868d?q=80&w=2070&auto=format&fit=crop";return e.jsxs("div",{className:"animate-fade-in",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("h2",{className:"text-2xl font-bold font-poppins text-white flex items-center gap-2",children:[e.jsx(ce,{className:"text-primary w-7 h-7"}),"Matchmaking Inteligente"]}),e.jsxs("p",{className:"text-gray-400 text-sm",children:["Artistas que combinam com a vibe do ",s.nome,"."]})]}),a?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(6)].map((m,u)=>e.jsx("div",{className:"bg-gray-850 h-48 rounded-2xl animate-pulse border border-gray-700"},u))}):n?e.jsx("div",{className:"bg-red-500/10 border border-red-500/30 p-6 rounded-xl text-red-400 text-center",children:n}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map(m=>{var u;return e.jsxs("div",{className:"bg-gray-850 rounded-2xl border border-gray-700 overflow-hidden hover:border-primary/50 transition-all group flex flex-col",children:[e.jsxs("div",{className:"p-5 flex-grow",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("img",{src:f(m),className:"w-14 h-14 rounded-full object-cover border-2 border-gray-700 group-hover:border-primary transition-colors",alt:m.nome}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"font-bold text-white truncate",children:m.nome}),e.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-gray-500 font-bold uppercase",children:[e.jsx(le,{className:"w-3 h-3 text-yellow-500"}),(u=m.artista)==null?void 0:u.genero_musical]})]})]}),m.matchJustification?e.jsx("div",{className:"bg-primary/5 border border-primary/20 p-3 rounded-xl mb-4 animate-fade-in",children:e.jsxs("p",{className:"text-xs italic text-primary-100 leading-relaxed",children:['"',m.matchJustification,'"']})}):e.jsxs("button",{onClick:()=>x(m),disabled:l===m.id,className:"w-full py-2 mb-4 bg-gray-900 border border-gray-700 rounded-xl text-[10px] font-black uppercase tracking-widest text-gray-400 hover:text-white hover:border-primary transition-all flex items-center justify-center gap-2",children:[l===m.id?e.jsx("span",{className:"animate-spin text-lg",children:"⚡"}):e.jsx(ce,{className:"w-3 h-3"}),l===m.id?"Analisando Vibe...":"Por que este artista?"]}),e.jsxs("div",{className:"flex items-center text-[10px] text-gray-500",children:[e.jsx($e,{className:"w-3 h-3 mr-1"}),m.cidade]})]}),e.jsxs(oe,{to:`/artista/${m.id}`,className:"bg-gray-900/50 p-3 border-t border-gray-800 text-center text-xs font-bold text-primary hover:bg-primary hover:text-dark transition-all flex items-center justify-center gap-1",children:["Ver Perfil ",e.jsx(ze,{className:"w-3 h-3"})]})]},m.id)})})]})},xt=[{id:"overview",label:"Visão Geral",icon:e.jsx(bt,{className:"w-5 h-5"})},{id:"matchmaking",label:"Matchmaking",icon:e.jsx(ce,{className:"w-5 h-5"})},{id:"analytics",label:"Analytics",icon:e.jsx(_e,{className:"w-5 h-5"})},{id:"perfil",label:"Perfil do Local",icon:e.jsx(pe,{className:"w-5 h-5"})},{id:"contratos",label:"Contratos",icon:e.jsx(ft,{className:"w-5 h-5"})},{id:"assinatura",label:"Assinatura",icon:e.jsx(De,{className:"w-5 h-5"})},{id:"avaliacoes",label:"Avaliações",icon:e.jsx(le,{className:"w-5 h-5"})},{id:"mensagens",label:"Mensagens",icon:e.jsx(xe,{className:"w-5 h-5"})}],Xa=({user:s,initialProfile:r,onProfileUpdate:t,openTab:a})=>{const[i,n]=c.useState("overview"),o=Xe(),l=gt();c.useEffect(()=>{a&&(["portfolio"].includes(a)?n("perfil"):xt.some(f=>f.id===a)&&n(a),o(l.pathname,{replace:!0}))},[a,o,l.pathname]);const d=()=>{switch(i){case"overview":return e.jsx(zt,{profile:r,setActiveTab:n});case"matchmaking":return e.jsx(Za,{venueProfile:r});case"analytics":return e.jsx(Pt,{profile:r});case"perfil":return e.jsx(Ga,{profile:r,onUpdate:t,initialTab:a==="portfolio"?"portfolio":void 0});case"contratos":return e.jsx(wt,{profile:r});case"assinatura":return e.jsx(It,{profile:r});case"avaliacoes":return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("h3",{className:"text-xl font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx(le,{className:"w-6 h-6 text-yellow-400"}),"Avaliações do Estabelecimento"]}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Feedback recebido de artistas que tocaram aqui."}),e.jsx(vt,{targetId:r.id})]});case"mensagens":return e.jsx(Mt,{currentUser:r});default:return null}},x=String(r.nome||s.email||"Usuário");return e.jsx(Ct,{title:"Painel do Estabelecimento",subtitle:e.jsxs(e.Fragment,{children:["Bem-vindo(a), ",e.jsx("span",{className:"text-primary font-semibold",children:x}),"!"]}),tabs:xt,activeTab:i,onTabClick:n,profile:r,children:d()})},Bs=()=>{const{session:s,profile:r,loading:t,profileMissing:a,refreshProfile:i,error:n}=pt(),o=Xe(),[l]=Ut(),d=l.get("open");c.useEffect(()=>{t||(s?a&&o("/completar-perfil"):o("/login"))},[s,a,t,o]);const x=async()=>{await i()};return t?e.jsx("div",{className:"flex justify-center items-center h-screen bg-dark",children:e.jsx("div",{className:"text-white text-xl",children:"Carregando painel..."})}):n?e.jsxs("div",{className:"flex flex-col justify-center items-center h-screen bg-dark gap-4 p-4 text-center",children:[e.jsx("h2",{className:"text-red-400 text-xl font-bold",children:"Erro de Conexão"}),e.jsx("p",{className:"text-gray-400 max-w-md",children:n}),e.jsx("button",{onClick:()=>i(),className:"px-6 py-2 bg-primary text-dark font-bold rounded-full hover:bg-opacity-90 transition-all shadow-lg hover:scale-105",children:"Tentar Novamente"})]}):!r||a?e.jsx("div",{className:"flex justify-center items-center h-screen bg-dark",children:e.jsx("div",{className:"text-white text-xl",children:"Carregando perfil..."})}):s!=null&&s.user?e.jsxs("div",{className:"bg-dark text-white font-sans min-h-[calc(100vh-80px)]",children:[e.jsx(sa,{title:"Painel de Controle",description:"Gerencie seu perfil, contratos e notificações no painel do Resona."}),r.tipo==="artista"?e.jsx(Va,{user:s.user,initialProfile:r,onProfileUpdate:x,openTab:d}):e.jsx(Xa,{user:s.user,initialProfile:r,onProfileUpdate:x,openTab:d})]}):e.jsx("div",{className:"flex justify-center items-center h-screen bg-dark",children:e.jsx("div",{className:"text-white text-xl",children:"Sessão não encontrada. Redirecionando..."})})};export{Bs as default};
